
# Integration By Parts

So far we have seen that the *derivative* rules lead to *integration rules*. In particular:

  * The sum rule $[au(x) + bv(x)]' = au'(x) + bv'(x)$ gives rise to an integration

rule: $\int (au(x) + bv(x))dx = a\int u(x)dx + b\int v(x))dx$. (That is the linearity of the derivative means the integral has linearity.)

  * The chain rule $[f(g(x))]' = f'(g(x)) g'(x)$ gives $\int_a^b f(g(x))g'(x)dx=\int_{g(a)}^{g(b)}f(x)dx$. That is, substitution reverses the chain rule.

Now we turn our attention to the implications of the *product rule*: $[uv]' = u'v + uv'$. The resulting technique is called integration by parts.

The folowing illustrates integration by parts of the integral $(uv)'$ over $[a,b]$ [original](http://en.wikipedia.org/wiki/Integration_by_parts#Visualization).
<div id="4af5cacc-7802-4574-a3ce-72e7e075cc11" style="width:600px;height:400px;"></div>
<script>
PLOT = document.getElementById('4af5cacc-7802-4574-a3ce-72e7e075cc11');
Plotly.plot(PLOT, [{"yaxis":"y","y":[0.0,0.005025125628140704,0.010050251256281407,0.01507537688442211,0.020100502512562814,0.02512562814070352,0.03015075376884422,0.035175879396984924,0.04020100502512563,0.04522613065326633,0.05025125628140704,0.05527638190954774,0.06030150753768844,0.06532663316582915,0.07035175879396985,0.07537688442211055,0.08040201005025126,0.08542713567839195,0.09045226130653267,0.09547738693467336,0.10050251256281408,0.10552763819095477,0.11055276381909548,0.11557788944723618,0.12060301507537688,0.12562814070351758,0.1306532663316583,0.135678391959799,0.1407035175879397,0.1457286432160804,0.1507537688442211,0.15577889447236182,0.16080402010050251,0.1658291457286432,0.1708542713567839,0.17587939698492464,0.18090452261306533,0.18592964824120603,0.19095477386934673,0.19597989949748743,0.20100502512562815,0.20603015075376885,0.21105527638190955,0.21608040201005024,0.22110552763819097,0.22613065326633167,0.23115577889447236,0.23618090452261306,0.24120603015075376,0.24623115577889448,0.25125628140703515,0.2562814070351759,0.2613065326633166,0.2663316582914573,0.271356783919598,0.27638190954773867,0.2814070351758794,0.2864321608040201,0.2914572864321608,0.2964824120603015,0.3015075376884422,0.3065326633165829,0.31155778894472363,0.3165829145728643,0.32160804020100503,0.32663316582914576,0.3316582914572864,0.33668341708542715,0.3417085427135678,0.34673366834170855,0.35175879396984927,0.35678391959798994,0.36180904522613067,0.36683417085427134,0.37185929648241206,0.3768844221105528,0.38190954773869346,0.3869346733668342,0.39195979899497485,0.3969849246231156,0.4020100502512563,0.40703517587939697,0.4120603015075377,0.41708542713567837,0.4221105527638191,0.4271356783919598,0.4321608040201005,0.4371859296482412,0.44221105527638194,0.4472361809045226,0.45226130653266333,0.457286432160804,0.4623115577889447,0.46733668341708545,0.4723618090452261,0.47738693467336685,0.4824120603015075,0.48743718592964824,0.49246231155778897,0.49748743718592964,0.5025125628140703,0.507537688442211,0.5125628140703518,0.5175879396984925,0.5226130653266332,0.5276381909547738,0.5326633165829145,0.5376884422110553,0.542713567839196,0.5477386934673367,0.5527638190954773,0.5577889447236181,0.5628140703517588,0.5678391959798995,0.5728643216080402,0.5778894472361809,0.5829145728643216,0.5879396984924623,0.592964824120603,0.5979899497487438,0.6030150753768844,0.6080402010050251,0.6130653266331658,0.6180904522613065,0.6231155778894473,0.628140703517588,0.6331658291457286,0.6381909547738693,0.6432160804020101,0.6482412060301508,0.6532663316582915,0.6582914572864321,0.6633165829145728,0.6683417085427136,0.6733668341708543,0.678391959798995,0.6834170854271356,0.6884422110552764,0.6934673366834171,0.6984924623115578,0.7035175879396985,0.7085427135678392,0.7135678391959799,0.7185929648241206,0.7236180904522613,0.7286432160804021,0.7336683417085427,0.7386934673366834,0.7437185929648241,0.7487437185929648,0.7537688442211056,0.7587939698492462,0.7638190954773869,0.7688442211055276,0.7738693467336684,0.7788944723618091,0.7839195979899497,0.7889447236180904,0.7939698492462312,0.7989949748743719,0.8040201005025126,0.8090452261306532,0.8140703517587939,0.8190954773869347,0.8241206030150754,0.8291457286432161,0.8341708542713567,0.8391959798994975,0.8442211055276382,0.8492462311557789,0.8542713567839196,0.8592964824120602,0.864321608040201,0.8693467336683417,0.8743718592964824,0.8793969849246231,0.8844221105527639,0.8894472361809045,0.8944723618090452,0.8994974874371859,0.9045226130653267,0.9095477386934674,0.914572864321608,0.9195979899497487,0.9246231155778895,0.9296482412060302,0.9346733668341709,0.9396984924623115,0.9447236180904522,0.949748743718593,0.9547738693467337,0.9597989949748744,0.964824120603015,0.9698492462311558,0.9748743718592965,0.9798994974874372,0.9849246231155779,0.9899497487437185,0.9949748743718593,1.0],"showlegend":true,"name":"y1","type":"scatter","xaxis":"x","line":{"width":1,"dash":"solid","color":"rgba(0, 154, 250, 1.000)","shape":"linear"},"x":[0.0,0.007893366909713283,0.015786242013636962,0.023678133536623992,0.03156854976481053,0.039456999076252754,0.04734298997155799,0.05522603110450814,0.06310563131267365,0.07098129964801592,0.07885254540747647,0.08671887816355078,0.09457980779484494,0.10243484451661329,0.11028349891127502,0.11812528195890797,0.12595970506771756,0.1337862801044791,0.14160451942495164,0.14941393590426094,0.15721404296725078,0.16500435461879928,0.17278438547409955,0.18055365078890218,0.18831166648971787,0.196057949203978,0.20379201629015212,0.211513385867819,0.21922157684769134,0.22691610896159012,0.2345965027923687,0.2422622798037832,0.24991296237030836,0.25754807380689665,0.2651671383986786,0.2727696814306031,0.28035522921701445,0.2879233091311665,0.29547344963467004,0.3030051803068727,0.3105180318741688,0.3180115362392382,0.3254852265102117,0.3329386370297611,0.34037130340411287,0.34778276253198237,0.3551725526334284,0.36254021327862446,0.3698852854165468,0.377207311403576,0.3845058350320108,0.39178040155849314,0.399030557732341,0.4062558518237889,0.41345583365213406,0.4206300546137842,0.4277780677102096,0.43489942757579303,0.4419936905055791,0.4490604144829201,0.45609915920701594,0.4631094861203478,0.470090958436003,0.47704314116488955,0.48396560114283876,0.4908579070575937,0.49771962947568305,0.5045503408691775,0.5113496156423266,0.5181170301580774,0.5248521627644683,0.5315545938209014,0.5382239057242886,0.5448596829350704,0.5514615120031074,0.5580289815934402,0.5645616825119181,0.5710592077306947,0.5775211524135886,0.5839471139413063,0.5903366919365284,0.5966894882888559,0.6030051071796145,0.6092831551065166,0.6155232409081792,0.6217249757884952,0.6278879733408583,0.6340118495722387,0.6400962229271072,0.6461407143112097,0.6521449471151867,0.6581085472380377,0.6640311431104312,0.6699123657178552,0.6757518486236087,0.6815492279916338,0.6873041426091843,0.6930162339093318,0.6986851459933066,0.704310525652672,0.7098920223913328,0.7154292884473712,0.7209219788147164,0.7263697512646393,0.7317722663670768,0.7371291875117789,0.7424401809292831,0.747704915711709,0.752923063833377,0.7580943001712456,0.7632183025251684,0.7682947516379707,0.773323331215339,0.7783037279455299,0.7832356315188904,0.7881187346471923,0.7929527330827786,0.7977373256375193,0.802472214201578,0.8071571037619854,0.8117917024210207,0.8163757214143991,0.8209088751292626,0.8253908811219761,0.8298214601357259,0.8342003361179176,0.8385272362373773,0.8428018909013506,0.8470240337722988,0.8511934017844947,0.8553097351604119,0.8593727774269119,0.8633822754312233,0.8673379793567146,0.8712396427384597,0.8750870224785936,0.8788798788614602,0.8826179755685469,0.8863010796932086,0.8899289617551803,0.8935013957148741,0.8970181589874634,0.9004790324567516,0.9038838004888236,0.9072322509454814,0.9105241751974622,0.9137593681374366,0.9169376281927887,0.9200587573381745,0.9231225611078607,0.9261288486078412,0.9290774325277305,0.9319681291524348,0.9348007583735983,0.9375751437008251,0.9402911122726756,0.942948494867437,0.9455471259136671,0.9480868435005095,0.9505674893877828,0.9529889090158392,0.9553509515151948,0.9576534697159295,0.959896320156857,0.9620793630944628,0.9642024625116117,0.9662654861260218,0.9682683053985072,0.9702107955409863,0.972092835524257,0.9739143080855378,0.9756750997357736,0.9773751007667072,0.9790142052577145,0.9805923110824041,0.9821093199149804,0.98356513723637,0.9849596723401105,0.9862928383380026,0.9875645521655237,0.9887747345870026,0.9899233102005571,0.9910102074427921,0.9920353585932578,0.9929986997786696,0.9939001709768878,0.994739716020657,0.995517282601106,0.9962328222710067,0.9968862904477932,0.9974776464163387,0.9980068533314934,0.9984738782203788,0.9988786919844436,0.9992212694012756,0.9995015891261738,0.9997196336934779,0.9998753895176573,0.9999688468941563,1.0],"mode":"lines"},{"yaxis":"y","y":[0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0],"showlegend":true,"name":"y2","type":"scatter","xaxis":"x","line":{"width":1,"dash":"solid","color":"rgba(227, 111, 71, 1.000)","shape":"linear"},"x":[0.0,0.010101010101010102,0.020202020202020204,0.030303030303030304,0.04040404040404041,0.050505050505050504,0.06060606060606061,0.0707070707070707,0.08080808080808081,0.09090909090909091,0.10101010101010101,0.1111111111111111,0.12121212121212122,0.13131313131313133,0.1414141414141414,0.15151515151515152,0.16161616161616163,0.1717171717171717,0.18181818181818182,0.1919191919191919,0.20202020202020202,0.21212121212121213,0.2222222222222222,0.23232323232323232,0.24242424242424243,0.25252525252525254,0.26262626262626265,0.2727272727272727,0.2828282828282828,0.29292929292929293,0.30303030303030304,0.31313131313131315,0.32323232323232326,0.3333333333333333,0.3434343434343434,0.35353535353535354,0.36363636363636365,0.37373737373737376,0.3838383838383838,0.3939393939393939,0.40404040404040403,0.41414141414141414,0.42424242424242425,0.43434343434343436,0.4444444444444444,0.45454545454545453,0.46464646464646464,0.47474747474747475,0.48484848484848486,0.494949494949495,0.5050505050505051,0.5151515151515151,0.5252525252525253,0.5353535353535354,0.5454545454545454,0.5555555555555556,0.5656565656565656,0.5757575757575758,0.5858585858585859,0.5959595959595959,0.6060606060606061,0.6161616161616161,0.6262626262626263,0.6363636363636364,0.6464646464646465,0.6565656565656566,0.6666666666666666,0.6767676767676768,0.6868686868686869,0.696969696969697,0.7070707070707071,0.7171717171717171,0.7272727272727273,0.7373737373737373,0.7474747474747475,0.7575757575757576,0.7676767676767676,0.7777777777777778,0.7878787878787878,0.797979797979798,0.8080808080808081,0.8181818181818182,0.8282828282828283,0.8383838383838383,0.8484848484848485,0.8585858585858586,0.8686868686868687,0.8787878787878788,0.8888888888888888,0.898989898989899,0.9090909090909091,0.9191919191919192,0.9292929292929293,0.9393939393939394,0.9494949494949495,0.9595959595959596,0.9696969696969697,0.9797979797979798,0.98989898989899,1.0],"mode":"lines"},{"yaxis":"y","y":[0.25,0.75],"showlegend":true,"name":"y3","type":"scatter","xaxis":"x","x":[0.3826834323650898,0.9238795325112867],"mode":"markers","marker":{"symbol":"circle","line":{"width":1,"color":"rgba(0, 0, 0, 1.000)"},"size":10,"color":"rgba(255, 165, 0, 1.000)"}},{"yaxis":"y","showlegend":true,"type":"scatter","xaxis":"x","name":"y4","fillcolor":"rgba(255, 165, 0, 0.250)","y":[0.0,0.25,0.25,0.75,0.75,0.0,0.0,0.0],"line":{"width":1,"dash":"solid","color":"rgba(0, 0, 0, 0.250)"},"fill":"tozeroy","mode":"lines","x":[0.3826834323650898,0.3826834323650898,0.0,0.0,0.9238795325112867,0.9238795325112867,0.3826834323650898,0.3826834323650898]}], {"yaxis":{"type":"-","titlefont":{"size":15,"color":"rgba(0, 0, 0, 1.000)","family":"Helvetica"},"title":"","tickfont":{"size":11,"color":"rgba(0, 0, 0, 1.000)","family":"Helvetica"},"ticks":"inside","tickmode":"array","showgrid":true,"tickvals":[0.0,0.5,1.0],"domain":[0.03762029746281716,0.9901574803149606],"ticktext":["0.0","0.5","1.0"],"tickangle":0,"zeroline":false,"linecolor":"rgba(0, 0, 0, 1.000)","tickcolor":"rgba(0, 0, 0, 1.000)","anchor":"x"},"annotations":[{"text":"A","y":0.25,"xref":"x","font":{"size":20,"color":"rgba(0, 0, 0, 1.000)","family":"Helvetica"},"xanchor":"center","x":0.65,"yref":"x","showarrow":false,"yanchor":"middle","rotation":-0.0},{"text":"B","y":0.55,"xref":"x","font":{"size":20,"color":"rgba(0, 0, 0, 1.000)","family":"Helvetica"},"xanchor":"center","x":0.4,"yref":"x","showarrow":false,"yanchor":"middle","rotation":-0.0},{"text":"(u(a),v(a))","y":0.33,"xref":"x","font":{"size":20,"color":"rgba(0, 0, 0, 1.000)","family":"Helvetica"},"xanchor":"center","x":0.3826834323650898,"yref":"x","showarrow":false,"yanchor":"middle","rotation":-0.0},{"text":"(u(b),v(b))","y":0.83,"xref":"x","font":{"size":20,"color":"rgba(0, 0, 0, 1.000)","family":"Helvetica"},"xanchor":"center","x":0.9238795325112867,"yref":"x","showarrow":false,"yanchor":"middle","rotation":-0.0}],"width":600,"plot_bgcolor":"rgba(255, 255, 255, 1.000)","showlegend":false,"xaxis":{"type":"-","titlefont":{"size":15,"color":"rgba(0, 0, 0, 1.000)","family":"Helvetica"},"title":"","tickfont":{"size":11,"color":"rgba(0, 0, 0, 1.000)","family":"Helvetica"},"ticks":"inside","tickmode":"array","showgrid":true,"tickvals":[0.0,0.5,1.0],"domain":[0.05100612423447069,0.9934383202099737],"ticktext":["0.0","0.5","1.0"],"tickangle":0,"zeroline":false,"linecolor":"rgba(0, 0, 0, 1.000)","tickcolor":"rgba(0, 0, 0, 1.000)","anchor":"y"},"paper_bgcolor":"rgba(255, 255, 255, 1.000)","height":400,"margin":{"r":0,"l":0,"b":0,"t":20}});
</script>

The figure is a parametric plot of $(u,v)$ with the points $(u(a), v(a))$ and $(u(b), v(b))$ marked. The difference $u(b)v(b) - u(a)v(a) = u(x)v(x) \big|_a^b$ is shaded.  This area breaks into two pieces, $A$ and $B$, partitioned by the curve. If $u$ is increasing and the curve is parameterized by $t \rightarrow u^{-1}(t)$, then $A=\int_{u^{-1}(a)}^{u^{-1}(b)} v(u^{-1}(t))dt$. A $u$-substitution with $t = u(x)$ changes this into the integral $\int_a^b v(x) u'(x) dx$. Similarly, for increasing $v$, it can be seen that $B=\int_a^b u(x) v'(x) dx$. This suggests a relationship between the integral of $u v'$, the integral of $u' v$ and the value $u(b)v(b) - u(a)v(a)$.

In terms of formulas:
$$~
u(x)\cdot v(x)\big|_a^b = \int_a^b [u(x) v(x)]' dx = \int_a^b u'(x) \cdot v(x) dx + \int_a^b u(x) \cdot v'(x) dx.
~$$

This is re-expressed as
$$~
\int_a^b u(x) \cdot v'(x) dx = u(x) \cdot v(x)\big|_a^b -  \int_a^b v(x) \cdot u'(x) dx,
~$$

Or, more informally, as $\int udv = uv - \int v du$.

This can sometimes be confusingly written as:
$$~
\int f(x) g'(x) dx = f(x)g(x) - \int f'(x) g(x) dx.
~$$

(The confusion coming from the fact that the indefinite integrals are only defined up to a constant.)

How does this help? It allows us to differentiate parts of an integral in hopes it makes the result easier to integrate.

An illustration can clarify.

Consider the integral $\int_0^\pi x\sin(x) dx$. If we let $u=x$ and $dv=\sin(x) dx$, the $du = 1dx$ and $v=-\cos(x)$. The above then says:
$$~
\begin{align}
\int_0^\pi x\sin(x) dx &= \int_0^\pi u dv\\
&= uv\big|_0^\pi - \int_0^\pi v du\\
&= x \cdot (-\cos(x)) \big|_0^\pi - \int_0^\pi (-\cos(x)) dx\\
&= \pi (-\cos(\pi)) - 0(-\cos(0)) + \int_0^\pi \cos(x) dx\\
&= \pi + \sin(x)\big|_0^\pi\\
&= \pi.
\end{align}
~$$

The technique means one part is differentiated and one part integrated. The art is to break the integrand up into a piece that gets easier through differentiation and a piece that doesn't get much harder through integration.

## Examples

Consider $\int_1^2 x \log(x) dx$. We might try differentiating the $\log(x)$ term, so we set $u=\log(x)$ and $dv=xdx$. Then we get $du = 1/x dx$ and $v = x^2/2$. Putting together gives:
$$~
\begin{align}
\int_1^2 x \log(x) dx
&= (\log(x) \cdot \frac{x^2}{2}) \big|_1^2 - \int_1^2 \frac{x^2}{2} \frac{1}{x} dx\\
&= (2\log(2) - 0) - (\frac{x^2}{4})\big|_1^2\\
&= 2\log(2) - (1 - \frac{1}{4}) \\
&= 2\log(2) - \frac{3}{4}.
\end{align}
~$$

##### Example

This related problem uses the same idea, though perhaps harder to see at first glance, as $dv=dx$ seems too trivial.
$$~
\begin{align}
\int \log(x) dx
&= \int u dv\\
&= uv - \int v du\\
&= (\log(x) \cdot x) - \int x \cdot \frac{1}{x} dx\\
&= x \log(x) - \int dx\\
&= x \log(x) - x
\end{align}
~$$

Were this a definite integral problem, we would have written:
$$~
\int_a^b \log(x) dx = (x\log(x))\big|_a^b - \int_a^b dx = (x\log(x) - x)\big|_a^b.
~$$

##### Example

Sometimes integration by parts is used two or more times. Here we let $u=x^2$ and $dv = e^x dx$:
$$~
\int_a^b x^2 e^x dx = (x^2 \cdot e^x)\big|_a^b - \int_a^b 2x e^x dx.
~$$

But we can do $\int_a^b x e^xdx$ the same way:
$$~
\int_a^b x e^x = (x\cdot e^x)\big|_a^b - \int_a^b 1 \cdot e^xdx = (xe^x - e^x)\big|_a^b.
~$$

Combining gives the answer:
$$~
\int_a^b x^2 e^x dx
= (x^2 \cdot e^x)\big|_a^b - 2( (xe^x - e^x)\big|_a^b ) =
e^x(x^2  - 2x - 1) \big|_a^b.
~$$

In fact, it isn't hard to see that an integral of $x^m e^x$, $m$ a positive integer, can be handled in this manner. For example, when $m=10$, `SymPy` gives:

```{r eval=FALSE}
using SymPy
x = symbols("x")
integrate(x^10 * exp(x), x)

```
                                    

```{r eval=FALSE}
## ... bug ...
```


The general answer is $\int x^n e^xdx = p(x) e^x$, where $p(x)$ is a polynomial of degree $n$. 

##### Example

The same technique is attempted for  this integral, but ends differently. First in the following we let $u=\sin(x)$ and $dv=e^x dx$:
$$~
\int e^x \sin(x)dx = \sin(x) e^x - \int \cos(x) e^x dx.
~$$

Now we let $u = \cos(x)$ and again $dv=e^x dx$:
$$~
\int e^x \sin(x)dx = \sin(x) e^x - \int \cos(x) e^x dx = \sin(x)e^x - \cos(x)e^x - \int (-\sin(x))e^x dx.
~$$

But simplifying this gives:
$$~
\int e^x \sin(x)dx = - \int e^x \sin(x)dx +  e^x(\sin(x) - \cos(x)).
~$$

Solving for the "unknown" $\int e^x \sin(x) dx$ gives:
$$~
\int e^x \sin(x) dx = \frac{1}{2} e^x (\sin(x) - \cos(x)).
~$$

##### Example

Positive integer powers of trigonometric functions can be addressed by this technique. Consider  $\int \cos(x)^n dx$. We let $u=\cos(x)^{n-1}$ and $dv=\cos(x) dx$. Then $du = (n-1)\cos(x)^{n-2}(-\sin(x))dx$ and $v=\sin(x)$. So,
$$~
\begin{align}
\int \cos(x)^n dx &= \cos(x)^{n-1} \cdot (\sin(x)) - \int (\sin(x)) ((n-1)\sin(x) \cos(x)^{n-2}) dx \\
&= \sin(x) \cos(x)^{n-1} + (n-1)\int \sin^2(x) \cos(x)^{n-1} dx\\
&= \sin(x) \cos(x)^{n-1} + (n-1)\int (1 - \cos(x)^2) \cos(x)^{n-2} dx\\
&= \sin(x) \cos(x)^{n-1} + (n-1)\int \cos(x)^{n-2}dx - (n-1)\int \cos(x)^n dx.
\end{align}
~$$

We can then solve for the unknown ($\int \cos(x)^{n}dx$) to get this *reduction formula*:
$$~
\int \cos(x)^n dx = \frac{1}{n}\sin(x) \cos(x)^{n-1} + \frac{n-1}{n}\int \cos(x)^{n-2}dx.
~$$

This is called a reduction formula as it reduces the problem from an integral with a power of $n$ to one with a power of $n - 2$, so could be repeated until the remaining indefinite integral required knowing either $\int \cos(x) dx$ (which is $-\sin(x)$) or $\int \cos(x)^2 dx$, which by a double angle formula application, is $x/2 - \sin(2x)/4$.

`SymPy` is quite able to do this repeated bookkeeping. For example with $n=10$:

```{r eval=FALSE}
integrate(cos(x)^10, x)

```
                                    

```{r eval=FALSE}
## ... bug ...
```


##### Example

The visual interpretation of integration by parts breaks area into two pieces, the one labeled "B" looks like it would be labeled "A" for an inverse function for $f$. Indeed, integration by parts gives a means to possibly find antiderivatives for inverse functions.

Let $uv = x f^{-1}(x)$. Then we have $[uv]' = u'v + uv' = f^{-1}(x) + x [f^{-1}(x)]'$. So,
$$~
\begin{align}
\int f^{-1}(x) dx
&= xf^{-1}(x) - \int x [f^{-1}(x)]' dx\\
&= xf^{-1}(x) - \int f(u) du.\\
\end{align}
~$$

The last line follows from the $u$-substitution $u=f^{-1}(x)$ for then $du = [f^{-1}(x)]' dx$ and $x=f(u)$.

We use this to find an antiderivative for $\sin^{-1}(x)$:
$$~
\int \sin^{-1}(x) = x \sin^{-1}(x) - \int \sin(u) du =  x \sin^{-1}(x) + \cos(u) = x \sin^{-1}(x) + \cos(\sin^{-1}(x)).
~$$

Using right triangles to simplify, the last value $\cos(\sin^{-1}(x))$ can otherwise be written as $\sqrt{1 - x^2}$.

##### Example

The [trapezoid](http://en.wikipedia.org/wiki/Trapezoidal_rule) rule is an approximation to the definite integral like a Riemann sum, only instead of approximating the area above $[x_i, x_i + h]$ by a rectangle with height $f(c_i)$ (for some $c_i$), it uses a trapezoid formed by the left and right endpoints. That is, this area is used in the estimation: $(1/2)\cdot (f(x_i) + f(x_i+h)) \cdot h$.

Even though we suggest just using `quadgk` for numeric integration, estimating the error in this approximation is still of some theoretical interest. Recall, just using *either* $x_i$ or $x_{i-1}$ for $c_i$ gives an error that is "like" $1/n$, as $n$ gets large, though the exact rate depends on the function and the length of the interval.

This [proof](http://www.math.ucsd.edu/~ebender/20B/77_Trap.pdf) for the error estimate is involved, but is reproduced here, as it nicely integrates many of the theoretical concepts of integration discussed so far.

First, for convenience, we consider the interval $x_i$ to $x_i+h$. The actual answer over this is just $\int_{x_i}^{x_i+h}f(x) dx$. By a $u$-substitution with $u=x-x_i$ this becomes $\int_0^h f(t + x_i) dt$. For analyzing this we integrate once by parts using $u=f(t+x_i)$ and $dv=dt$. But instead of letting $v=t$, we choose to add – as is our prerogative – a constant of integration $A$, so $v=t+A$:
$$~
\int_0^h f(t + x_i) dt = (t+A)f(t+x_i)\big|_0^h - \int_0^h (t + A) f'(t + x_i) dt.
~$$

We choose $A$ to be $-h/2$, for then the term $(t+A)f(t+x_i)\big|_0^h$ becomes $(1/2)(f(x_i+h) + f(x_i)) \cdot h$, or the trapezoid approximation. This means, the error over this interval – actual minus estimate – satisfies:
$$~
\text{error}_i = \int_{x_i}^{x_i+h}f(x) dx - \frac{f(x_i+h) -f(x_i)}{2} \cdot h  = - \int_0^h (t + A) f'(t + x_i) dt.
~$$

For this, we *again* integrate by parts with $u=f'(t+x_i)$ and $dv=(t+A)dt$. Again we add a constant of integration to get $v=(t+A)^2/2 + B$, and our error becomes:
$$~
\text{error}_i = -(\frac{(t+A)^2}{2} + B)f'(t+x_i)\big|_0^h + \int_0^h (\frac{(t+A)^2}{2} + B) \cdot f''(t+x_i) dt.
~$$

With $A=-h/2$, $B$ is chosen to be $-h^2/8$ which causes the first term to vanish and the absolute error to simplify to:
$$~
\lvert \text{error}_i  \rvert = \lvert \int_0^h \left(\frac{(t-h/2)^2}{2} - \frac{h^2}{8}\right) \cdot f''(t + x_i) dt \rvert.
~$$

Now, we assume the $\lvert f''(t)\rvert$ is bounded by $K$ for any $a \leq t \leq b$. This will be true, for example, if the second derivative is assumed to exist and be continous.  Using this fact about definite integrals $\lvert \int_a^b g dx\rvert \leq \int_a^b \lvert g \rvert dx$ we have:
$$~
\lvert \text{error}_i  \rvert \leq K \int_0^h \lvert (\frac{(t-h/2)^2}{2} - \frac{h^2}{8}) \rvert dt.
~$$

But what is the function in the integrand? Clearly it is a quadratic in $t$. Expanding gives $1/2 \cdot (t^2 - ht)$.  This is negative over $[0,h]$ (and $0$ at these endpoints, so the integral above is just:
$$~
\frac{1}{2}\int_0^h (ht - t^2)dt = \frac{1}{2} (\frac{ht^2}{2} - \frac{t^3}{3})\big|_0^h = \frac{h^3}{12}
~$$

This gives the bound: $\vert \text{error}_i \rvert \leq K h^3/12$. The *total* error may be less, but is not more than the value found by adding up the error over each of the $n$ intervals. As our bound does not depend on the $i$, we have this sum satisfies:
$$~
\lvert \text{error}\rvert \leq n \cdot \frac{Kh^3}{12} = \frac{K(b-a)^3}{12}\frac{1}{n^2}.
~$$

So the error is like $1/n^2$, in contrast to the $1/n$ error of the Riemann sums. One way to see this, for the Riemann sum it takes twice as many terms to half an error estimate, but for the trapezoid rule only $\sqrt{2}$ as many, and for Simpson's rule, only $2^{1/4}$ as many.

## Questions

###### Question

In the integral of $\int \log(x) dx$ we let $u=\log(x)$ and $dv=dx$. What are $du$ and $v$?

----

<form name="WeaveQuestion" data-id="hoaINChJ" data-controltype="radio">
<div class="form-group ">

<div  class="radio"> 
<label>
<input type="radio" name="radio_hoaINChJ" value="1"><div class="markdown">$du=1/x dx \quad v = x$
</div>
</label>
</div>

<div  class="radio"> 
<label>
<input type="radio" name="radio_hoaINChJ" value="2"><div class="markdown">$du=x\log(x) dx\quad v = 1$
</div>
</label>
</div>

<div  class="radio"> 
<label>
<input type="radio" name="radio_hoaINChJ" value="3"><div class="markdown">$du=1/x dx\quad v = x^2/2$
</div>
</label>
</div>



<div id="hoaINChJ_message"></div>
</div>
</form>
<script text="text/javascript">
$("input:radio[name='radio_hoaINChJ']").on("change", function() {
correct = this.value == 1;

if(correct) {
$("#hoaINChJ_message").html("<div class='alert alert-success'><span class='glyphicon glyphicon-thumbs-up'>&nbsp;Correct</span></div>");
} else {
$("#hoaINChJ_message").html("<div class='alert alert-warning'><span class='glyphicon glyphicon-thumbs-down'>&nbsp;Incorrect</span></div>");
}
});

</script>

----



###### Question

In the integral $\int \sec(x)^3 dx$ we let $u=\sec(x)$ and $dv = \sec(x)^2 dx$. What are $du$ and $v$?

----

<form name="WeaveQuestion" data-id="WipR5gs6" data-controltype="radio">
<div class="form-group ">

<div  class="radio"> 
<label>
<input type="radio" name="radio_WipR5gs6" value="1"><div class="markdown">$du=\sec(x)\tan(x)dx \quad v=\tan(x)$
</div>
</label>
</div>

<div  class="radio"> 
<label>
<input type="radio" name="radio_WipR5gs6" value="2"><div class="markdown">$du=\tan(x)  dx \quad v=\sec(x)\tan(x)$
</div>
</label>
</div>

<div  class="radio"> 
<label>
<input type="radio" name="radio_WipR5gs6" value="3"><div class="markdown">$du=\csc(x) dx \quad v=\sec(x)^3 / 3$
</div>
</label>
</div>



<div id="WipR5gs6_message"></div>
</div>
</form>
<script text="text/javascript">
$("input:radio[name='radio_WipR5gs6']").on("change", function() {
correct = this.value == 1;

if(correct) {
$("#WipR5gs6_message").html("<div class='alert alert-success'><span class='glyphicon glyphicon-thumbs-up'>&nbsp;Correct</span></div>");
} else {
$("#WipR5gs6_message").html("<div class='alert alert-warning'><span class='glyphicon glyphicon-thumbs-down'>&nbsp;Incorrect</span></div>");
}
});

</script>

----



###### Question

In the integral $\int e^{-x} \cos(x)dx$ we let $u=e^{-x}$ and $dv=\cos(x) dx$.  What are $du$ and $v$?

----

<form name="WeaveQuestion" data-id="xbbIbvj5" data-controltype="radio">
<div class="form-group ">

<div  class="radio"> 
<label>
<input type="radio" name="radio_xbbIbvj5" value="1"><div class="markdown">$du=-e^{-x} dx \quad v=-\sin(x)$
</div>
</label>
</div>

<div  class="radio"> 
<label>
<input type="radio" name="radio_xbbIbvj5" value="2"><div class="markdown">$du=\sin(x)dx \quad v=-e^{-x}$
</div>
</label>
</div>

<div  class="radio"> 
<label>
<input type="radio" name="radio_xbbIbvj5" value="3"><div class="markdown">$du=-e^{-x} dx \quad v=\sin(x)$
</div>
</label>
</div>



<div id="xbbIbvj5_message"></div>
</div>
</form>
<script text="text/javascript">
$("input:radio[name='radio_xbbIbvj5']").on("change", function() {
correct = this.value == 3;

if(correct) {
$("#xbbIbvj5_message").html("<div class='alert alert-success'><span class='glyphicon glyphicon-thumbs-up'>&nbsp;Correct</span></div>");
} else {
$("#xbbIbvj5_message").html("<div class='alert alert-warning'><span class='glyphicon glyphicon-thumbs-down'>&nbsp;Incorrect</span></div>");
}
});

</script>

----



###### Question

Find the value of $\int_1^4 x \log(x) dx$. You can integrate by parts.

----

<form name='WeaveQuestion' data-id='6AWMIXcN' data-controltype='numeric'>
<div class='form-group '>
<div class='controls'>



<div class="input-group">
<input id="6AWMIXcN" type="number" class="form-control">

</div>

<div id='6AWMIXcN_message'></div>
</div>
</div>
</form>
<script text='text/javascript'>
$('#6AWMIXcN').on('change', function() {
correct = Math.abs(this.value - 7.340354888959126) <= 0.001;

if(correct) {
$('#6AWMIXcN_message').html('<div class="alert alert-success"><span class="glyphicon glyphicon-thumbs-up">&nbsp;Correct</span></div>');
} else {
$('#6AWMIXcN_message').html('<div class="alert alert-danger"><span class="glyphicon glyphicon-thumbs-down">&nbsp;Incorrect</span></div>');
}
});
</script>

----



###### Question

Find the value of $\int_0^{\pi/2} x\cos(2x) dx$. You can integrate by parts.

----

<form name='WeaveQuestion' data-id='8G3VoSso' data-controltype='numeric'>
<div class='form-group '>
<div class='controls'>



<div class="input-group">
<input id="8G3VoSso" type="number" class="form-control">

</div>

<div id='8G3VoSso_message'></div>
</div>
</div>
</form>
<script text='text/javascript'>
$('#8G3VoSso').on('change', function() {
correct = Math.abs(this.value - -0.05973244313425873) <= 0.001;

if(correct) {
$('#8G3VoSso_message').html('<div class="alert alert-success"><span class="glyphicon glyphicon-thumbs-up">&nbsp;Correct</span></div>');
} else {
$('#8G3VoSso_message').html('<div class="alert alert-danger"><span class="glyphicon glyphicon-thumbs-down">&nbsp;Incorrect</span></div>');
}
});
</script>

----



###### Question

Find the value of $\int_1^e (\log(x))^2 dx$. You can integrate by parts.

----

<form name='WeaveQuestion' data-id='sp4oo3QK' data-controltype='numeric'>
<div class='form-group '>
<div class='controls'>



<div class="input-group">
<input id="sp4oo3QK" type="number" class="form-control">

</div>

<div id='sp4oo3QK_message'></div>
</div>
</div>
</form>
<script text='text/javascript'>
$('#sp4oo3QK').on('change', function() {
correct = Math.abs(this.value - 2.097264024732662) <= 0.001;

if(correct) {
$('#sp4oo3QK_message').html('<div class="alert alert-success"><span class="glyphicon glyphicon-thumbs-up">&nbsp;Correct</span></div>');
} else {
$('#sp4oo3QK_message').html('<div class="alert alert-danger"><span class="glyphicon glyphicon-thumbs-down">&nbsp;Incorrect</span></div>');
}
});
</script>

----



###### Question

Integration by parts can be used to provide "reduction" formulas, where an antiderivative is written in terms of another antiderivative with a lower power. Which is the proper reduction formula for $\int (\log(x))^n dx$?

----

<form name="WeaveQuestion" data-id="Auiqv6H3" data-controltype="radio">
<div class="form-group ">

<div  class="radio"> 
<label>
<input type="radio" name="radio_Auiqv6H3" value="1"><div class="markdown">$\int (\log(x))^{n+1}/(n+1) dx$
</div>
</label>
</div>

<div  class="radio"> 
<label>
<input type="radio" name="radio_Auiqv6H3" value="2"><div class="markdown">$x(\log(x))^n - \int (\log(x))^{n-1} dx$
</div>
</label>
</div>

<div  class="radio"> 
<label>
<input type="radio" name="radio_Auiqv6H3" value="3"><div class="markdown">$x(\log(x))^n - n \int (\log(x))^{n-1} dx$
</div>
</label>
</div>



<div id="Auiqv6H3_message"></div>
</div>
</form>
<script text="text/javascript">
$("input:radio[name='radio_Auiqv6H3']").on("change", function() {
correct = this.value == 3;

if(correct) {
$("#Auiqv6H3_message").html("<div class='alert alert-success'><span class='glyphicon glyphicon-thumbs-up'>&nbsp;Correct</span></div>");
} else {
$("#Auiqv6H3_message").html("<div class='alert alert-warning'><span class='glyphicon glyphicon-thumbs-down'>&nbsp;Incorrect</span></div>");
}
});

</script>

----



###### Question

The [Wikipedia](http://en.wikipedia.org/wiki/Integration_by_parts) page has a rule of thumb with an acronym LIATE to indicate what is a good candidate to be "$u$": **L**og function, **I**nverse functions, **A**lgebraic functions ($x^n$), **T**rigonmetric functions, and **E**xponential functions.

Consider the integral $\int x \cos(x) dx$. Which letter should be tried first?

----

<form name="WeaveQuestion" data-id="bcYFGwFo" data-controltype="radio">
<div class="form-group ">

<div  class="radio"> 
<label>
<input type="radio" name="radio_bcYFGwFo" value="1"><div class="markdown"><p>L</p>
</div>
</label>
</div>

<div  class="radio"> 
<label>
<input type="radio" name="radio_bcYFGwFo" value="2"><div class="markdown"><p>I</p>
</div>
</label>
</div>

<div  class="radio"> 
<label>
<input type="radio" name="radio_bcYFGwFo" value="3"><div class="markdown"><p>A</p>
</div>
</label>
</div>

<div  class="radio"> 
<label>
<input type="radio" name="radio_bcYFGwFo" value="4"><div class="markdown"><p>T</p>
</div>
</label>
</div>

<div  class="radio"> 
<label>
<input type="radio" name="radio_bcYFGwFo" value="5"><div class="markdown"><p>E</p>
</div>
</label>
</div>



<div id="bcYFGwFo_message"></div>
</div>
</form>
<script text="text/javascript">
$("input:radio[name='radio_bcYFGwFo']").on("change", function() {
correct = this.value == 3;

if(correct) {
$("#bcYFGwFo_message").html("<div class='alert alert-success'><span class='glyphicon glyphicon-thumbs-up'>&nbsp;Correct</span></div>");
} else {
$("#bcYFGwFo_message").html("<div class='alert alert-warning'><span class='glyphicon glyphicon-thumbs-down'>&nbsp;Incorrect</span></div>");
}
});

</script>

----



---

Consider the integral $\int x^2\log(x) dx$. Which letter should be tried first?

----

<form name="WeaveQuestion" data-id="s3AjgSrf" data-controltype="radio">
<div class="form-group ">

<div  class="radio"> 
<label>
<input type="radio" name="radio_s3AjgSrf" value="1"><div class="markdown"><p>L</p>
</div>
</label>
</div>

<div  class="radio"> 
<label>
<input type="radio" name="radio_s3AjgSrf" value="2"><div class="markdown"><p>I</p>
</div>
</label>
</div>

<div  class="radio"> 
<label>
<input type="radio" name="radio_s3AjgSrf" value="3"><div class="markdown"><p>A</p>
</div>
</label>
</div>

<div  class="radio"> 
<label>
<input type="radio" name="radio_s3AjgSrf" value="4"><div class="markdown"><p>T</p>
</div>
</label>
</div>

<div  class="radio"> 
<label>
<input type="radio" name="radio_s3AjgSrf" value="5"><div class="markdown"><p>E</p>
</div>
</label>
</div>



<div id="s3AjgSrf_message"></div>
</div>
</form>
<script text="text/javascript">
$("input:radio[name='radio_s3AjgSrf']").on("change", function() {
correct = this.value == 1;

if(correct) {
$("#s3AjgSrf_message").html("<div class='alert alert-success'><span class='glyphicon glyphicon-thumbs-up'>&nbsp;Correct</span></div>");
} else {
$("#s3AjgSrf_message").html("<div class='alert alert-warning'><span class='glyphicon glyphicon-thumbs-down'>&nbsp;Incorrect</span></div>");
}
});

</script>

----



---

Consider the integral $\int x^2 \sin^{-1}(x) dx$. Which letter should be tried first?

----

<form name="WeaveQuestion" data-id="tPivnG5H" data-controltype="radio">
<div class="form-group ">

<div  class="radio"> 
<label>
<input type="radio" name="radio_tPivnG5H" value="1"><div class="markdown"><p>L</p>
</div>
</label>
</div>

<div  class="radio"> 
<label>
<input type="radio" name="radio_tPivnG5H" value="2"><div class="markdown"><p>I</p>
</div>
</label>
</div>

<div  class="radio"> 
<label>
<input type="radio" name="radio_tPivnG5H" value="3"><div class="markdown"><p>A</p>
</div>
</label>
</div>

<div  class="radio"> 
<label>
<input type="radio" name="radio_tPivnG5H" value="4"><div class="markdown"><p>T</p>
</div>
</label>
</div>

<div  class="radio"> 
<label>
<input type="radio" name="radio_tPivnG5H" value="5"><div class="markdown"><p>E</p>
</div>
</label>
</div>



<div id="tPivnG5H_message"></div>
</div>
</form>
<script text="text/javascript">
$("input:radio[name='radio_tPivnG5H']").on("change", function() {
correct = this.value == 2;

if(correct) {
$("#tPivnG5H_message").html("<div class='alert alert-success'><span class='glyphicon glyphicon-thumbs-up'>&nbsp;Correct</span></div>");
} else {
$("#tPivnG5H_message").html("<div class='alert alert-warning'><span class='glyphicon glyphicon-thumbs-down'>&nbsp;Incorrect</span></div>");
}
});

</script>

----



---

Consider the integral $\int e^x \sin(x) dx$. Which letter should be tried first?

----

<form name="WeaveQuestion" data-id="PEZvROsI" data-controltype="radio">
<div class="form-group ">

<div  class="radio"> 
<label>
<input type="radio" name="radio_PEZvROsI" value="1"><div class="markdown"><p>L</p>
</div>
</label>
</div>

<div  class="radio"> 
<label>
<input type="radio" name="radio_PEZvROsI" value="2"><div class="markdown"><p>I</p>
</div>
</label>
</div>

<div  class="radio"> 
<label>
<input type="radio" name="radio_PEZvROsI" value="3"><div class="markdown"><p>A</p>
</div>
</label>
</div>

<div  class="radio"> 
<label>
<input type="radio" name="radio_PEZvROsI" value="4"><div class="markdown"><p>T</p>
</div>
</label>
</div>

<div  class="radio"> 
<label>
<input type="radio" name="radio_PEZvROsI" value="5"><div class="markdown"><p>E</p>
</div>
</label>
</div>



<div id="PEZvROsI_message"></div>
</div>
</form>
<script text="text/javascript">
$("input:radio[name='radio_PEZvROsI']").on("change", function() {
correct = this.value == 4;

if(correct) {
$("#PEZvROsI_message").html("<div class='alert alert-success'><span class='glyphicon glyphicon-thumbs-up'>&nbsp;Correct</span></div>");
} else {
$("#PEZvROsI_message").html("<div class='alert alert-warning'><span class='glyphicon glyphicon-thumbs-down'>&nbsp;Incorrect</span></div>");
}
});

</script>

----



###### Question

Find an antiderivative for $\cos^{-1}(x)$ using the integration by parts formula.

----

<form name="WeaveQuestion" data-id="tSouCT0D" data-controltype="radio">
<div class="form-group ">

<div  class="radio"> 
<label>
<input type="radio" name="radio_tSouCT0D" value="1"><div class="markdown">$-\sin^{-1}(x)$
</div>
</label>
</div>

<div  class="radio"> 
<label>
<input type="radio" name="radio_tSouCT0D" value="2"><div class="markdown">$x^2/2 \cos^{-1}(x) - x\sqrt{1-x^2}/4 - \cos^{-1}(x)/4$
</div>
</label>
</div>

<div  class="radio"> 
<label>
<input type="radio" name="radio_tSouCT0D" value="3"><div class="markdown">$x\cos^{-1}(x)-\sqrt{1 - x^2}$
</div>
</label>
</div>



<div id="tSouCT0D_message"></div>
</div>
</form>
<script text="text/javascript">
$("input:radio[name='radio_tSouCT0D']").on("change", function() {
correct = this.value == 3;

if(correct) {
$("#tSouCT0D_message").html("<div class='alert alert-success'><span class='glyphicon glyphicon-thumbs-up'>&nbsp;Correct</span></div>");
} else {
$("#tSouCT0D_message").html("<div class='alert alert-warning'><span class='glyphicon glyphicon-thumbs-down'>&nbsp;Incorrect</span></div>");
}
});

</script>

----



