<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">



<link
  href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.4/css/bootstrap.min.css"
  rel="stylesheet">

<style>
.julia {display: block; font-family: "Source Code Pro";
        color:#0033CC;
        }
.hljl {font-family: "Source Code Pro";
        color:#0033CC;
        }
body { padding-top: 60px; }
h5:before {content:"\2746\ ";}
h6:before {content:"\2742\ ";}
pre {display: block;}
th, td {
  padding: 15px;
  text-align: left;
  border-bottom: 1px solid #ddd;
}
tr:hover {background-color: #f5f5f5;}

.admonition-title:before {content:"\2746\ ";}
.admonition-title { color:#0033CC}

</style>


<!-- .julia:before {content: "julia> "} -->

<style></style>


<script src="https://code.jquery.com/jquery.js"></script>


<script  type="text/x-mathjax-config">
MathJax.Hub.Config({
  tex2jax: {
    inlineMath: [ ["\$","\$"], ["\\(","\\)"]]
  },
  displayAlign: "left",
  displayIndent: "5%"
});
</script>
<!-- not TeX-AMS-MML_HTMLorMML-->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-MML-AM_CHTML" async></script>
</script>


<script>
window.PlotlyConfig = {MathJaxConfig: 'local'}
</script>
<script src="https://cdn.plot.ly/plotly-latest.min.js"></script>


<script type="text/javascript">
$( document ).ready(function() {
  $("h1").each(function(index) {
       var title = $( this ).text()
       $("#page_title").html("<strong>" + title + "</strong>");
       document.title = title
  });
  $( "h2" ).each(function( index ) {
    var nm =  $( this ).text();
    var id = $.trim(nm).replace(/ /g,'');
    this.id = id
    $("#page_dropdown").append("<li><a href='#" + id + "'>" + nm + "</a></li>");
  });
  $('[data-toggle="popover"]').popover();
});
</script>

</head>


<body data-spy="scroll" >

<nav class="navbar navbar-default  navbar-fixed-top">
  <div class="container-fluid">
    <!-- Brand and toggle get grouped for better mobile display -->
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#bs-example-navbar-collapse-1">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
         
    </div>

    <!-- Collect the nav links, forms, and other content for toggling -->
    <div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">
      <ul class="nav navbar-nav">
        <li><a href="#" id="page_title"></a></li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
         <li class="dropdown">
           <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
           Jump to... <span class="caret"></span></a>
          <ul class="dropdown-menu" role="menu" id="page_dropdown"></ul>
        </li>
      </ul>
    </div><!-- /.navbar-collapse -->
  </div><!-- /.container-fluid -->
</nav>

<header>
</header>
          <div class="title">
            
            
            
          </div>



<div class="container-fluid">
  <div class="span10 offset1">
<h1>Taylor Polynomials and other Approximating Polynomials</h1>
<p>The tangent line was seen to be the &quot;best&quot; linear approximation to a function at a point <span class="math">$c$</span>. Approximating a function by a linear function gives an easier to use approximation at the expense of accuracy. It suggests a tradeoff between ease and accuracy. Is there a way to gain more accuracy at the expense of ease?</p>
<p>Quadratic functions are still fairly easy to work with. Is it possible to find the best &quot;quadratic&quot; approximation to a function at a point <span class="math">$c$</span>.</p>
<p>More generally, for a given <span class="math">$n$</span>, what would be the best polynomial of degree <span class="math">$n$</span> to approximate <span class="math">$f(x)$</span> at <span class="math">$c$</span>?</p>
<p>We will see in this section how the Taylor polynomial answers these questions, and is the appropriate generalization of the tangent line approximation.</p>

<h2>The secant line and the tangent line</h2>
<p>To motivate, we have two related formulas. Suppose we have a function <span class="math">$f(x)$</span> which is defined in a neighborhood of <span class="math">$c$</span> and has as many derivatives as we care to take at <span class="math">$c$</span>.</p>
<p>The secant line connecting <span class="math">$(c, f(c))$</span> and <span class="math">$(c+h, f(c+h))$</span> for a value of <span class="math">$h>0$</span> is given in point-slope form by</p>
<p class="math">\[
~
sl(x) = f(c) + \frac{(f(c+h) - f(c))}{h} \cdot (x-c).
~
\]</p>
<p>The slope is the familiar approximation to the derivative: <span class="math">$(f(c+h)-f(c))/h$</span>.</p>
<p>The <em>tangent line</em> to the graph of <span class="math">$f(x)$</span> at <span class="math">$x=c$</span> is described by the function</p>
<p class="math">\[
~
tl(x) = f(c) + f'(c) \cdot(x - c).
~
\]</p>
<p>The secant line is important here, as it approximates the tangent line, which in turn is important, as it is the linear function that best approximates the function at the point <span class="math">$(c, f(c))$</span>. This is quantified by the <em>Mean Value Theorem</em> which states that there exists some <span class="math">$\xi$</span> between <span class="math">$x$</span> and <span class="math">$c$</span> for which:</p>
<p class="math">\[
~
f(x) - tl(x) = \frac{f''(\xi)}{2} \cdot (x-c)^2.
~
\]</p>
<p>&#40;The term &quot;best&quot; is deserved, as any other straight line will differ at least in an <span class="math">$(x-c)$</span> term, which in general is larger than an <span class="math">$(x-c)^2$</span> term for <span class="math">$x$</span> &quot;near&quot; <span class="math">$c$</span>.&#41;</p>
<p>The secant line also has an interpretation that will generalize–-it is the smallest order polynomial that goes through the points <span class="math">$(c,f(c))$</span> and <span class="math">$(c+h, f(c+h))$</span>. This is obvious from the construction–-as this is how the slope is derived–-but from the formula itself requires showing <span class="math">$tl(c) = f(c)$</span> and <span class="math">$tl(c+h) = f(c+h)$</span>. The former is straightforward, as <span class="math">$(c-c) = 0$</span>, so clearly <span class="math">$tl(c) = f(c)$</span>. The latter requires a bit of algebra.</p>
<p>Now, we take a small detour to define some notation. Instead of writing our two points as <span class="math">$c$</span> and <span class="math">$c+h$</span>, let&#39;s use <span class="math">$x_0$</span> and <span class="math">$x_1$</span>. For any set of points <span class="math">$x_0, x_1, \dots, x_n$</span>, define the <strong>divided differences</strong> of <span class="math">$f$</span> inductively, as follows:</p>
<p class="math">\[
~
\begin{align}
f[x_0] &= f(x_0) \\
f[x_0, x_1] &= \frac{f[x_1] - f[x_0]}{x_1 - x_0}\\
\cdots &\\
f[x_0, x_1, x_2, \dots, x_n] &= \frac{f[x_1, \dots, x_n] - f[x_0, x_1, x_2, \dots, x_{n-1}]}{x_n - x_0}.
\end{align}
~
\]</p>
<p>We see the first two values look familiar, and to generate more we just take certain ratios akin to those formed when finding a secant line.</p>
<p>With this notation the secant line can be re-expressed as:</p>
<p class="math">\[
~
sl(x) = f[c] + f[c, c+h] \cdot (x-c)
~
\]</p>
<p>If we think of <span class="math">$f[c, c+h]$</span> as an approximate <em>first</em> derivative, we have an even stronger parallel between a secant line <span class="math">$x=c$</span> and the tangent line at <span class="math">$x=c$</span>.</p>
<p>To see that this isn&#39;t far-fetched, we investigate with <code>SymPy</code>. First we create a recursive function to compute the divided differences:</p>


<pre class='hljl'>
<span class='hljl-nf'>divided_differences</span><span class='hljl-p'>(</span><span class='hljl-n'>f</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>x</span><span class='hljl-p'>)</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-nf'>f</span><span class='hljl-p'>(</span><span class='hljl-n'>x</span><span class='hljl-p'>)</span><span class='hljl-t'>
</span><span class='hljl-k'>function</span><span class='hljl-t'> </span><span class='hljl-nf'>divided_differences</span><span class='hljl-p'>(</span><span class='hljl-n'>f</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>x</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>xs</span><span class='hljl-oB'>...</span><span class='hljl-p'>)</span><span class='hljl-t'>
    </span><span class='hljl-n'>xs</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-nf'>sort</span><span class='hljl-p'>(</span><span class='hljl-nf'>vcat</span><span class='hljl-p'>(</span><span class='hljl-n'>x</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>xs</span><span class='hljl-oB'>...</span><span class='hljl-p'>))</span><span class='hljl-t'>
    </span><span class='hljl-p'>(</span><span class='hljl-nf'>divided_differences</span><span class='hljl-p'>(</span><span class='hljl-n'>f</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>xs</span><span class='hljl-p'>[</span><span class='hljl-ni'>2</span><span class='hljl-oB'>:</span><span class='hljl-k'>end</span><span class='hljl-p'>]</span><span class='hljl-oB'>...</span><span class='hljl-p'>)</span><span class='hljl-t'> </span><span class='hljl-oB'>-</span><span class='hljl-t'> </span><span class='hljl-nf'>divided_differences</span><span class='hljl-p'>(</span><span class='hljl-n'>f</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>xs</span><span class='hljl-p'>[</span><span class='hljl-ni'>1</span><span class='hljl-oB'>:</span><span class='hljl-k'>end</span><span class='hljl-oB'>-</span><span class='hljl-ni'>1</span><span class='hljl-p'>]</span><span class='hljl-oB'>...</span><span class='hljl-p'>))</span><span class='hljl-t'> </span><span class='hljl-oB'>/</span><span class='hljl-t'> </span><span class='hljl-p'>(</span><span class='hljl-n'>xs</span><span class='hljl-p'>[</span><span class='hljl-k'>end</span><span class='hljl-p'>]</span><span class='hljl-t'> </span><span class='hljl-oB'>-</span><span class='hljl-t'> </span><span class='hljl-n'>xs</span><span class='hljl-p'>[</span><span class='hljl-ni'>1</span><span class='hljl-p'>])</span><span class='hljl-t'>
</span><span class='hljl-k'>end</span>
</pre>


<pre class="output">
divided_differences &#40;generic function with 2 methods&#41;
</pre>


<p>With <code>SymPy</code> we have, using <span class="math">$u$</span> in place of <span class="math">$f$</span>:</p>


<pre class='hljl'>
<span class='hljl-k'>using</span><span class='hljl-t'> </span><span class='hljl-n'>CalculusWithJulia</span><span class='hljl-t'>   </span><span class='hljl-cs'># loads `SymPy`, `ForwardDiff`</span><span class='hljl-t'>
</span><span class='hljl-nd'>@vars</span><span class='hljl-t'> </span><span class='hljl-n'>x</span><span class='hljl-t'> </span><span class='hljl-n'>c</span><span class='hljl-t'> </span><span class='hljl-n'>real</span><span class='hljl-oB'>=</span><span class='hljl-kc'>true</span><span class='hljl-t'>
</span><span class='hljl-nd'>@vars</span><span class='hljl-t'> </span><span class='hljl-n'>h</span><span class='hljl-t'> </span><span class='hljl-n'>positive</span><span class='hljl-oB'>=</span><span class='hljl-kc'>true</span><span class='hljl-t'>
</span><span class='hljl-n'>u</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-nf'>SymFunction</span><span class='hljl-p'>(</span><span class='hljl-s'>&quot;u&quot;</span><span class='hljl-p'>)</span><span class='hljl-t'>

</span><span class='hljl-n'>ex</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-nf'>divided_differences</span><span class='hljl-p'>(</span><span class='hljl-n'>u</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>c</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>c</span><span class='hljl-oB'>+</span><span class='hljl-n'>h</span><span class='hljl-p'>)</span>
</pre>



<div class="well well-sm">\begin{equation*}\frac{- u{\left (c \right )} + u{\left (c + h \right )}}{h}\end{equation*}</div>

<p>We can take a limit and see the familiar &#40;yet differently represented&#41; value of <span class="math">$u'(c)$</span>:</p>


<pre class='hljl'>
<span class='hljl-nf'>limit</span><span class='hljl-p'>(</span><span class='hljl-n'>ex</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>h</span><span class='hljl-t'> </span><span class='hljl-oB'>=&gt;</span><span class='hljl-t'> </span><span class='hljl-ni'>0</span><span class='hljl-p'>)</span>
</pre>



<div class="well well-sm">\begin{equation*}\left. \frac{d}{d \xi_{1}} u{\left (\xi_{1} \right )} \right|_{\substack{ \xi_{1}=c }}\end{equation*}</div>

<p>Now, let&#39;s look at:</p>


<pre class='hljl'>
<span class='hljl-n'>ex</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-nf'>divided_differences</span><span class='hljl-p'>(</span><span class='hljl-n'>u</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>c</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>c</span><span class='hljl-oB'>+</span><span class='hljl-n'>h</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>c</span><span class='hljl-oB'>+</span><span class='hljl-ni'>2</span><span class='hljl-n'>h</span><span class='hljl-p'>)</span><span class='hljl-t'>
</span><span class='hljl-nf'>simplify</span><span class='hljl-p'>(</span><span class='hljl-n'>ex</span><span class='hljl-p'>)</span>
</pre>



<div class="well well-sm">\begin{equation*}\frac{u{\left (c \right )} - 2 u{\left (c + h \right )} + u{\left (c + 2 h \right )}}{2 h^{2}}\end{equation*}</div>

<p>Not so bad after simplification. The limit shows this to be an approximation to the second derivative divided by <span class="math">$2$</span>:</p>


<pre class='hljl'>
<span class='hljl-nf'>limit</span><span class='hljl-p'>(</span><span class='hljl-n'>ex</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>h</span><span class='hljl-t'> </span><span class='hljl-oB'>=&gt;</span><span class='hljl-t'> </span><span class='hljl-ni'>0</span><span class='hljl-p'>)</span>
</pre>



<div class="well well-sm">\begin{equation*}\frac{\left. \frac{d^{2}}{d \xi_{1}^{2}} u{\left (\xi_{1} \right )} \right|_{\substack{ \xi_{1}=c }}}{2}\end{equation*}</div>

<p>&#40;The expression is, up to a divisor of <span class="math">$2$</span>, the second order forward <a href="http://tinyurl.com/n4235xy">difference equation</a>, a well-known approximation to <span class="math">$f''$</span>.&#41;</p>
<p>This relationship between higher-order divided differences and higher-order derivatives generalizes. This is expressed in this <a href="http://tinyurl.com/zjogv83">theorem</a>:</p>
<blockquote>
<p>Suppose <span class="math">$m=x_0 < x_1 < x_2 < \dots < x_n=M$</span> are distinct points. If <span class="math">$f$</span> has <span class="math">$n$</span> continuous derivatives then there exists a value <span class="math">$\xi$</span> where <span class="math">$m < \xi < M$</span> satisfying:</p>
</blockquote>
<p class="math">\[
~
f[x_0, x_1, \dots, x_n] = \frac{1}{n!} \cdot f^{(n)}(\xi).
~
\]</p>
<p>This immediately applies to the above, where we parameterized by <span class="math">$h$</span>: <span class="math">$x_0=c, x_1=c+h, x_2 = c+2h$</span>. For then, as <span class="math">$h$</span> goes to <span class="math">$0$</span>, it must be that <span class="math">$m, M \rightarrow c$</span>, and so the limit of the divided differences must converge to <span class="math">$(1/2!) \cdot f^{(2)}(c)$</span>, as <span class="math">$f^{(2)}(\xi)$</span> converges to <span class="math">$f^{(2)}(c)$</span>.</p>
<p>A proof based on Rolle&#39;s theorem appears in the appendix.</p>
<h2>Quadratic approximations</h2>
<p>Why the fuss? The answer comes from a result of Newton on <em>interpolating</em> polynomials. Consider a function <span class="math">$f$</span> and <span class="math">$n+1$</span> points <span class="math">$x_0$</span>, <span class="math">$x_1, \dots, x_n$</span>. Then an interpolating polynomial is <em>the</em> polynomial of least degree that goes through each point <span class="math">$(x_i, f(x_i))$</span>. The <a href="https://en.wikipedia.org/wiki/Newton_polynomial">Newton form</a> of such a polynomial can be written as:</p>
<p class="math">\[
~
f[x_0] + f[x_0,x_1] \cdot (x-x_0) + f[x_0, x_1, x_2] \cdot (x-x_0) \cdot (x-x_1) + \cdots + f[x_0, x_1, \dots, x_n] \cdot (x-x_0)\cdot \cdots \cdot (x-x_{n-1}).
~
\]</p>
<p>The case <span class="math">$n=0$</span> gives the value <span class="math">$f[x_0] = f(c)$</span>, which can be interpreted as the slope-<span class="math">$0$</span> line that goes through the point <span class="math">$(c,f(c))$</span>.</p>
<p>We are familiar with the case <span class="math">$n=1$</span>, with <span class="math">$x_0=c$</span> and <span class="math">$x_1=c+h$</span>, this becomes our secant-line formula:</p>
<p class="math">\[
~
f[c] + f[c, c+h](x-c).
~
\]</p>
<p>As mentioned, we can verify directly that it interpolates the points <span class="math">$(c,f(c))$</span> and <span class="math">$(c+h, f(c+h))$</span>. He we let <code>SymPy</code> do the algebra:</p>


<pre class='hljl'>
<span class='hljl-n'>p</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-nf'>divided_differences</span><span class='hljl-p'>(</span><span class='hljl-n'>u</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>c</span><span class='hljl-p'>)</span><span class='hljl-t'> </span><span class='hljl-oB'>+</span><span class='hljl-t'> </span><span class='hljl-nf'>divided_differences</span><span class='hljl-p'>(</span><span class='hljl-n'>u</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>c</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>c</span><span class='hljl-oB'>+</span><span class='hljl-n'>h</span><span class='hljl-p'>)</span><span class='hljl-t'> </span><span class='hljl-oB'>*</span><span class='hljl-t'> </span><span class='hljl-p'>(</span><span class='hljl-n'>x</span><span class='hljl-oB'>-</span><span class='hljl-n'>c</span><span class='hljl-p'>)</span><span class='hljl-t'>
</span><span class='hljl-nf'>p</span><span class='hljl-p'>(</span><span class='hljl-n'>x</span><span class='hljl-t'> </span><span class='hljl-oB'>=&gt;</span><span class='hljl-t'> </span><span class='hljl-n'>c</span><span class='hljl-p'>)</span><span class='hljl-t'> </span><span class='hljl-oB'>-</span><span class='hljl-t'> </span><span class='hljl-nf'>u</span><span class='hljl-p'>(</span><span class='hljl-n'>c</span><span class='hljl-p'>)</span>
</pre>



<div class="well well-sm">\begin{equation*}0\end{equation*}</div>

<p>and</p>


<pre class='hljl'>
<span class='hljl-nf'>p</span><span class='hljl-p'>(</span><span class='hljl-n'>x</span><span class='hljl-t'> </span><span class='hljl-oB'>=&gt;</span><span class='hljl-t'> </span><span class='hljl-n'>c</span><span class='hljl-oB'>+</span><span class='hljl-n'>h</span><span class='hljl-p'>)</span><span class='hljl-t'> </span><span class='hljl-oB'>-</span><span class='hljl-t'> </span><span class='hljl-nf'>u</span><span class='hljl-p'>(</span><span class='hljl-n'>c</span><span class='hljl-oB'>+</span><span class='hljl-n'>h</span><span class='hljl-p'>)</span>
</pre>



<div class="well well-sm">\begin{equation*}0\end{equation*}</div>

<p>Now for something new. Take the <span class="math">$n=2$</span> case with <span class="math">$x_0 = c$</span>, <span class="math">$x_1 = c + h$</span>, and <span class="math">$x_2 = c+2h$</span>. Then the interpolating polynomial is:</p>
<p class="math">\[
~
f[c] + f[c, c+h](x-c) + f[c, c+h, c+2h](x-c)(x-(c+h)).
~
\]</p>
<p>We add the next term to our previous polynomial and simplify</p>


<pre class='hljl'>
<span class='hljl-n'>p</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-n'>p</span><span class='hljl-t'> </span><span class='hljl-oB'>+</span><span class='hljl-t'> </span><span class='hljl-nf'>divided_differences</span><span class='hljl-p'>(</span><span class='hljl-n'>u</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>c</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>c</span><span class='hljl-oB'>+</span><span class='hljl-n'>h</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>c</span><span class='hljl-oB'>+</span><span class='hljl-ni'>2</span><span class='hljl-n'>h</span><span class='hljl-p'>)</span><span class='hljl-oB'>*</span><span class='hljl-p'>(</span><span class='hljl-n'>x</span><span class='hljl-oB'>-</span><span class='hljl-n'>c</span><span class='hljl-p'>)</span><span class='hljl-oB'>*</span><span class='hljl-p'>(</span><span class='hljl-n'>x</span><span class='hljl-oB'>-</span><span class='hljl-p'>(</span><span class='hljl-n'>c</span><span class='hljl-oB'>+</span><span class='hljl-n'>h</span><span class='hljl-p'>))</span><span class='hljl-t'>
</span><span class='hljl-nf'>simplify</span><span class='hljl-p'>(</span><span class='hljl-n'>p</span><span class='hljl-p'>)</span>
</pre>



<div class="well well-sm">\begin{equation*}\frac{h^{2} u{\left (c \right )} + h \left(c - x\right) \left(u{\left (c \right )} - u{\left (c + h \right )}\right) + \frac{\left(c - x\right) \left(c + h - x\right) \left(u{\left (c \right )} - 2 u{\left (c + h \right )} + u{\left (c + 2 h \right )}\right)}{2}}{h^{2}}\end{equation*}</div>

<p>We can check that this interpolates the three points. Notice that at <span class="math">$x_0=c$</span> and <span class="math">$x_1=c+h$</span>, the last term, <span class="math">$f[x_0, x_1, x_2]\cdot(x-x_0)(x-x_1)$</span>, vanishes, so we already have the polynomial interpolating there. Only value <span class="math">$x_2=c+2h$</span> remains to be checked:</p>


<pre class='hljl'>
<span class='hljl-nf'>p</span><span class='hljl-p'>(</span><span class='hljl-n'>x</span><span class='hljl-t'> </span><span class='hljl-oB'>=&gt;</span><span class='hljl-t'> </span><span class='hljl-n'>c</span><span class='hljl-oB'>+</span><span class='hljl-ni'>2</span><span class='hljl-n'>h</span><span class='hljl-p'>)</span><span class='hljl-t'> </span><span class='hljl-oB'>-</span><span class='hljl-t'> </span><span class='hljl-nf'>u</span><span class='hljl-p'>(</span><span class='hljl-n'>c</span><span class='hljl-oB'>+</span><span class='hljl-ni'>2</span><span class='hljl-n'>h</span><span class='hljl-p'>)</span>
</pre>



<div class="well well-sm">\begin{equation*}h \left(- \frac{- u{\left (c \right )} + u{\left (c + h \right )}}{h} + \frac{- u{\left (c + h \right )} + u{\left (c + 2 h \right )}}{h}\right) - u{\left (c \right )} + 2 u{\left (c + h \right )} - u{\left (c + 2 h \right )}\end{equation*}</div>

<p>Hmm, doesn&#39;t seem correct–-that was supposed to be <span class="math">$0$</span>. The issue isn&#39;t the math, it is that SymPy needs to be encouraged to simplify:</p>


<pre class='hljl'>
<span class='hljl-nf'>simplify</span><span class='hljl-p'>(</span><span class='hljl-nf'>p</span><span class='hljl-p'>(</span><span class='hljl-n'>x</span><span class='hljl-t'> </span><span class='hljl-oB'>=&gt;</span><span class='hljl-t'> </span><span class='hljl-n'>c</span><span class='hljl-oB'>+</span><span class='hljl-ni'>2</span><span class='hljl-n'>h</span><span class='hljl-p'>)</span><span class='hljl-t'> </span><span class='hljl-oB'>-</span><span class='hljl-t'> </span><span class='hljl-nf'>u</span><span class='hljl-p'>(</span><span class='hljl-n'>c</span><span class='hljl-oB'>+</span><span class='hljl-ni'>2</span><span class='hljl-n'>h</span><span class='hljl-p'>))</span>
</pre>



<div class="well well-sm">\begin{equation*}0\end{equation*}</div>

<p>By contrast, at the point <span class="math">$x=c+3h$</span> we have no guarantee of interpolation, and indeed don&#39;t, as this expression is non-zero:</p>


<pre class='hljl'>
<span class='hljl-nf'>simplify</span><span class='hljl-p'>(</span><span class='hljl-nf'>p</span><span class='hljl-p'>(</span><span class='hljl-n'>x</span><span class='hljl-t'> </span><span class='hljl-oB'>=&gt;</span><span class='hljl-t'> </span><span class='hljl-n'>c</span><span class='hljl-oB'>+</span><span class='hljl-ni'>3</span><span class='hljl-n'>h</span><span class='hljl-p'>)</span><span class='hljl-t'> </span><span class='hljl-oB'>-</span><span class='hljl-t'> </span><span class='hljl-nf'>u</span><span class='hljl-p'>(</span><span class='hljl-n'>c</span><span class='hljl-oB'>+</span><span class='hljl-ni'>3</span><span class='hljl-n'>h</span><span class='hljl-p'>))</span>
</pre>



<div class="well well-sm">\begin{equation*}u{\left (c \right )} - 3 u{\left (c + h \right )} + 3 u{\left (c + 2 h \right )} - u{\left (c + 3 h \right )}\end{equation*}</div>

<p>Interpolating polynomials are of interest in their own right,  but for now we want to use them as motivation for the best polynomial approximation of a certain degree for a function. Motivated by how the secant line leads to the tangent line, we note that coefficients of the quadratic interpolating polynomial above have limits as <span class="math">$h$</span> goes to <span class="math">$0$</span>, leaving this polynomial:</p>
<p class="math">\[
~
f(c) + f'(c) \cdot (x-c) + \frac{1}{2!} \cdot f''(c) (x-c)^2.
~
\]</p>
<p>This is clearly related to the tangent line approximation of <span class="math">$f(x)$</span> at <span class="math">$x=c$</span>, but carrying an extra quadratic term.</p>
<p>Here we visualize the approximations with the function <span class="math">$f(x) = \cos(x)$</span> at <span class="math">$c=0$</span>.</p>


<pre class='hljl'>
<span class='hljl-nf'>f</span><span class='hljl-p'>(</span><span class='hljl-n'>x</span><span class='hljl-p'>)</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-nf'>cos</span><span class='hljl-p'>(</span><span class='hljl-n'>x</span><span class='hljl-p'>)</span><span class='hljl-t'>
</span><span class='hljl-n'>a</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>b</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-oB'>-</span><span class='hljl-n'>pi</span><span class='hljl-oB'>/</span><span class='hljl-ni'>2</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>pi</span><span class='hljl-oB'>/</span><span class='hljl-ni'>2</span><span class='hljl-t'>
</span><span class='hljl-n'>c</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-ni'>0</span><span class='hljl-t'>
</span><span class='hljl-n'>h</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-ni'>1</span><span class='hljl-oB'>/</span><span class='hljl-ni'>4</span><span class='hljl-t'>

</span><span class='hljl-n'>fp</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-oB'>-</span><span class='hljl-nf'>sin</span><span class='hljl-p'>(</span><span class='hljl-n'>c</span><span class='hljl-p'>)</span><span class='hljl-t'>  </span><span class='hljl-cs'># by hand, or use diff(f), ...</span><span class='hljl-t'>
</span><span class='hljl-n'>fpp</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-oB'>-</span><span class='hljl-nf'>cos</span><span class='hljl-p'>(</span><span class='hljl-n'>c</span><span class='hljl-p'>)</span><span class='hljl-t'>


</span><span class='hljl-n'>p</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-nf'>plot</span><span class='hljl-p'>(</span><span class='hljl-n'>f</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>a</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>b</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>linewidth</span><span class='hljl-oB'>=</span><span class='hljl-ni'>5</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>legend</span><span class='hljl-oB'>=</span><span class='hljl-kc'>false</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>color</span><span class='hljl-oB'>=:</span><span class='hljl-n'>blue</span><span class='hljl-p'>)</span><span class='hljl-t'>
</span><span class='hljl-nf'>plot!</span><span class='hljl-p'>(</span><span class='hljl-n'>p</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>x</span><span class='hljl-oB'>-&gt;</span><span class='hljl-nf'>f</span><span class='hljl-p'>(</span><span class='hljl-n'>c</span><span class='hljl-p'>)</span><span class='hljl-t'> </span><span class='hljl-oB'>+</span><span class='hljl-t'> </span><span class='hljl-n'>fp</span><span class='hljl-oB'>*</span><span class='hljl-p'>(</span><span class='hljl-n'>x</span><span class='hljl-oB'>-</span><span class='hljl-n'>c</span><span class='hljl-p'>);</span><span class='hljl-t'>  </span><span class='hljl-n'>color</span><span class='hljl-oB'>=:</span><span class='hljl-n'>green</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>alpha</span><span class='hljl-oB'>=</span><span class='hljl-nfB'>0.25</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>linewidth</span><span class='hljl-oB'>=</span><span class='hljl-ni'>5</span><span class='hljl-p'>)</span><span class='hljl-t'>                     </span><span class='hljl-cs'># tangent line is flat</span><span class='hljl-t'>
</span><span class='hljl-nf'>plot!</span><span class='hljl-p'>(</span><span class='hljl-n'>p</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>x</span><span class='hljl-oB'>-&gt;</span><span class='hljl-nf'>f</span><span class='hljl-p'>(</span><span class='hljl-n'>c</span><span class='hljl-p'>)</span><span class='hljl-t'> </span><span class='hljl-oB'>+</span><span class='hljl-t'> </span><span class='hljl-n'>fp</span><span class='hljl-oB'>*</span><span class='hljl-p'>(</span><span class='hljl-n'>x</span><span class='hljl-oB'>-</span><span class='hljl-n'>c</span><span class='hljl-p'>)</span><span class='hljl-t'> </span><span class='hljl-oB'>+</span><span class='hljl-t'> </span><span class='hljl-p'>(</span><span class='hljl-ni'>1</span><span class='hljl-oB'>/</span><span class='hljl-ni'>2</span><span class='hljl-p'>)</span><span class='hljl-oB'>*</span><span class='hljl-n'>fpp</span><span class='hljl-oB'>*</span><span class='hljl-p'>(</span><span class='hljl-n'>x</span><span class='hljl-oB'>-</span><span class='hljl-n'>c</span><span class='hljl-p'>)</span><span class='hljl-oB'>^</span><span class='hljl-ni'>2</span><span class='hljl-p'>;</span><span class='hljl-t'> </span><span class='hljl-n'>color</span><span class='hljl-oB'>=:</span><span class='hljl-n'>green</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>alpha</span><span class='hljl-oB'>=</span><span class='hljl-nfB'>0.25</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>linewidth</span><span class='hljl-oB'>=</span><span class='hljl-ni'>5</span><span class='hljl-p'>)</span><span class='hljl-t'>  </span><span class='hljl-cs'># a parabola</span><span class='hljl-t'>
</span><span class='hljl-n'>p</span>
</pre>



    <div id="84152ab2-209d-49e5-a38e-fef6c65aa2d1" style="width:576px;height:384px;"></div>
    <script>
    PLOT = document.getElementById('84152ab2-209d-49e5-a38e-fef6c65aa2d1');
    Plotly.plot(PLOT, [
    {
        "xaxis": "x1",
        "colorbar": {
            "title": ""
        },
        "yaxis": "y1",
        "text": [
            null,
            null,
            null,
            null,
            null,
            null,
            null,
            null,
            null,
            null,
            null,
            null,
            null,
            null,
            null,
            null,
            null,
            null,
            null,
            null,
            null,
            null,
            null,
            null,
            null,
            null,
            null,
            null,
            null,
            null,
            null,
            null,
            null,
            null,
            null
        ],
        "x": [
            -1.5554562141504698,
            -1.5401161015060427,
            -1.398274609821354,
            -1.2564331181366653,
            -1.171192293875998,
            -1.0859514696153307,
            -1.013881437546565,
            -0.9418114054777994,
            -0.8635231501006033,
            -0.7852348947234071,
            -0.7130600479845179,
            -0.6408852012456286,
            -0.5635061376192187,
            -0.48612707399280874,
            -0.3964758403847387,
            -0.3068246067766686,
            -0.22715317027091803,
            -0.1474817337651674,
            -0.07761706358097209,
            -0.007752393396776786,
            0.06841885075851835,
            0.14459009491381347,
            0.22121404568442682,
            0.29783799645504017,
            0.38255557233399284,
            0.4672731482129456,
            0.5478797839911534,
            0.6284864197693613,
            0.7122986183256123,
            0.7961108168818632,
            0.8666628356928043,
            0.9372148545037453,
            1.109486890967787,
            1.271427686336553,
            1.5308693985542767
        ],
        "showlegend": true,
        "mode": "lines",
        "name": "y1",
        "zmin": -0.1,
        "legendgroup": "y1",
        "zmax": 0.1,
        "line": {
            "color": "rgba(0, 0, 255, 1.000)",
            "shape": "linear",
            "dash": "solid",
            "width": 5
        },
        "y": [
            0.015339511014701398,
            0.030675412420937312,
            0.17166717434870793,
            0.30921094955085954,
            0.3890536019564325,
            0.46607110287179804,
            0.5285697983261571,
            0.5883242430613825,
            0.6497634313718201,
            0.707222220148052,
            0.7563636858789748,
            0.8015668055511775,
            0.8453874952692148,
            0.88414893600324,
            0.922427643912399,
            0.953297448140898,
            0.9743114618127554,
            0.9891442673157648,
            0.9969893076459937,
            0.999969950348809,
            0.9976603433323025,
            0.9895650509231215,
            0.9756317894726576,
            0.9559731716178939,
            0.9277136899890839,
            0.8927999257171659,
            0.8536308148768001,
            0.808918300265202,
            0.7568615568015716,
            0.6994913624148118,
            0.6473736431477509,
            0.5920349014277695,
            0.4451210492718674,
            0.29491698699413654,
            0.03991632077017146
        ],
        "type": "scatter",
        "hoverinfo": "text"
    },
    {
        "xaxis": "x1",
        "colorbar": {
            "title": ""
        },
        "yaxis": "y1",
        "text": [
            null,
            null,
            null,
            null,
            null,
            null,
            null,
            null,
            null,
            null,
            null,
            null,
            null,
            null,
            null,
            null,
            null,
            null,
            null
        ],
        "x": [
            -1.6160970553196121,
            -1.3206830907342884,
            -1.143151611473324,
            -0.99305100516728,
            -0.8299996749341085,
            -0.6796807706048265,
            -0.5185230184529199,
            -0.3318059581938597,
            -0.1658738698970732,
            -0.020366381513918376,
            0.13827583915120326,
            0.29786091408581084,
            0.474302621397332,
            0.6421824537672565,
            0.8167385273254362,
            0.9636775600364709,
            1.1430734641353968,
            1.3117109051964875,
            1.5818811631186822
        ],
        "showlegend": true,
        "mode": "lines",
        "name": "y2",
        "zmin": -0.1,
        "legendgroup": "y2",
        "zmax": 0.1,
        "line": {
            "color": "rgba(0, 128, 0, 0.250)",
            "shape": "linear",
            "dash": "solid",
            "width": 5
        },
        "y": [
            1.0,
            1.0,
            1.0,
            1.0,
            1.0,
            1.0,
            1.0,
            1.0,
            1.0,
            1.0,
            1.0,
            1.0,
            1.0,
            1.0,
            1.0,
            1.0,
            1.0,
            1.0,
            1.0
        ],
        "type": "scatter",
        "hoverinfo": "text"
    },
    {
        "xaxis": "x1",
        "colorbar": {
            "title": ""
        },
        "yaxis": "y1",
        "text": [
            null,
            null,
            null,
            null,
            null,
            null,
            null,
            null,
            null,
            null,
            null,
            null,
            null,
            null,
            null,
            null,
            null,
            null,
            null,
            null,
            null,
            null,
            null,
            null,
            null,
            null,
            null,
            null,
            null,
            null,
            null,
            null,
            null,
            null,
            null,
            null,
            null,
            null,
            null
        ],
        "x": [
            -1.6954840373221998,
            -1.6789316727716386,
            -1.5258811617890269,
            -1.3728306508064152,
            -1.2808536731624158,
            -1.1888766955184165,
            -1.1111113314937762,
            -1.033345967469136,
            -0.9488709852400082,
            -0.8643960030108804,
            -0.7865175413401964,
            -0.7086390796695122,
            -0.6251451380399033,
            -0.5416511964102944,
            -0.4449152769627004,
            -0.3481793575151065,
            -0.26221188831342646,
            -0.1762444191117464,
            -0.1008586956233563,
            -0.025472972134966194,
            0.056717702128844014,
            0.13890837639265421,
            0.22158753239743262,
            0.304266688402211,
            0.3956790679780353,
            0.4870914475538596,
            0.5740680201202893,
            0.6610445926867191,
            0.7514800475261652,
            0.8419155023656113,
            0.9180428921837696,
            0.9941702820019278,
            1.087113196291946,
            1.1800561105819642,
            1.2674251913274528,
            1.3547942720729411,
            1.4947663146449264,
            1.6347383572169119,
            1.6562794334443716
        ],
        "showlegend": true,
        "mode": "lines",
        "name": "y3",
        "zmin": -0.1,
        "legendgroup": "y3",
        "zmax": 0.1,
        "line": {
            "color": "rgba(0, 128, 0, 0.250)",
            "shape": "linear",
            "dash": "solid",
            "width": 5
        },
        "y": [
            -0.4373330604071932,
            -0.40940578091788615,
            -0.16415665995131512,
            0.05766800210321721,
            0.1797069339731736,
            0.2932861014266053,
            0.382715804513064,
            0.4660980557576375,
            0.5498219266848281,
            0.6264097749894071,
            0.6906950785820862,
            0.7489153273825733,
            0.8045967781925351,
            0.8533069907136484,
            0.9010251981626018,
            0.9393855675001839,
            0.9656224628135536,
            0.9844689523659815,
            0.9949137617585776,
            0.9996755638453056,
            0.9983915511326119,
            0.9903522314839783,
            0.9754494827430084,
            0.9537108911643759,
            0.9217190375820167,
            0.8813709608599428,
            0.8352229541375855,
            0.7815100232398249,
            0.7176388690850363,
            0.6455891434382302,
            0.5785986240554298,
            0.5058127251921036,
            0.4090924492239544,
            0.30373378793908345,
            0.19681669219428488,
            0.08226624017917483,
            -0.11716316769858759,
            -0.33618474827812395,
            -0.37163078082540424
        ],
        "type": "scatter",
        "hoverinfo": "text"
    }
]
, {
    "showlegend": false,
    "xaxis": {
        "showticklabels": true,
        "gridwidth": 0.5,
        "tickvals": [
            -1.5,
            -1.0,
            -0.5,
            0.0,
            0.5,
            1.0,
            1.5
        ],
        "visible": true,
        "ticks": "inside",
        "range": [
            -1.7960369414451969,
            1.7568323375673687
        ],
        "domain": [
            0.06856347817633907,
            0.9931649168853893
        ],
        "tickmode": "array",
        "linecolor": "rgba(0, 0, 0, 1.000)",
        "showgrid": true,
        "title": "",
        "mirror": false,
        "tickangle": 0,
        "showline": true,
        "gridcolor": "rgba(0, 0, 0, 0.100)",
        "titlefont": {
            "color": "rgba(0, 0, 0, 1.000)",
            "family": "sans-serif",
            "size": 15
        },
        "tickcolor": "rgb(0, 0, 0)",
        "ticktext": [
            "-1.5",
            "-1.0",
            "-0.5",
            "0.0",
            "0.5",
            "1.0",
            "1.5"
        ],
        "zeroline": false,
        "type": "-",
        "tickfont": {
            "color": "rgba(0, 0, 0, 1.000)",
            "family": "sans-serif",
            "size": 11
        },
        "zerolinecolor": "rgba(0, 0, 0, 1.000)",
        "anchor": "y1"
    },
    "paper_bgcolor": "rgba(255, 255, 255, 1.000)",
    "annotations": [],
    "height": 384,
    "margin": {
        "l": 0,
        "b": 20,
        "r": 0,
        "t": 20
    },
    "plot_bgcolor": "rgba(255, 255, 255, 1.000)",
    "yaxis": {
        "showticklabels": true,
        "gridwidth": 0.5,
        "tickvals": [
            -0.30000000000000004,
            0.0,
            0.30000000000000004,
            0.6000000000000001,
            0.9000000000000001
        ],
        "visible": true,
        "ticks": "inside",
        "range": [
            -0.48045305221940904,
            1.0431199918122158
        ],
        "domain": [
            0.0391878098571012,
            0.989747375328084
        ],
        "tickmode": "array",
        "linecolor": "rgba(0, 0, 0, 1.000)",
        "showgrid": true,
        "title": "",
        "mirror": false,
        "tickangle": 0,
        "showline": true,
        "gridcolor": "rgba(0, 0, 0, 0.100)",
        "titlefont": {
            "color": "rgba(0, 0, 0, 1.000)",
            "family": "sans-serif",
            "size": 15
        },
        "tickcolor": "rgb(0, 0, 0)",
        "ticktext": [
            "-0.3",
            "0.0",
            "0.3",
            "0.6",
            "0.9"
        ],
        "zeroline": false,
        "type": "-",
        "tickfont": {
            "color": "rgba(0, 0, 0, 1.000)",
            "family": "sans-serif",
            "size": 11
        },
        "zerolinecolor": "rgba(0, 0, 0, 1.000)",
        "anchor": "x1"
    },
    "width": 576
}
);
    </script>


<p>This graph illustrates that the extra quadratic term can track the curvature of the function, whereas the tangent line itself can&#39;t. So, we have a polynomial which is a &quot;better&quot; approximation, is it the best approximation?</p>
<p>The mean value theorem, as in the case of the tangent line, will guarantee the existence of <span class="math">$\xi$</span> between <span class="math">$c$</span> and <span class="math">$x$</span>, for which</p>
<p class="math">\[
~
f(x) - \left(f(c) + f'(c) \cdot(x-c) + (1/2)\cdot f''(c) \cdot (x-c)^2 \right) =
\frac{1}{3!}f'''(\xi) \cdot (x-c)^3.
~
\]</p>
<p>In this sense, the above quadratic polynomial, called the Taylor Polynomial of degree 2, is the best <em>quadratic</em> approximation to <span class="math">$f$</span>, as the difference goes to <span class="math">$0$</span>.</p>
<p>The graphs of the secant line and approximating parabola for <span class="math">$h=1/4$</span> are similar:</p>


<pre class='hljl'>
<span class='hljl-n'>x0</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>x1</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>x2</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-n'>c</span><span class='hljl-oB'>-</span><span class='hljl-n'>h</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>c</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>c</span><span class='hljl-oB'>+</span><span class='hljl-n'>h</span><span class='hljl-t'>
</span><span class='hljl-n'>f0</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-nf'>divided_differences</span><span class='hljl-p'>(</span><span class='hljl-n'>f</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>x0</span><span class='hljl-p'>)</span><span class='hljl-t'>
</span><span class='hljl-n'>fd</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-nf'>divided_differences</span><span class='hljl-p'>(</span><span class='hljl-n'>f</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>x0</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>x1</span><span class='hljl-p'>)</span><span class='hljl-t'>
</span><span class='hljl-n'>fdd</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-nf'>divided_differences</span><span class='hljl-p'>(</span><span class='hljl-n'>f</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>x0</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>x1</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>x2</span><span class='hljl-p'>)</span><span class='hljl-t'>

</span><span class='hljl-nf'>plot</span><span class='hljl-p'>(</span><span class='hljl-n'>f</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>a</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>b</span><span class='hljl-p'>,</span><span class='hljl-t'>                  </span><span class='hljl-n'>color</span><span class='hljl-oB'>=:</span><span class='hljl-n'>blue</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>linewidth</span><span class='hljl-oB'>=</span><span class='hljl-ni'>5</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>legend</span><span class='hljl-oB'>=</span><span class='hljl-kc'>false</span><span class='hljl-p'>)</span><span class='hljl-t'>
</span><span class='hljl-nf'>plot!</span><span class='hljl-p'>(</span><span class='hljl-n'>x</span><span class='hljl-t'> </span><span class='hljl-oB'>-&gt;</span><span class='hljl-t'> </span><span class='hljl-n'>f0</span><span class='hljl-t'> </span><span class='hljl-oB'>+</span><span class='hljl-t'> </span><span class='hljl-n'>fd</span><span class='hljl-oB'>*</span><span class='hljl-p'>(</span><span class='hljl-n'>x</span><span class='hljl-oB'>-</span><span class='hljl-n'>x0</span><span class='hljl-p'>),</span><span class='hljl-t'>     </span><span class='hljl-n'>color</span><span class='hljl-oB'>=:</span><span class='hljl-n'>green</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>alpha</span><span class='hljl-oB'>=</span><span class='hljl-nfB'>0.25</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>linewidth</span><span class='hljl-oB'>=</span><span class='hljl-ni'>5</span><span class='hljl-p'>);</span><span class='hljl-t'>
</span><span class='hljl-nf'>plot!</span><span class='hljl-p'>(</span><span class='hljl-n'>x</span><span class='hljl-t'> </span><span class='hljl-oB'>-&gt;</span><span class='hljl-t'> </span><span class='hljl-n'>f0</span><span class='hljl-t'> </span><span class='hljl-oB'>+</span><span class='hljl-t'> </span><span class='hljl-n'>fd</span><span class='hljl-oB'>*</span><span class='hljl-p'>(</span><span class='hljl-n'>x</span><span class='hljl-oB'>-</span><span class='hljl-n'>x0</span><span class='hljl-p'>)</span><span class='hljl-t'> </span><span class='hljl-oB'>+</span><span class='hljl-t'> </span><span class='hljl-n'>fdd</span><span class='hljl-t'> </span><span class='hljl-oB'>*</span><span class='hljl-t'> </span><span class='hljl-p'>(</span><span class='hljl-n'>x</span><span class='hljl-oB'>-</span><span class='hljl-n'>x0</span><span class='hljl-p'>)</span><span class='hljl-oB'>*</span><span class='hljl-p'>(</span><span class='hljl-n'>x</span><span class='hljl-oB'>-</span><span class='hljl-n'>x1</span><span class='hljl-p'>),</span><span class='hljl-t'>   </span><span class='hljl-n'>color</span><span class='hljl-oB'>=:</span><span class='hljl-n'>green</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>alpha</span><span class='hljl-oB'>=</span><span class='hljl-nfB'>0.25</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>linewidth</span><span class='hljl-oB'>=</span><span class='hljl-ni'>5</span><span class='hljl-p'>);</span>
</pre>



<p>Though similar, the graphs aren&#39;t identical, as the interpolating polynomials aren&#39;t the best approximations.  For example, in the tangent-line graph the parabola only intersects the cosine graph at <span class="math">$x=0$</span>, whereas for the secant-line graph–-by definition–-the parabola intersects the graph at least <span class="math">$2$</span> times and the interpolating polynomial <span class="math">$3$</span> times &#40;at <span class="math">$x_0$</span>, <span class="math">$x_1$</span>, and <span class="math">$x_2$</span>&#41;.</p>
<h5>Example</h5>
<p>Consider the function <span class="math">$f(t) = \log(1 + t)$</span>. We have mentioned that for <span class="math">$t$</span> small, the value <span class="math">$t$</span> is a good approximation. A better one becomes:</p>
<p class="math">\[
~
f(0) + f'(0) \cdot t + \frac{1}{2} \cdot f''(0) \cdot t^2 = 0 + 1t - \frac{t^2}{2}
~
\]</p>
<p>A graph shows the difference:</p>


<pre class='hljl'>
<span class='hljl-nf'>f</span><span class='hljl-p'>(</span><span class='hljl-n'>t</span><span class='hljl-p'>)</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-nf'>log</span><span class='hljl-p'>(</span><span class='hljl-ni'>1</span><span class='hljl-t'> </span><span class='hljl-oB'>+</span><span class='hljl-t'> </span><span class='hljl-n'>t</span><span class='hljl-p'>)</span><span class='hljl-t'>
</span><span class='hljl-n'>a</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>b</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-oB'>-</span><span class='hljl-ni'>1</span><span class='hljl-oB'>/</span><span class='hljl-ni'>2</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-ni'>1</span><span class='hljl-t'>
</span><span class='hljl-nf'>plot</span><span class='hljl-p'>(</span><span class='hljl-n'>f</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>a</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>b</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>legend</span><span class='hljl-oB'>=</span><span class='hljl-kc'>false</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>linewidth</span><span class='hljl-oB'>=</span><span class='hljl-ni'>5</span><span class='hljl-p'>)</span><span class='hljl-t'>
</span><span class='hljl-nf'>plot!</span><span class='hljl-p'>(</span><span class='hljl-n'>t</span><span class='hljl-t'> </span><span class='hljl-oB'>-&gt;</span><span class='hljl-t'> </span><span class='hljl-n'>t</span><span class='hljl-p'>)</span><span class='hljl-t'>
</span><span class='hljl-nf'>plot!</span><span class='hljl-p'>(</span><span class='hljl-n'>t</span><span class='hljl-t'> </span><span class='hljl-oB'>-&gt;</span><span class='hljl-t'> </span><span class='hljl-n'>t</span><span class='hljl-t'> </span><span class='hljl-oB'>-</span><span class='hljl-t'> </span><span class='hljl-n'>t</span><span class='hljl-oB'>^</span><span class='hljl-ni'>2</span><span class='hljl-oB'>/</span><span class='hljl-ni'>2</span><span class='hljl-p'>)</span>
</pre>



    <div id="542aec0a-501c-47e3-ab52-6606baf283c6" style="width:576px;height:384px;"></div>
    <script>
    PLOT = document.getElementById('542aec0a-501c-47e3-ab52-6606baf283c6');
    Plotly.plot(PLOT, [
    {
        "xaxis": "x1",
        "colorbar": {
            "title": ""
        },
        "yaxis": "y1",
        "text": [
            null,
            null,
            null,
            null,
            null,
            null,
            null,
            null,
            null,
            null,
            null,
            null,
            null,
            null,
            null,
            null,
            null,
            null,
            null
        ],
        "x": [
            -0.4853512714703178,
            -0.34990262424744073,
            -0.2685036330415642,
            -0.19968182192635142,
            -0.12492204495042285,
            -0.05600014319805776,
            0.017891419609734772,
            0.10350204150779843,
            0.17958265916653215,
            0.24629850481033003,
            0.3190366849829792,
            0.3922071681292182,
            0.47310649393660636,
            0.5500801611172652,
            0.6301149152670258,
            0.6974871305002677,
            0.7797409689795461,
            0.8570620031930627,
            0.9809362960240898
        ],
        "showlegend": true,
        "mode": "lines",
        "name": "y1",
        "zmin": -0.1,
        "legendgroup": "y1",
        "zmax": 0.1,
        "line": {
            "color": "rgba(0, 154, 250, 1.000)",
            "shape": "linear",
            "dash": "solid",
            "width": 5
        },
        "y": [
            -0.664270691566041,
            -0.43063311846258834,
            -0.312663025098289,
            -0.2227459077928144,
            -0.13344230510770222,
            -0.0576292645295057,
            0.01773325193845244,
            0.098488796742665,
            0.16516069724609037,
            0.2201779621466181,
            0.2769016860724286,
            0.33089037851752356,
            0.38737343217647374,
            0.4383066464437336,
            0.4886505124974707,
            0.5291489989788336,
            0.5764678306692893,
            0.6189956707162749,
            0.6835696097152973
        ],
        "type": "scatter",
        "hoverinfo": "text"
    },
    {
        "xaxis": "x1",
        "colorbar": {
            "title": ""
        },
        "yaxis": "y1",
        "text": [
            null,
            null,
            null,
            null,
            null,
            null,
            null,
            null,
            null,
            null,
            null,
            null,
            null,
            null,
            null,
            null,
            null,
            null,
            null
        ],
        "x": [
            -0.5141612295391274,
            -0.37381251786962666,
            -0.28946879217598054,
            -0.21815724552842986,
            -0.1406929179149857,
            -0.06927765969657382,
            0.007287044757470353,
            0.09599476340191766,
            0.17482771515412737,
            0.24395710976994026,
            0.31932670618692904,
            0.3951442448066508,
            0.47897022893268815,
            0.5587285376554478,
            0.6416586729060487,
            0.7114681822970643,
            0.7966976806872715,
            0.8768159229829211,
            1.0051715600768643
        ],
        "showlegend": true,
        "mode": "lines",
        "name": "y2",
        "zmin": -0.1,
        "legendgroup": "y2",
        "zmax": 0.1,
        "line": {
            "color": "rgba(227, 111, 71, 1.000)",
            "shape": "linear",
            "dash": "solid",
            "width": 1
        },
        "y": [
            -0.5141612295391274,
            -0.37381251786962666,
            -0.28946879217598054,
            -0.21815724552842986,
            -0.1406929179149857,
            -0.06927765969657382,
            0.007287044757470353,
            0.09599476340191766,
            0.17482771515412737,
            0.24395710976994026,
            0.31932670618692904,
            0.3951442448066508,
            0.47897022893268815,
            0.5587285376554478,
            0.6416586729060487,
            0.7114681822970643,
            0.7966976806872715,
            0.8768159229829211,
            1.0051715600768643
        ],
        "type": "scatter",
        "hoverinfo": "text"
    },
    {
        "xaxis": "x1",
        "colorbar": {
            "title": ""
        },
        "yaxis": "y1",
        "text": [
            null,
            null,
            null,
            null,
            null,
            null,
            null,
            null,
            null,
            null,
            null,
            null,
            null,
            null,
            null,
            null,
            null,
            null,
            null
        ],
        "x": [
            -0.5440134324301342,
            -0.39858738889884304,
            -0.3111923983897783,
            -0.23730104617365347,
            -0.15703432661755926,
            -0.08303551090398341,
            -0.0037009597674236804,
            0.0882158978915721,
            0.1699007536828659,
            0.24153101114019668,
            0.3196272193567965,
            0.3981875747785916,
            0.48504609361753276,
            0.5676897825999575,
            0.6536200438438914,
            0.7259550202810289,
            0.8142678276848597,
            0.8972844713942413,
            1.03028357231557
        ],
        "showlegend": true,
        "mode": "lines",
        "name": "y3",
        "zmin": -0.1,
        "legendgroup": "y3",
        "zmax": 0.1,
        "line": {
            "color": "rgba(62, 164, 78, 1.000)",
            "shape": "linear",
            "dash": "solid",
            "width": 1
        },
        "y": [
            -0.6919887397623423,
            -0.47802334219344184,
            -0.35961275279756955,
            -0.2654569394312087,
            -0.1693642164856744,
            -0.08648295893952618,
            -0.003707808319023725,
            0.08432487557116396,
            0.15546762063186295,
            0.21236239646899377,
            0.26854643967991765,
            0.3189109024245634,
            0.36741123715071855,
            0.406553937965764,
            0.44001046298664614,
            0.46244967454541436,
            0.4827517800835495,
            0.4947247600916198,
            0.4995414526239038
        ],
        "type": "scatter",
        "hoverinfo": "text"
    }
]
, {
    "showlegend": false,
    "xaxis": {
        "showticklabels": true,
        "gridwidth": 0.5,
        "tickvals": [
            -0.30000000000000004,
            0.0,
            0.30000000000000004,
            0.6000000000000001,
            0.9000000000000001
        ],
        "visible": true,
        "ticks": "inside",
        "range": [
            -0.5912423425725053,
            1.0775124824579412
        ],
        "domain": [
            0.06856347817633907,
            0.9931649168853893
        ],
        "tickmode": "array",
        "linecolor": "rgba(0, 0, 0, 1.000)",
        "showgrid": true,
        "title": "",
        "mirror": false,
        "tickangle": 0,
        "showline": true,
        "gridcolor": "rgba(0, 0, 0, 0.100)",
        "titlefont": {
            "color": "rgba(0, 0, 0, 1.000)",
            "family": "sans-serif",
            "size": 15
        },
        "tickcolor": "rgb(0, 0, 0)",
        "ticktext": [
            "-0.3",
            "0.0",
            "0.3",
            "0.6",
            "0.9"
        ],
        "zeroline": false,
        "type": "-",
        "tickfont": {
            "color": "rgba(0, 0, 0, 1.000)",
            "family": "sans-serif",
            "size": 11
        },
        "zerolinecolor": "rgba(0, 0, 0, 1.000)",
        "anchor": "y1"
    },
    "paper_bgcolor": "rgba(255, 255, 255, 1.000)",
    "annotations": [],
    "height": 384,
    "margin": {
        "l": 0,
        "b": 20,
        "r": 0,
        "t": 20
    },
    "plot_bgcolor": "rgba(255, 255, 255, 1.000)",
    "yaxis": {
        "showticklabels": true,
        "gridwidth": 0.5,
        "tickvals": [
            -0.5,
            0.0,
            0.5,
            1.0
        ],
        "visible": true,
        "ticks": "inside",
        "range": [
            -0.7429035487575185,
            1.0560863690720406
        ],
        "domain": [
            0.0391878098571012,
            0.989747375328084
        ],
        "tickmode": "array",
        "linecolor": "rgba(0, 0, 0, 1.000)",
        "showgrid": true,
        "title": "",
        "mirror": false,
        "tickangle": 0,
        "showline": true,
        "gridcolor": "rgba(0, 0, 0, 0.100)",
        "titlefont": {
            "color": "rgba(0, 0, 0, 1.000)",
            "family": "sans-serif",
            "size": 15
        },
        "tickcolor": "rgb(0, 0, 0)",
        "ticktext": [
            "-0.5",
            "0.0",
            "0.5",
            "1.0"
        ],
        "zeroline": false,
        "type": "-",
        "tickfont": {
            "color": "rgba(0, 0, 0, 1.000)",
            "family": "sans-serif",
            "size": 11
        },
        "zerolinecolor": "rgba(0, 0, 0, 1.000)",
        "anchor": "x1"
    },
    "width": 576
}
);
    </script>


<p>Though we can see that the tangent line is a good approximation, the quadratic polynomial tracks the logarithm better farther from <span class="math">$c=0$</span>.</p>
<h5>Example</h5>
<p>A wire is bent in the form of a half circle with radius <span class="math">$R$</span> centered at <span class="math">$(0,R)$</span>, so the bottom of the wire is at the origin. A bead is released on the wire at angle <span class="math">$\theta$</span>. As time evolves, the bead will slide back and forth. How? &#40;Ignoring friction.&#41;</p>
<p>Let <span class="math">$U$</span> be the potential energy, <span class="math">$U=mgh = mgR \cdot (1 - \cos(\theta))$</span>. The velocity of the object will depend on <span class="math">$\theta$</span> – it will be <span class="math">$0$</span> at the high point, and largest in magnitude at the bottom – and is given by <span class="math">$v(\theta) = R \cdot d\theta/ dt$</span>. &#40;The bead moves along the wire so its distance traveled is <span class="math">$R\cdot \Delta \theta$</span>, this, then, is just the time derivative of distance.&#41;</p>
<p>By ignoring friction, the total energy is conserved giving:</p>
<p class="math">\[
~
K = \frac{1}{2}m v^2 + mgR \cdot (1 - \cos(\theta) =
\frac{1}{2} m R^2 (\frac{d\theta}{dt})^2 +  mgR \cdot (1 - \cos(\theta)).
~
\]</p>
<p>The value of <span class="math">$1-\cos(\theta)$</span> inhibits further work which would be possible were there an easier formula there. In fact, we could try the excellent approximation <span class="math">$1 - \theta^2/2$</span> from the quadratic approximation. Then we have:</p>
<p class="math">\[
~
K \approx \frac{1}{2} m R^2 (\frac{d\theta}{dt})^2 +  mgR \cdot (1 - \theta^2/2).
~
\]</p>
<p>Assuming equality and differentiating in <span class="math">$t$</span> gives by the chain rule:</p>
<p class="math">\[
~
0 = \frac{1}{2} m R^2 2\frac{d\theta}{dt} \cdot \frac{d^2\theta}{dt^2} - mgR \theta\cdot \frac{d\theta}{dt}.
~
\]</p>
<p>This can be solved to give this relationship:</p>
<p class="math">\[
~
\frac{d^2\theta}{dt^2} = - \frac{g}{R}\theta.
~
\]</p>
<p>The solution to this &quot;equation&quot; can be written &#40;in some parameterization&#41; as <span class="math">$\theta(t)=A\cos \left(\omega t+\phi \right)$</span>. This motion is the well-studied simple <a href="https://en.wikipedia.org/wiki/Harmonic_oscillator">harmonic oscillator</a>, a model for a simple pendulum.</p>
<h2>The Taylor polynomial of degree <span class="math">$n$</span></h2>
<p>Starting with the Newton form of the interpolating polynomial of smallest degree:</p>
<p class="math">\[
~
f[x_0] + f[x_0,x_1] \cdot (x - x_0) + f[x_0, x_1, x_2] \cdot (x - x_0)\cdot(x-x_1) +
\cdots + f[x_0, x_1, \dots, x_n] \cdot (x-x_0) \cdot \cdots \cdot (x-x_{n-1}).
~
\]</p>
<p>and taking <span class="math">$x_i = c + i\cdot h$</span>, for a given <span class="math">$n$</span>, we have in the limit as <span class="math">$h > 0$</span> goes to zero that coefficients of this polynomial converge to the coefficients of the <em>Taylor Polynomial of degree n</em>:</p>
<p class="math">\[
~
f(c) + f'(c)\cdot(x-c) + \frac{f''(c)}{2!}(x-c)^2 + \cdots + \frac{f^{(n)}(c)}{n!} (x-c)^n
~
\]</p>
<p>This polynomial will be a good approximation to the function <span class="math">$f$</span>, near <span class="math">$c$</span>. The error will be given–-again by an application of the Mean Value Theorem–-by <span class="math">$(1/(n+1)!) \cdot f^{(n+1)}(\xi) \cdot (x-c)^n$</span> for some <span class="math">$\xi$</span> between <span class="math">$c$</span> and <span class="math">$x$</span>.</p>
<p>The Taylor polynomial for <span class="math">$f$</span> about <span class="math">$c$</span> of degree <span class="math">$n$</span> can be computed by taking <span class="math">$n$</span> derivatives. For such a task, the computer is very helpful. In <code>SymPy</code> the <code>series</code> function will compute the Taylor polynomial for a given <span class="math">$n$</span>. For example, here is the series expansion to 10 terms of the function <span class="math">$\log(1+x)$</span> about <span class="math">$c=0$</span>:</p>


<pre class='hljl'>
<span class='hljl-nd'>@vars</span><span class='hljl-t'> </span><span class='hljl-n'>x</span><span class='hljl-t'>
</span><span class='hljl-n'>c</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>n</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-ni'>0</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-ni'>10</span><span class='hljl-t'>
</span><span class='hljl-n'>l</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-nf'>series</span><span class='hljl-p'>(</span><span class='hljl-nf'>log</span><span class='hljl-p'>(</span><span class='hljl-ni'>1</span><span class='hljl-t'> </span><span class='hljl-oB'>+</span><span class='hljl-t'> </span><span class='hljl-n'>x</span><span class='hljl-p'>),</span><span class='hljl-t'> </span><span class='hljl-n'>x</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>c</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>n</span><span class='hljl-oB'>+</span><span class='hljl-ni'>1</span><span class='hljl-p'>)</span>
</pre>



<div class="well well-sm">\begin{equation*}x - \frac{x^{2}}{2} + \frac{x^{3}}{3} - \frac{x^{4}}{4} + \frac{x^{5}}{5} - \frac{x^{6}}{6} + \frac{x^{7}}{7} - \frac{x^{8}}{8} + \frac{x^{9}}{9} - \frac{x^{10}}{10} + O\left(x^{11}\right)\end{equation*}</div>

<p>A pattern can be observed.</p>
<p>Using <code>series</code>, we can see Taylor polynomials for several familiar functions:</p>


<pre class='hljl'>
<span class='hljl-nf'>series</span><span class='hljl-p'>(</span><span class='hljl-ni'>1</span><span class='hljl-oB'>/</span><span class='hljl-p'>(</span><span class='hljl-ni'>1</span><span class='hljl-oB'>-</span><span class='hljl-n'>x</span><span class='hljl-p'>),</span><span class='hljl-t'> </span><span class='hljl-n'>x</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-ni'>0</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-ni'>10</span><span class='hljl-p'>)</span><span class='hljl-t'>   </span><span class='hljl-cs'># sum x^i for i in 0:n</span>
</pre>



<div class="well well-sm">\begin{equation*}1 + x + x^{2} + x^{3} + x^{4} + x^{5} + x^{6} + x^{7} + x^{8} + x^{9} + O\left(x^{10}\right)\end{equation*}</div>


<pre class='hljl'>
<span class='hljl-nf'>series</span><span class='hljl-p'>(</span><span class='hljl-nf'>exp</span><span class='hljl-p'>(</span><span class='hljl-n'>x</span><span class='hljl-p'>),</span><span class='hljl-t'> </span><span class='hljl-n'>x</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-ni'>0</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-ni'>10</span><span class='hljl-p'>)</span><span class='hljl-t'>    </span><span class='hljl-cs'># sum x^i/i! for i in 0:n</span>
</pre>



<div class="well well-sm">\begin{equation*}1 + x + \frac{x^{2}}{2} + \frac{x^{3}}{6} + \frac{x^{4}}{24} + \frac{x^{5}}{120} + \frac{x^{6}}{720} + \frac{x^{7}}{5040} + \frac{x^{8}}{40320} + \frac{x^{9}}{362880} + O\left(x^{10}\right)\end{equation*}</div>


<pre class='hljl'>
<span class='hljl-nf'>series</span><span class='hljl-p'>(</span><span class='hljl-nf'>sin</span><span class='hljl-p'>(</span><span class='hljl-n'>x</span><span class='hljl-p'>),</span><span class='hljl-t'> </span><span class='hljl-n'>x</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-ni'>0</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-ni'>10</span><span class='hljl-p'>)</span><span class='hljl-t'>    </span><span class='hljl-cs'># sum (-1)^i * x^(2i+1) / (2i+1)! for i in 0:n</span>
</pre>



<div class="well well-sm">\begin{equation*}x - \frac{x^{3}}{6} + \frac{x^{5}}{120} - \frac{x^{7}}{5040} + \frac{x^{9}}{362880} + O\left(x^{10}\right)\end{equation*}</div>


<pre class='hljl'>
<span class='hljl-nf'>series</span><span class='hljl-p'>(</span><span class='hljl-nf'>cos</span><span class='hljl-p'>(</span><span class='hljl-n'>x</span><span class='hljl-p'>),</span><span class='hljl-t'> </span><span class='hljl-n'>x</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-ni'>0</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-ni'>10</span><span class='hljl-p'>)</span><span class='hljl-t'>    </span><span class='hljl-cs'># sum (-1)^i * x^(2i) / (2i)! for i in 0:n</span>
</pre>



<div class="well well-sm">\begin{equation*}1 - \frac{x^{2}}{2} + \frac{x^{4}}{24} - \frac{x^{6}}{720} + \frac{x^{8}}{40320} + O\left(x^{10}\right)\end{equation*}</div>

<p>Each of these last three have a pattern that can be expressed quite succinctly if the denominator is recognized as <span class="math">$n!$</span>.</p>
<p>The output of <code>series</code> includes a big &quot;Oh&quot; term, which identifies the scale of the error, but also gets in the way of using the output. <code>SymPy</code> provides the <code>removeO</code> method to strip this. &#40;It is called as <code>object.removeO&#40;&#41;</code>, as it is a method of an object in SymPy.&#41;</p>
<p>However, we will define our own function to compute Taylor polynomials from a function. The following returns a function, not a symbolic object, using <code>D</code>, from <code>CalculusWithJulia</code>, which is based on <code>ForwardDiff.derivative</code>, to find higher-order derivatives:</p>


<pre class='hljl'>
<span class='hljl-k'>function</span><span class='hljl-t'> </span><span class='hljl-nf'>taylor_poly</span><span class='hljl-p'>(</span><span class='hljl-n'>f</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>c</span><span class='hljl-oB'>=</span><span class='hljl-ni'>0</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>n</span><span class='hljl-oB'>=</span><span class='hljl-ni'>2</span><span class='hljl-p'>)</span><span class='hljl-t'>
     </span><span class='hljl-n'>x</span><span class='hljl-t'> </span><span class='hljl-oB'>-&gt;</span><span class='hljl-t'> </span><span class='hljl-nf'>f</span><span class='hljl-p'>(</span><span class='hljl-n'>c</span><span class='hljl-p'>)</span><span class='hljl-t'> </span><span class='hljl-oB'>+</span><span class='hljl-t'> </span><span class='hljl-nf'>sum</span><span class='hljl-p'>(</span><span class='hljl-nf'>D</span><span class='hljl-p'>(</span><span class='hljl-n'>f</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>i</span><span class='hljl-p'>)(</span><span class='hljl-n'>c</span><span class='hljl-p'>)</span><span class='hljl-t'> </span><span class='hljl-oB'>*</span><span class='hljl-t'> </span><span class='hljl-p'>(</span><span class='hljl-n'>x</span><span class='hljl-oB'>-</span><span class='hljl-n'>c</span><span class='hljl-p'>)</span><span class='hljl-oB'>^</span><span class='hljl-n'>i</span><span class='hljl-t'> </span><span class='hljl-oB'>/</span><span class='hljl-t'> </span><span class='hljl-nf'>factorial</span><span class='hljl-p'>(</span><span class='hljl-n'>i</span><span class='hljl-p'>)</span><span class='hljl-t'> </span><span class='hljl-k'>for</span><span class='hljl-t'> </span><span class='hljl-n'>i</span><span class='hljl-t'> </span><span class='hljl-kp'>in</span><span class='hljl-t'> </span><span class='hljl-ni'>1</span><span class='hljl-oB'>:</span><span class='hljl-n'>n</span><span class='hljl-p'>)</span><span class='hljl-t'>
</span><span class='hljl-k'>end</span>
</pre>


<pre class="output">
taylor_poly &#40;generic function with 3 methods&#41;
</pre>


<p>With a function, we can compare values. For example, here we see the difference between the Taylor polynomial and the answer for a small value of <span class="math">$x$</span>:</p>


<pre class='hljl'>
<span class='hljl-n'>a</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-nfB'>.1</span><span class='hljl-t'>
</span><span class='hljl-nf'>f</span><span class='hljl-p'>(</span><span class='hljl-n'>x</span><span class='hljl-p'>)</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-nf'>log</span><span class='hljl-p'>(</span><span class='hljl-ni'>1</span><span class='hljl-oB'>+</span><span class='hljl-n'>x</span><span class='hljl-p'>)</span><span class='hljl-t'>
</span><span class='hljl-n'>Tn</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-nf'>taylor_poly</span><span class='hljl-p'>(</span><span class='hljl-n'>f</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-ni'>0</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-ni'>5</span><span class='hljl-p'>)</span><span class='hljl-t'>
</span><span class='hljl-nf'>Tn</span><span class='hljl-p'>(</span><span class='hljl-n'>a</span><span class='hljl-p'>)</span><span class='hljl-t'> </span><span class='hljl-oB'>-</span><span class='hljl-t'> </span><span class='hljl-nf'>f</span><span class='hljl-p'>(</span><span class='hljl-n'>a</span><span class='hljl-p'>)</span>
</pre>


<pre class="output">
1.5352900840925887e-7
</pre>


<h3>Plotting</h3>
<p>Let&#39;s now visualize a function and the two approximations–-the Taylor polynomial and the interpolating polynomial. We use this function to generate the interpolating polynomial as a function:</p>


<pre class='hljl'>
<span class='hljl-k'>function</span><span class='hljl-t'> </span><span class='hljl-nf'>newton_form</span><span class='hljl-p'>(</span><span class='hljl-n'>f</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>xs</span><span class='hljl-p'>)</span><span class='hljl-t'>
  </span><span class='hljl-n'>x</span><span class='hljl-t'> </span><span class='hljl-oB'>-&gt;</span><span class='hljl-t'> </span><span class='hljl-k'>begin</span><span class='hljl-t'>
     </span><span class='hljl-n'>tot</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-nf'>divided_differences</span><span class='hljl-p'>(</span><span class='hljl-n'>f</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>xs</span><span class='hljl-p'>[</span><span class='hljl-ni'>1</span><span class='hljl-p'>])</span><span class='hljl-t'>
     </span><span class='hljl-k'>for</span><span class='hljl-t'> </span><span class='hljl-n'>i</span><span class='hljl-t'> </span><span class='hljl-kp'>in</span><span class='hljl-t'> </span><span class='hljl-ni'>2</span><span class='hljl-oB'>:</span><span class='hljl-nf'>length</span><span class='hljl-p'>(</span><span class='hljl-n'>xs</span><span class='hljl-p'>)</span><span class='hljl-t'>
        </span><span class='hljl-n'>tot</span><span class='hljl-t'> </span><span class='hljl-oB'>+=</span><span class='hljl-t'> </span><span class='hljl-nf'>divided_differences</span><span class='hljl-p'>(</span><span class='hljl-n'>f</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>xs</span><span class='hljl-p'>[</span><span class='hljl-ni'>1</span><span class='hljl-oB'>:</span><span class='hljl-n'>i</span><span class='hljl-p'>]</span><span class='hljl-oB'>...</span><span class='hljl-p'>)</span><span class='hljl-t'> </span><span class='hljl-oB'>*</span><span class='hljl-t'> </span><span class='hljl-nf'>prod</span><span class='hljl-p'>([</span><span class='hljl-n'>x</span><span class='hljl-oB'>-</span><span class='hljl-n'>xs</span><span class='hljl-p'>[</span><span class='hljl-n'>j</span><span class='hljl-p'>]</span><span class='hljl-t'> </span><span class='hljl-k'>for</span><span class='hljl-t'> </span><span class='hljl-n'>j</span><span class='hljl-t'> </span><span class='hljl-kp'>in</span><span class='hljl-t'> </span><span class='hljl-ni'>1</span><span class='hljl-oB'>:</span><span class='hljl-p'>(</span><span class='hljl-n'>i</span><span class='hljl-oB'>-</span><span class='hljl-ni'>1</span><span class='hljl-p'>)])</span><span class='hljl-t'>
     </span><span class='hljl-k'>end</span><span class='hljl-t'>
     </span><span class='hljl-n'>tot</span><span class='hljl-t'>
  </span><span class='hljl-k'>end</span><span class='hljl-t'>
</span><span class='hljl-k'>end</span>
</pre>


<pre class="output">
newton_form &#40;generic function with 1 method&#41;
</pre>


<p>To see a plot, we have</p>


<pre class='hljl'>
<span class='hljl-nf'>f</span><span class='hljl-p'>(</span><span class='hljl-n'>x</span><span class='hljl-p'>)</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-nf'>sin</span><span class='hljl-p'>(</span><span class='hljl-n'>x</span><span class='hljl-p'>)</span><span class='hljl-t'>
</span><span class='hljl-n'>c</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>h</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>n</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-ni'>0</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-ni'>1</span><span class='hljl-oB'>/</span><span class='hljl-ni'>4</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-ni'>4</span><span class='hljl-t'>
</span><span class='hljl-n'>int_poly</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-nf'>newton_form</span><span class='hljl-p'>(</span><span class='hljl-n'>f</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-p'>[</span><span class='hljl-n'>c</span><span class='hljl-t'> </span><span class='hljl-oB'>+</span><span class='hljl-t'> </span><span class='hljl-n'>i</span><span class='hljl-oB'>*</span><span class='hljl-n'>h</span><span class='hljl-t'> </span><span class='hljl-k'>for</span><span class='hljl-t'> </span><span class='hljl-n'>i</span><span class='hljl-t'> </span><span class='hljl-kp'>in</span><span class='hljl-t'> </span><span class='hljl-ni'>0</span><span class='hljl-oB'>:</span><span class='hljl-n'>n</span><span class='hljl-p'>])</span><span class='hljl-t'>
</span><span class='hljl-n'>tp</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-nf'>taylor_poly</span><span class='hljl-p'>(</span><span class='hljl-n'>f</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>c</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>n</span><span class='hljl-p'>)</span><span class='hljl-t'>

</span><span class='hljl-nf'>plot</span><span class='hljl-p'>(</span><span class='hljl-n'>sin</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-oB'>-</span><span class='hljl-n'>pi</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>pi</span><span class='hljl-p'>;</span><span class='hljl-t'> </span><span class='hljl-n'>linewidth</span><span class='hljl-oB'>=</span><span class='hljl-ni'>5</span><span class='hljl-p'>)</span><span class='hljl-t'>
</span><span class='hljl-nf'>plot!</span><span class='hljl-p'>(</span><span class='hljl-n'>int_poly</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>color</span><span class='hljl-oB'>=:</span><span class='hljl-n'>green</span><span class='hljl-p'>)</span><span class='hljl-t'>
</span><span class='hljl-nf'>plot!</span><span class='hljl-p'>(</span><span class='hljl-n'>tp</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>color</span><span class='hljl-oB'>=:</span><span class='hljl-n'>red</span><span class='hljl-p'>)</span>
</pre>



    <div id="08ea124d-f353-4a54-8059-33c162c5baee" style="width:576px;height:384px;"></div>
    <script>
    PLOT = document.getElementById('08ea124d-f353-4a54-8059-33c162c5baee');
    Plotly.plot(PLOT, [
    {
        "xaxis": "x1",
        "colorbar": {
            "title": ""
        },
        "yaxis": "y1",
        "text": [
            null,
            null,
            null,
            null,
            null,
            null,
            null,
            null,
            null,
            null,
            null,
            null,
            null,
            null,
            null,
            null,
            null,
            null,
            null,
            null,
            null,
            null,
            null,
            null,
            null,
            null,
            null,
            null,
            null,
            null,
            null,
            null,
            null,
            null,
            null,
            null,
            null,
            null,
            null,
            null,
            null,
            null,
            null
        ],
        "x": [
            -3.1109124283009395,
            -3.0802322030120854,
            -2.796549219642708,
            -2.5128662362733305,
            -2.342384587751996,
            -2.1719029392306615,
            -2.099832907161896,
            -2.02776287509313,
            -1.9556928430243645,
            -1.8836228109555988,
            -1.7270463002012066,
            -1.5704697894468143,
            -1.4261200959690359,
            -1.2817704024912573,
            -1.1270122752384375,
            -0.9722541479856175,
            -0.7929516807694774,
            -0.6136492135533372,
            -0.45430634054183605,
            -0.2949634675303348,
            -0.15523412716194418,
            -0.015504786793553571,
            0.1368377015170367,
            0.28918018982762694,
            0.44242809136885364,
            0.5956759929100803,
            0.7651111446679857,
            0.9345462964258912,
            1.095759567982307,
            1.2569728395387225,
            1.3407850380949735,
            1.4245972366512245,
            1.5084094352074755,
            1.5922216337637265,
            1.7333256713856087,
            1.8744297090074906,
            2.046701745471532,
            2.218973781935574,
            2.38091457730434,
            2.542855372673106,
            2.8022970848908297,
            3.0617387971085535,
            3.1016657253491733
        ],
        "showlegend": true,
        "mode": "lines",
        "name": "y1",
        "zmin": -0.1,
        "legendgroup": "y1",
        "zmax": 0.1,
        "line": {
            "color": "rgba(0, 154, 250, 1.000)",
            "shape": "linear",
            "dash": "solid",
            "width": 5
        },
        "y": [
            -0.030675412420937152,
            -0.06132195307030757,
            -0.33823755155018465,
            -0.5881151905779409,
            -0.7168041201646171,
            -0.8247102693051216,
            -0.8632937107664947,
            -0.8973950679428847,
            -0.9268372919861522,
            -0.9514675235298343,
            -0.9878177879548484,
            -0.9999999466866806,
            -0.989552636203005,
            -0.9585219599793448,
            -0.9031334125880432,
            -0.8261578853619512,
            -0.712427701638236,
            -0.5758547097527326,
            -0.438839120871129,
            -0.29070489558439677,
            -0.15461141539348508,
            -0.01550416557999605,
            0.13641106359642394,
            0.2851665510234455,
            0.42813502702217887,
            0.5610684489029838,
            0.692617172088342,
            0.8043295777666697,
            0.8892759098040913,
            0.9511602238189568,
            0.9736638213734831,
            0.9893319351014062,
            0.9980545689901091,
            0.999770486890561,
            0.9868211552281166,
            0.9542564477114475,
            0.8888782743946314,
            0.7971854551477641,
            0.6894127808039026,
            0.5635998564911866,
            0.3328229035580866,
            0.07976901700741985,
            0.03991632077017152
        ],
        "type": "scatter",
        "hoverinfo": "text"
    },
    {
        "xaxis": "x1",
        "colorbar": {
            "title": ""
        },
        "yaxis": "y1",
        "text": [
            null,
            null,
            null,
            null,
            null,
            null,
            null,
            null,
            null,
            null,
            null,
            null,
            null,
            null,
            null,
            null,
            null,
            null,
            null,
            null,
            null,
            null,
            null,
            null,
            null,
            null,
            null,
            null,
            null,
            null,
            null,
            null,
            null,
            null,
            null,
            null,
            null,
            null,
            null,
            null,
            null,
            null,
            null,
            null,
            null,
            null,
            null
        ],
        "x": [
            -3.281211980728311,
            -3.2651341885461793,
            -3.2490563963640477,
            -3.232978604181916,
            -3.158647402091999,
            -3.084316200002082,
            -3.0099849979121647,
            -2.9356537958222475,
            -2.8613225937323303,
            -2.786991391642413,
            -2.712660189552496,
            -2.6383289874625793,
            -2.5489890791018337,
            -2.459649170741088,
            -2.3703092623803426,
            -2.280969354019597,
            -2.2054335985124727,
            -2.1298978430053483,
            -2.054362087498224,
            -1.9788263319910997,
            -1.8147203271093821,
            -1.6506143222276644,
            -1.4993231011600483,
            -1.348031880092432,
            -1.1858317016360713,
            -1.0236315231797104,
            -0.8357067098184541,
            -0.6477818964571977,
            -0.3137711030079794,
            -0.02087373670272031,
            0.29846301451159835,
            0.6196976717059508,
            0.797280667441072,
            0.974863663176193,
            1.1438294026831495,
            1.3127951421901058,
            1.488480307214564,
            1.664165472239022,
            1.812054959463127,
            1.959944446687232,
            2.1405007480171134,
            2.3210570493469946,
            2.4907852980306204,
            2.6605135467142462,
            2.9324313630366965,
            3.2043491793591468,
            3.246196124658912
        ],
        "showlegend": true,
        "mode": "lines",
        "name": "y2",
        "zmin": -0.1,
        "legendgroup": "y2",
        "zmax": 0.1,
        "line": {
            "color": "rgba(0, 128, 0, 1.000)",
            "shape": "linear",
            "dash": "solid",
            "width": 1
        },
        "y": [
            5.560090470976219,
            5.436106938428549,
            5.313709664618134,
            5.192887650481568,
            4.654463075924476,
            4.148400159746586,
            3.6736384258362267,
            3.2291318817820613,
            2.8138490188730825,
            2.426772812098612,
            2.0669007201483023,
            1.733244685412141,
            1.3655346414361165,
            1.0326280321018861,
            0.7328923603305806,
            0.46472535478151245,
            0.26145827194453664,
            0.07870044146667199,
            -0.08446597137121015,
            -0.22894335567290047,
            -0.48265108286437264,
            -0.6611539617331987,
            -0.7664325630879462,
            -0.8214217986987906,
            -0.8315097237166449,
            -0.798126760812803,
            -0.7142044908755896,
            -0.5914623400369777,
            -0.307103198072363,
            -0.02085470997822583,
            0.2940583395897964,
            0.580779322203535,
            0.7154676251703133,
            0.8276384725388989,
            0.909973753913133,
            0.9655815945672633,
            0.9923750369751426,
            0.9852045015411897,
            0.9514198129295011,
            0.8913083496028429,
            0.7812738775889755,
            0.6302605013018665,
            0.450705392165649,
            0.23490935155402837,
            -0.18472487437262353,
            -0.6911923492592131,
            -0.7764258001299391
        ],
        "type": "scatter",
        "hoverinfo": "text"
    },
    {
        "xaxis": "x1",
        "colorbar": {
            "title": ""
        },
        "yaxis": "y1",
        "text": [
            null,
            null,
            null,
            null,
            null,
            null,
            null,
            null,
            null,
            null,
            null,
            null,
            null,
            null,
            null,
            null,
            null,
            null,
            null,
            null,
            null,
            null,
            null,
            null,
            null,
            null,
            null,
            null,
            null,
            null,
            null,
            null,
            null,
            null,
            null,
            null,
            null,
            null,
            null,
            null,
            null,
            null,
            null,
            null,
            null
        ],
        "x": [
            -3.4601416700401675,
            -3.4432491161904073,
            -3.426356562340647,
            -3.4094640084908874,
            -3.253267956222367,
            -3.0970719039538466,
            -2.940875851685326,
            -2.7846797994168053,
            -2.6908124825725324,
            -2.5969451657282594,
            -2.5030778488839864,
            -2.409210532039714,
            -2.2504832885187405,
            -2.091756044997767,
            -1.9193337687841026,
            -1.7469114925704379,
            -1.5879534049219994,
            -1.428995317273561,
            -1.25857544755663,
            -1.088155577839699,
            -0.8907074460657853,
            -0.6932593142918716,
            -0.3423221177648089,
            -0.0345818212915594,
            0.3009377080683542,
            0.6384513221014815,
            0.8250335520665608,
            1.0116157820316403,
            1.189144065831572,
            1.3666723496315039,
            1.5512605740071073,
            1.735848798382711,
            1.8912327651889898,
            2.0466167319952686,
            2.2363229434313303,
            2.426029154867392,
            2.604358588923647,
            2.782688022979902,
            2.9255368141230385,
            3.068385605266175,
            3.2112343964093117,
            3.354083187552448,
            3.3760669826194682,
            3.398050777686488,
            3.4200345727535084
        ],
        "showlegend": true,
        "mode": "lines",
        "name": "y3",
        "zmin": -0.1,
        "legendgroup": "y3",
        "zmax": 0.1,
        "line": {
            "color": "rgba(255, 0, 0, 1.000)",
            "shape": "linear",
            "dash": "solid",
            "width": 1
        },
        "y": [
            3.4443290398752007,
            3.3605907511553683,
            3.277835022410005,
            3.196057033207387,
            2.4853624643094276,
            1.8540385463339328,
            1.2982745319010727,
            0.8142596736310108,
            0.5563128412938085,
            0.32207495463145497,
            0.11071894184681819,
            -0.0785822688572324,
            -0.35082220167309885,
            -0.5663626982242775,
            -0.740913340101059,
            -0.8584032612970629,
            -0.920590574960684,
            -0.942654000250917,
            -0.926308979277708,
            -0.8734112371713711,
            -0.7729322059455158,
            -0.6377282637742748,
            -0.3356363139251818,
            -0.034574928544587984,
            0.2963953791733945,
            0.5950770577984558,
            0.7314361959145348,
            0.8390734999404564,
            0.9088898408798431,
            0.9412287707467792,
            0.9290992443025933,
            0.8641139070604081,
            0.763818048484993,
            0.6178599310130231,
            0.372295474669156,
            0.04624922936683751,
            -0.33973148525847563,
            -0.8085344153892864,
            -1.2476271850162055,
            -1.7464178068608174,
            -2.3078212215186307,
            -2.9347523695851474,
            -3.0372383006705217,
            -3.1413558418687124,
            -3.2471156176674865
        ],
        "type": "scatter",
        "hoverinfo": "text"
    }
]
, {
    "showlegend": true,
    "xaxis": {
        "showticklabels": true,
        "gridwidth": 0.5,
        "tickvals": [
            -3.0,
            -2.0,
            -1.0,
            0.0,
            1.0,
            2.0,
            3.0
        ],
        "visible": true,
        "ticks": "inside",
        "range": [
            -3.6665469573239777,
            3.6264398600373187
        ],
        "domain": [
            0.03769928064547487,
            0.9931649168853894
        ],
        "tickmode": "array",
        "linecolor": "rgba(0, 0, 0, 1.000)",
        "showgrid": true,
        "title": "",
        "mirror": false,
        "tickangle": 0,
        "showline": true,
        "gridcolor": "rgba(0, 0, 0, 0.100)",
        "titlefont": {
            "color": "rgba(0, 0, 0, 1.000)",
            "family": "sans-serif",
            "size": 15
        },
        "tickcolor": "rgb(0, 0, 0)",
        "ticktext": [
            "-3",
            "-2",
            "-1",
            "0",
            "1",
            "2",
            "3"
        ],
        "zeroline": false,
        "type": "-",
        "tickfont": {
            "color": "rgba(0, 0, 0, 1.000)",
            "family": "sans-serif",
            "size": 11
        },
        "zerolinecolor": "rgba(0, 0, 0, 1.000)",
        "anchor": "y1"
    },
    "paper_bgcolor": "rgba(255, 255, 255, 1.000)",
    "annotations": [],
    "height": 384,
    "margin": {
        "l": 0,
        "b": 20,
        "r": 0,
        "t": 20
    },
    "plot_bgcolor": "rgba(255, 255, 255, 1.000)",
    "yaxis": {
        "showticklabels": true,
        "gridwidth": 0.5,
        "tickvals": [
            -2.0,
            0.0,
            2.0,
            4.0
        ],
        "visible": true,
        "ticks": "inside",
        "range": [
            -3.5113318003267975,
            5.82430665363553
        ],
        "domain": [
            0.0391878098571012,
            0.989747375328084
        ],
        "tickmode": "array",
        "linecolor": "rgba(0, 0, 0, 1.000)",
        "showgrid": true,
        "title": "",
        "mirror": false,
        "tickangle": 0,
        "showline": true,
        "gridcolor": "rgba(0, 0, 0, 0.100)",
        "titlefont": {
            "color": "rgba(0, 0, 0, 1.000)",
            "family": "sans-serif",
            "size": 15
        },
        "tickcolor": "rgb(0, 0, 0)",
        "ticktext": [
            "-2",
            "0",
            "2",
            "4"
        ],
        "zeroline": false,
        "type": "-",
        "tickfont": {
            "color": "rgba(0, 0, 0, 1.000)",
            "family": "sans-serif",
            "size": 11
        },
        "zerolinecolor": "rgba(0, 0, 0, 1.000)",
        "anchor": "x1"
    },
    "legend": {
        "tracegroupgap": 0,
        "bordercolor": "rgba(0, 0, 0, 1.000)",
        "bgcolor": "rgba(255, 255, 255, 1.000)",
        "font": {
            "color": "rgba(0, 0, 0, 1.000)",
            "family": "sans-serif",
            "size": 11
        },
        "y": 1.0,
        "x": 1.0
    },
    "width": 576
}
);
    </script>


<p>To get a better sense, we plot the residual differences here:</p>


<pre class='hljl'>
<span class='hljl-nf'>d1</span><span class='hljl-p'>(</span><span class='hljl-n'>x</span><span class='hljl-p'>)</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-nf'>f</span><span class='hljl-p'>(</span><span class='hljl-n'>x</span><span class='hljl-p'>)</span><span class='hljl-t'> </span><span class='hljl-oB'>-</span><span class='hljl-t'> </span><span class='hljl-nf'>int_poly</span><span class='hljl-p'>(</span><span class='hljl-n'>x</span><span class='hljl-p'>)</span><span class='hljl-t'>
</span><span class='hljl-nf'>d2</span><span class='hljl-p'>(</span><span class='hljl-n'>x</span><span class='hljl-p'>)</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-nf'>f</span><span class='hljl-p'>(</span><span class='hljl-n'>x</span><span class='hljl-p'>)</span><span class='hljl-t'> </span><span class='hljl-oB'>-</span><span class='hljl-t'> </span><span class='hljl-nf'>tp</span><span class='hljl-p'>(</span><span class='hljl-n'>x</span><span class='hljl-p'>)</span><span class='hljl-t'>
</span><span class='hljl-nf'>plot</span><span class='hljl-p'>(</span><span class='hljl-n'>d1</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-oB'>-</span><span class='hljl-n'>pi</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>pi</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>color</span><span class='hljl-oB'>=:</span><span class='hljl-n'>blue</span><span class='hljl-p'>)</span><span class='hljl-t'>
</span><span class='hljl-nf'>plot!</span><span class='hljl-p'>(</span><span class='hljl-n'>d2</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>color</span><span class='hljl-oB'>=:</span><span class='hljl-n'>green</span><span class='hljl-p'>)</span>
</pre>



    <div id="ccfebe39-8d0f-4890-ae78-174875a5614e" style="width:576px;height:384px;"></div>
    <script>
    PLOT = document.getElementById('ccfebe39-8d0f-4890-ae78-174875a5614e');
    Plotly.plot(PLOT, [
    {
        "xaxis": "x1",
        "colorbar": {
            "title": ""
        },
        "yaxis": "y1",
        "text": [
            null,
            null,
            null,
            null,
            null,
            null,
            null,
            null,
            null,
            null,
            null,
            null,
            null,
            null,
            null,
            null,
            null,
            null,
            null,
            null,
            null,
            null,
            null,
            null,
            null,
            null,
            null,
            null,
            null,
            null,
            null,
            null,
            null,
            null,
            null,
            null,
            null,
            null,
            null
        ],
        "x": [
            -3.1262525409453663,
            -3.1109124283009395,
            -3.0955723156565123,
            -3.0802322030120854,
            -3.0093114571697415,
            -2.938390711327397,
            -2.8674699654850526,
            -2.796549219642708,
            -2.7256284738003638,
            -2.6547077279580193,
            -2.583786982115675,
            -2.5128662362733305,
            -2.427625412012663,
            -2.342384587751996,
            -2.257143763491329,
            -2.1719029392306615,
            -2.02776287509313,
            -1.8836228109555988,
            -1.7270463002012066,
            -1.5704697894468143,
            -1.4261200959690359,
            -1.2817704024912573,
            -0.9722541479856175,
            -0.6136492135533372,
            -0.2949634675303348,
            -0.015504786793553571,
            0.28918018982762694,
            0.5956759929100803,
            0.9345462964258912,
            1.2569728395387225,
            1.5922216337637265,
            1.8744297090074906,
            2.046701745471532,
            2.218973781935574,
            2.38091457730434,
            2.542855372673106,
            2.8022970848908297,
            3.0617387971085535,
            3.1016657253491733
        ],
        "showlegend": true,
        "mode": "lines",
        "name": "y1",
        "zmin": -0.1,
        "legendgroup": "y1",
        "zmax": 0.1,
        "line": {
            "color": "rgba(0, 0, 255, 1.000)",
            "shape": "linear",
            "dash": "solid",
            "width": 1
        },
        "y": [
            -4.445335537831813,
            -4.356497406023326,
            -4.269001235906489,
            -4.182834130432813,
            -3.8013720833249645,
            -3.4467807955061485,
            -3.1178126655713014,
            -2.813237196170592,
            -2.531842735509488,
            -2.2724381844466355,
            -2.0338546606069015,
            -1.8149471111429845,
            -1.5762954815473407,
            -1.362559355215364,
            -1.1719058717207056,
            -1.0025650170285294,
            -0.7599668237691312,
            -0.5656785309538801,
            -0.4009934672398927,
            -0.2764271567998121,
            -0.19061945145229464,
            -0.12726895968643692,
            -0.04654478661696726,
            -0.010089678838573923,
            -0.0013264318835677913,
            -1.2459733139463455e-5,
            -5.782639740603557e-6,
            8.843380825518388e-6,
            -2.3302932439905888e-5,
            0.0008318584228018677,
            0.007390188536865239,
            0.0249355747878941,
            0.04536291102290402,
            0.07648355824981234,
            0.11831793909242871,
            0.17526345099639656,
            0.3055456119103694,
            0.4948872536593489,
            0.5300453321155777
        ],
        "type": "scatter",
        "hoverinfo": "text"
    },
    {
        "xaxis": "x1",
        "colorbar": {
            "title": ""
        },
        "yaxis": "y1",
        "text": [
            null,
            null,
            null,
            null,
            null,
            null,
            null,
            null,
            null,
            null,
            null,
            null,
            null,
            null,
            null,
            null,
            null,
            null,
            null,
            null,
            null,
            null,
            null,
            null,
            null,
            null,
            null,
            null,
            null,
            null,
            null,
            null,
            null,
            null,
            null,
            null,
            null,
            null,
            null,
            null,
            null
        ],
        "x": [
            -3.296972597429656,
            -3.2808551059251103,
            -3.264737614420564,
            -3.2486201229160176,
            -3.0995906411768015,
            -2.9505611594375853,
            -2.801531677698369,
            -2.6525021959591535,
            -2.5629416892857586,
            -2.473381182612364,
            -2.3838206759389693,
            -2.2942601692655744,
            -2.1428156321196608,
            -1.9913710949737473,
            -1.6623486633409201,
            -1.3590190839251928,
            -1.0338177168852971,
            -0.6570400413771285,
            -0.3222045076881507,
            -0.028583918514501767,
            0.2915413397598456,
            0.6135691903281535,
            0.9696121585030544,
            1.3083780587227793,
            1.4844970259714954,
            1.6606159932202116,
            1.8088706495153262,
            1.957125305810441,
            2.138127437185846,
            2.319129568561251,
            2.404203239599247,
            2.4892769106372423,
            2.5743505816752377,
            2.6594242527132335,
            2.795718870931479,
            2.9320134891497247,
            3.0683081073679705,
            3.204602725586216,
            3.2255778625241645,
            3.2465529994621125,
            3.267528136400061
        ],
        "showlegend": true,
        "mode": "lines",
        "name": "y2",
        "zmin": -0.1,
        "legendgroup": "y2",
        "zmax": 0.1,
        "line": {
            "color": "rgba(0, 128, 0, 1.000)",
            "shape": "linear",
            "dash": "solid",
            "width": 1
        },
        "y": [
            -2.521302836440819,
            -2.466191800555373,
            -2.4119691030866477,
            -2.358626406359855,
            -1.9055989798009316,
            -1.520481942690492,
            -1.196687027422942,
            -0.9277192791810727,
            -0.7898064060885397,
            -0.6680673447756694,
            -0.5612010752035292,
            -0.4679463866854465,
            -0.33784033299281857,
            -0.23763320099607121,
            -0.0990865836120518,
            -0.03697597214025217,
            -0.00959424255153063,
            -0.0010099917648368484,
            -2.88671257779316e-5,
            -1.590080567215324e-10,
            1.7516233938752457e-5,
            0.0007182019658603656,
            0.006984025763330459,
            0.030679253607786228,
            0.0570202897564811,
            0.09858462882344687,
            0.14936465075921224,
            0.21858224704646567,
            0.33431737940393835,
            0.4925474508000197,
            0.5842810839325233,
            0.6885519339083082,
            0.8064482628199147,
            0.939090091680691,
            1.1852102594495453,
            1.4769763775690516,
            1.8193494595315567,
            2.2173620893510937,
            2.283877167247371,
            2.351848263721954,
            2.421293793409355
        ],
        "type": "scatter",
        "hoverinfo": "text"
    }
]
, {
    "showlegend": true,
    "xaxis": {
        "showticklabels": true,
        "gridwidth": 0.5,
        "tickvals": [
            -3.0,
            -2.0,
            -1.0,
            0.0,
            1.0,
            2.0,
            3.0
        ],
        "visible": true,
        "ticks": "inside",
        "range": [
            -3.4939076194445478,
            3.4644631584149526
        ],
        "domain": [
            0.03769928064547487,
            0.9931649168853894
        ],
        "tickmode": "array",
        "linecolor": "rgba(0, 0, 0, 1.000)",
        "showgrid": true,
        "title": "",
        "mirror": false,
        "tickangle": 0,
        "showline": true,
        "gridcolor": "rgba(0, 0, 0, 0.100)",
        "titlefont": {
            "color": "rgba(0, 0, 0, 1.000)",
            "family": "sans-serif",
            "size": 15
        },
        "tickcolor": "rgb(0, 0, 0)",
        "ticktext": [
            "-3",
            "-2",
            "-1",
            "0",
            "1",
            "2",
            "3"
        ],
        "zeroline": false,
        "type": "-",
        "tickfont": {
            "color": "rgba(0, 0, 0, 1.000)",
            "family": "sans-serif",
            "size": 11
        },
        "zerolinecolor": "rgba(0, 0, 0, 1.000)",
        "anchor": "y1"
    },
    "paper_bgcolor": "rgba(255, 255, 255, 1.000)",
    "annotations": [],
    "height": 384,
    "margin": {
        "l": 0,
        "b": 20,
        "r": 0,
        "t": 20
    },
    "plot_bgcolor": "rgba(255, 255, 255, 1.000)",
    "yaxis": {
        "showticklabels": true,
        "gridwidth": 0.5,
        "tickvals": [
            -4.0,
            -3.0,
            -2.0,
            -1.0,
            0.0,
            1.0,
            2.0
        ],
        "visible": true,
        "ticks": "inside",
        "range": [
            -4.651334417769048,
            2.6272926733465902
        ],
        "domain": [
            0.0391878098571012,
            0.989747375328084
        ],
        "tickmode": "array",
        "linecolor": "rgba(0, 0, 0, 1.000)",
        "showgrid": true,
        "title": "",
        "mirror": false,
        "tickangle": 0,
        "showline": true,
        "gridcolor": "rgba(0, 0, 0, 0.100)",
        "titlefont": {
            "color": "rgba(0, 0, 0, 1.000)",
            "family": "sans-serif",
            "size": 15
        },
        "tickcolor": "rgb(0, 0, 0)",
        "ticktext": [
            "-4",
            "-3",
            "-2",
            "-1",
            "0",
            "1",
            "2"
        ],
        "zeroline": false,
        "type": "-",
        "tickfont": {
            "color": "rgba(0, 0, 0, 1.000)",
            "family": "sans-serif",
            "size": 11
        },
        "zerolinecolor": "rgba(0, 0, 0, 1.000)",
        "anchor": "x1"
    },
    "legend": {
        "tracegroupgap": 0,
        "bordercolor": "rgba(0, 0, 0, 1.000)",
        "bgcolor": "rgba(255, 255, 255, 1.000)",
        "font": {
            "color": "rgba(0, 0, 0, 1.000)",
            "family": "sans-serif",
            "size": 11
        },
        "y": 1.0,
        "x": 1.0
    },
    "width": 576
}
);
    </script>


<p>The graph should be <span class="math">$0$</span> at each of the the points in <code>xs</code>, which we can verify in the graph above. Plotting over a wider region shows a common phenomenon that these polynomials approximate the function near the values, but quickly deviate away:</p>
<p>In this graph we make a plot of the Taylor polynomial for different sizes of <span class="math">$n$</span>:</p>


<pre class='hljl'>
<span class='hljl-nf'>f</span><span class='hljl-p'>(</span><span class='hljl-n'>x</span><span class='hljl-p'>)</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-ni'>1</span><span class='hljl-t'> </span><span class='hljl-oB'>-</span><span class='hljl-t'> </span><span class='hljl-nf'>cos</span><span class='hljl-p'>(</span><span class='hljl-n'>x</span><span class='hljl-p'>)</span><span class='hljl-t'>
</span><span class='hljl-n'>a</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>b</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-oB'>-</span><span class='hljl-n'>pi</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>pi</span><span class='hljl-t'>
</span><span class='hljl-nf'>plot</span><span class='hljl-p'>(</span><span class='hljl-n'>f</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>a</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>b</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>linewidth</span><span class='hljl-oB'>=</span><span class='hljl-ni'>5</span><span class='hljl-p'>)</span><span class='hljl-t'>
</span><span class='hljl-nf'>plot!</span><span class='hljl-p'>(</span><span class='hljl-nf'>taylor_poly</span><span class='hljl-p'>(</span><span class='hljl-n'>f</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-ni'>0</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-ni'>2</span><span class='hljl-p'>))</span><span class='hljl-t'>
</span><span class='hljl-nf'>plot!</span><span class='hljl-p'>(</span><span class='hljl-nf'>taylor_poly</span><span class='hljl-p'>(</span><span class='hljl-n'>f</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-ni'>0</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-ni'>4</span><span class='hljl-p'>))</span><span class='hljl-t'>
</span><span class='hljl-nf'>plot!</span><span class='hljl-p'>(</span><span class='hljl-nf'>taylor_poly</span><span class='hljl-p'>(</span><span class='hljl-n'>f</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-ni'>0</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-ni'>6</span><span class='hljl-p'>))</span>
</pre>



    <div id="46ba99ea-e308-44f1-9a23-11c483e607ca" style="width:576px;height:384px;"></div>
    <script>
    PLOT = document.getElementById('46ba99ea-e308-44f1-9a23-11c483e607ca');
    Plotly.plot(PLOT, [
    {
        "xaxis": "x1",
        "colorbar": {
            "title": ""
        },
        "yaxis": "y1",
        "text": [
            null,
            null,
            null,
            null,
            null,
            null,
            null,
            null,
            null,
            null,
            null,
            null,
            null,
            null,
            null,
            null,
            null,
            null,
            null,
            null,
            null,
            null,
            null,
            null,
            null,
            null,
            null,
            null,
            null,
            null,
            null,
            null,
            null,
            null,
            null,
            null,
            null,
            null,
            null,
            null,
            null,
            null,
            null,
            null,
            null,
            null,
            null
        ],
        "x": [
            -3.1262525409453663,
            -3.1109124283009395,
            -3.0955723156565123,
            -3.0802322030120854,
            -2.938390711327397,
            -2.796549219642708,
            -2.6547077279580193,
            -2.5128662362733305,
            -2.427625412012663,
            -2.342384587751996,
            -2.257143763491329,
            -2.1719029392306615,
            -2.02776287509313,
            -1.8836228109555988,
            -1.5704697894468143,
            -1.2817704024912573,
            -1.1270122752384375,
            -0.9722541479856175,
            -0.7929516807694774,
            -0.6136492135533372,
            -0.5339777770475866,
            -0.45430634054183605,
            -0.37463490403608546,
            -0.2949634675303348,
            -0.15523412716194418,
            -0.015504786793553571,
            0.1368377015170367,
            0.28918018982762694,
            0.44242809136885364,
            0.5956759929100803,
            0.7651111446679857,
            0.9345462964258912,
            1.095759567982307,
            1.2569728395387225,
            1.5922216337637265,
            1.8744297090074906,
            2.046701745471532,
            2.218973781935574,
            2.38091457730434,
            2.542855372673106,
            2.672576228781968,
            2.8022970848908297,
            2.9320179409996916,
            3.0617387971085535,
            3.0817022612288634,
            3.1016657253491733,
            3.121629189469483
        ],
        "showlegend": true,
        "mode": "lines",
        "name": "y1",
        "zmin": -0.1,
        "legendgroup": "y1",
        "zmax": 0.1,
        "line": {
            "color": "rgba(0, 154, 250, 1.000)",
            "shape": "linear",
            "dash": "solid",
            "width": 5
        },
        "y": [
            1.999882342779304,
            1.9995293988036598,
            1.9989412511258813,
            1.998118038145611,
            1.9794254271719192,
            1.9410607625022607,
            1.8837946099423324,
            1.8087771773557115,
            1.755769932813064,
            1.6972745896094517,
            1.6337159175071656,
            1.5655554541357317,
            1.4412279365948912,
            1.3077491700525026,
            0.9996734626577206,
            0.7149813124769616,
            0.5706399656848867,
            0.43656131792867725,
            0.2982544834924412,
            0.18244795073610376,
            0.13921064906783376,
            0.10143435076058316,
            0.06935871548462968,
            0.04318723687271764,
            0.01202464087912436,
            0.00012019679880115319,
            0.009347678684144767,
            0.041522019983039615,
            0.09628522274075979,
            0.1722305902936495,
            0.2786946188136761,
            0.405816585278846,
            0.5426288637855405,
            0.6913023669921131,
            1.0214236678141406,
            1.2989893509828225,
            1.458143441848972,
            1.6037345029902235,
            1.7243687028469896,
            1.8260479415646005,
            1.8920133045781489,
            1.942989350346633,
            1.9781194816444272,
            1.9968133746723455,
            1.9982071064522624,
            1.9992030260843752,
            1.9998007366681563
        ],
        "type": "scatter",
        "hoverinfo": "text"
    },
    {
        "xaxis": "x1",
        "colorbar": {
            "title": ""
        },
        "yaxis": "y1",
        "text": [
            null,
            null,
            null,
            null,
            null,
            null,
            null,
            null,
            null,
            null,
            null,
            null,
            null,
            null,
            null,
            null,
            null,
            null,
            null,
            null,
            null,
            null,
            null,
            null,
            null,
            null,
            null,
            null,
            null,
            null,
            null,
            null,
            null,
            null,
            null,
            null,
            null,
            null,
            null
        ],
        "x": [
            -3.2813506812725874,
            -3.2490123696873634,
            -2.949997984321759,
            -2.650983598956155,
            -2.4712884168791023,
            -2.291593234802049,
            -2.1396632453020334,
            -1.9877332558020173,
            -1.8226947026613307,
            -1.6576561495206439,
            -1.5055052014436132,
            -1.3533542533665823,
            -1.1902323566944073,
            -1.0271104600222325,
            -0.8381177457170501,
            -0.6491250314118676,
            -0.4811706103534674,
            -0.31321618929506717,
            -0.16593529732350537,
            -0.01865440535194355,
            0.14192130125624894,
            0.30249700786444145,
            0.46402705997987975,
            0.6255571120953181,
            0.8041492403945685,
            0.9827413686938189,
            1.1526672723721973,
            1.3225931760505758,
            1.4992766890324312,
            1.6759602020142863,
            1.8246900855659363,
            1.9734199691175862,
            2.155002299108469,
            2.336584629099352,
            2.507277374986611,
            2.6779701208738693,
            2.951433136510488,
            3.2248961521471067,
            3.266980896764518
        ],
        "showlegend": true,
        "mode": "lines",
        "name": "y2",
        "zmin": -0.1,
        "legendgroup": "y2",
        "zmax": 0.1,
        "line": {
            "color": "rgba(227, 111, 71, 1.000)",
            "shape": "linear",
            "dash": "solid",
            "width": 1
        },
        "y": [
            5.383631146744037,
            5.278040689190748,
            4.351244053751221,
            3.513857020967264,
            3.05363321970041,
            2.6256997768952597,
            2.2890794016482148,
            1.975541748110644,
            1.6611079895548384,
            1.3739119550218037,
            1.1332729557868872,
            0.9157838675527098,
            0.7083265314611614,
            0.527477948543541,
            0.35122067784291494,
            0.21068165320272905,
            0.11576257813396418,
            0.049052190618261673,
            0.013767261448920064,
            0.00017399341951731008,
            0.010070827875133484,
            0.045752219883469974,
            0.10766055619678547,
            0.19566085024651717,
            0.32332800041358073,
            0.48289029887110024,
            0.6643209203989807,
            0.8746263546677747,
            1.1239152951380247,
            1.4044212993678837,
            1.6647469541813118,
            1.9471931872560275,
            2.322017454581394,
            2.729813864471678,
            3.143219917559875,
            3.585761984146603,
            4.355478779646068,
            5.199977596066607,
            5.336582089912147
        ],
        "type": "scatter",
        "hoverinfo": "text"
    },
    {
        "xaxis": "x1",
        "colorbar": {
            "title": ""
        },
        "yaxis": "y1",
        "text": [
            null,
            null,
            null,
            null,
            null,
            null,
            null,
            null,
            null,
            null,
            null,
            null,
            null,
            null,
            null,
            null,
            null,
            null,
            null,
            null,
            null,
            null,
            null,
            null,
            null,
            null,
            null,
            null,
            null,
            null,
            null,
            null,
            null,
            null,
            null,
            null,
            null,
            null,
            null,
            null,
            null,
            null,
            null,
            null,
            null,
            null,
            null,
            null,
            null,
            null,
            null,
            null,
            null,
            null,
            null,
            null,
            null,
            null,
            null,
            null,
            null,
            null,
            null,
            null,
            null,
            null,
            null,
            null,
            null,
            null,
            null,
            null,
            null,
            null,
            null,
            null,
            null,
            null,
            null,
            null,
            null,
            null,
            null,
            null,
            null,
            null,
            null,
            null,
            null,
            null,
            null,
            null,
            null
        ],
        "x": [
            -3.4608539260294418,
            -3.443907223445183,
            -3.4269605208609244,
            -3.4100138182766657,
            -3.37083963439997,
            -3.331665450523275,
            -3.292491266646579,
            -3.2533170827698834,
            -3.214142898893188,
            -3.1749687150164925,
            -3.135794531139797,
            -3.0966203472631015,
            -3.0574461633864063,
            -3.0182719795097106,
            -2.979097795633015,
            -2.9399236117563197,
            -2.9007494278796244,
            -2.8615752440029287,
            -2.822401060126233,
            -2.783226876249538,
            -2.7361427729490515,
            -2.689058669648565,
            -2.641974566348079,
            -2.594890463047593,
            -2.500722256446621,
            -2.4065540498456484,
            -2.326936029625238,
            -2.2473180094048284,
            -2.1676999891844186,
            -2.0880819689640084,
            -2.0015944828242094,
            -1.9151069966844105,
            -1.8286195105446117,
            -1.7421320244048126,
            -1.5826643998704173,
            -1.423196775336022,
            -1.2522306282260662,
            -1.0812644811161107,
            -0.9822239572631251,
            -0.8831834334101394,
            -0.7841429095571537,
            -0.6851023857041679,
            -0.5970868560780465,
            -0.509071326451925,
            -0.4210557968258035,
            -0.3330402671996821,
            -0.2558585792810463,
            -0.17867689136241058,
            -0.10149520344377483,
            -0.024313515525139072,
            0.05983524205531454,
            0.14398399963576816,
            0.22813275721622178,
            0.3122815147966754,
            0.3969303915448009,
            0.4815792682929264,
            0.566228145041052,
            0.6508770217891775,
            0.7444671795251806,
            0.8380573372611837,
            0.9316474949971868,
            1.02523765273319,
            1.2033349998015272,
            1.3814323468698646,
            1.566612265008422,
            1.7517921831469796,
            1.9076742300682459,
            2.0635562769895124,
            2.1587134323902357,
            2.253870587790959,
            2.349027743191683,
            2.444184898592406,
            2.533635431290084,
            2.623085963987762,
            2.6678112303366013,
            2.7125364966854404,
            2.7572617630342795,
            2.8019870293831186,
            2.873640374388083,
            2.9452937193930477,
            3.0169470643980123,
            3.0886004094029773,
            3.12442708190546,
            3.1602537544079423,
            3.1960804269104246,
            3.231907099412907,
            3.267733771915389,
            3.3035604444178714,
            3.3393871169203537,
            3.375213789422836,
            3.397268053093535,
            3.4193223167642337,
            3.441376580434932
        ],
        "showlegend": true,
        "mode": "lines",
        "name": "y3",
        "zmin": -0.1,
        "legendgroup": "y3",
        "zmax": 0.1,
        "line": {
            "color": "rgba(62, 164, 78, 1.000)",
            "shape": "linear",
            "dash": "solid",
            "width": 1
        },
        "y": [
            0.011223976146680137,
            0.06894063910364956,
            0.12524137353432163,
            0.1801428994750074,
            0.30178966472464985,
            0.4162522634593744,
            0.5237321641216504,
            0.6244284801055775,
            0.7185379697568992,
            0.8062550363729963,
            0.8877717282028827,
            0.9632777384472173,
            1.0329604052582932,
            1.0970047117400434,
            1.155593285948037,
            1.2089064008894823,
            1.257121974523224,
            1.3004155697597493,
            1.3389603944611794,
            1.3729273014412744,
            1.407932721416521,
            1.4368562110304257,
            1.4599809152096777,
            1.4775850641786727,
            1.497320043872039,
            1.498188697859906,
            1.4857226445263583,
            1.462430518966699,
            1.4294666363617057,
            1.3879451286016709,
            1.3343950493435406,
            1.2733363589434754,
            1.2060359806288068,
            1.1337048859513894,
            0.9909901217594789,
            0.8418026165986453,
            0.6815874508110362,
            0.5276134521154439,
            0.4435998933179036,
            0.36465564500978626,
            0.2916868204467061,
            0.22550331590566425,
            0.17296046872430917,
            0.12677844952513884,
            0.08733436580009014,
            0.05494531316187147,
            0.032553244438626144,
            0.01592024770442967,
            0.005146216648802283,
            0.00029555895797810685,
            0.0017895940028090805,
            0.010347788133034642,
            0.025909417636858282,
            0.04836361805167945,
            0.07774256871415948,
            0.11371820277674557,
            0.15602409206785833,
            0.20434246499537467,
            0.26431683969018605,
            0.3306166495677047,
            0.40259324378177797,
            0.4795212493446838,
            0.6366430695066304,
            0.8024351619208497,
            0.9761594605845961,
            1.141996874985927,
            1.2677800984326253,
            1.3735982282067654,
            1.425188211209151,
            1.4647281678432362,
            1.4903170752246477,
            1.4999719195407024,
            1.4926741826219836,
            1.4676907878567957,
            1.4479927795661856,
            1.4231763269594047,
            1.393000750505931,
            1.3572213692773212,
            1.2875957713995305,
            1.201903549575687,
            1.0990743611067924,
            0.9780115032652019,
            0.9102925209069275,
            0.8375919132946352,
            0.7597651788293165,
            0.6766661684101694,
            0.5881470854346036,
            0.49405848579823886,
            0.3942492778949056,
            0.2885667226166415,
            0.22052296109261604,
            0.1501587491253984,
            0.07743752598247422
        ],
        "type": "scatter",
        "hoverinfo": "text"
    },
    {
        "xaxis": "x1",
        "colorbar": {
            "title": ""
        },
        "yaxis": "y1",
        "text": [
            null,
            null,
            null,
            null,
            null,
            null,
            null,
            null,
            null,
            null,
            null,
            null,
            null,
            null,
            null,
            null,
            null,
            null,
            null,
            null,
            null,
            null,
            null,
            null,
            null,
            null,
            null,
            null,
            null,
            null,
            null,
            null,
            null,
            null,
            null,
            null,
            null,
            null,
            null,
            null,
            null,
            null,
            null
        ],
        "x": [
            -3.6500582687242398,
            -3.632195696225107,
            -3.6143331237259746,
            -3.5964705512268416,
            -3.4313052758907854,
            -3.266140000554729,
            -3.100974725218673,
            -2.935809449882617,
            -2.7372945577778087,
            -2.5387796656730006,
            -2.3709378508593595,
            -2.203096036045718,
            -1.8384495253139113,
            -1.5022776959745527,
            -1.322071831000816,
            -1.1418659660270793,
            -0.9330797990568347,
            -0.7242936320865899,
            -0.53874912616524,
            -0.35320462024389,
            -0.19049880898681626,
            -0.027792997729742534,
            0.14960001138449172,
            0.326993020498726,
            0.5054403249658561,
            0.6838876294329862,
            0.8811839435038411,
            1.0784802575746961,
            1.266202722053798,
            1.4539251865329,
            1.84430080051293,
            2.172913915731079,
            2.373513599204078,
            2.574113282677077,
            2.762682901746512,
            2.9512525208159466,
            3.1023040972028992,
            3.2533556735898523,
            3.4044072499768054,
            3.5554588263637585,
            3.578704993680035,
            3.601951160996311,
            3.625197328312587
        ],
        "showlegend": true,
        "mode": "lines",
        "name": "y4",
        "zmin": -0.1,
        "legendgroup": "y4",
        "zmax": 0.1,
        "line": {
            "color": "rgba(195, 113, 210, 1.000)",
            "shape": "linear",
            "dash": "solid",
            "width": 1
        },
        "y": [
            2.550092651107654,
            2.5334992245037475,
            2.517434135079948,
            2.5018728489807587,
            2.3777957030562638,
            2.2782748152150623,
            2.1901472934078576,
            2.103478760201319,
            1.991397432827808,
            1.863626666032606,
            1.7407368961025356,
            1.6040497923438926,
            1.2675870616629143,
            0.9321625089958856,
            0.754059140315161,
            0.5841723534311022,
            0.40465179096002685,
            0.2510342147397666,
            0.14164904602409553,
            0.061730972008919305,
            0.01809009160230842,
            0.00038620050037125225,
            0.011169227617242396,
            0.05298754745312998,
            0.1250387482468124,
            0.22487884593715832,
            0.36377075206296555,
            0.5273766422181807,
            0.7002554766174592,
            0.8838785249136334,
            1.2733049661981537,
            1.5780907582658128,
            1.7427287963680422,
            1.8877171880122736,
            2.0064911659103455,
            2.111730910410767,
            2.1908394562762554,
            2.271192910895963,
            2.3603040512491695,
            2.4679221173008146,
            2.4868720520380787,
            2.506595250833226,
            2.5271435113834038
        ],
        "type": "scatter",
        "hoverinfo": "text"
    }
]
, {
    "showlegend": true,
    "xaxis": {
        "showticklabels": true,
        "gridwidth": 0.5,
        "tickvals": [
            -3.0,
            -2.0,
            -1.0,
            0.0,
            1.0,
            2.0,
            3.0
        ],
        "visible": true,
        "ticks": "inside",
        "range": [
            -3.8683159366353443,
            3.8434549962236915
        ],
        "domain": [
            0.022267181880042772,
            0.9931649168853892
        ],
        "tickmode": "array",
        "linecolor": "rgba(0, 0, 0, 1.000)",
        "showgrid": true,
        "title": "",
        "mirror": false,
        "tickangle": 0,
        "showline": true,
        "gridcolor": "rgba(0, 0, 0, 0.100)",
        "titlefont": {
            "color": "rgba(0, 0, 0, 1.000)",
            "family": "sans-serif",
            "size": 15
        },
        "tickcolor": "rgb(0, 0, 0)",
        "ticktext": [
            "-3",
            "-2",
            "-1",
            "0",
            "1",
            "2",
            "3"
        ],
        "zeroline": false,
        "type": "-",
        "tickfont": {
            "color": "rgba(0, 0, 0, 1.000)",
            "family": "sans-serif",
            "size": 11
        },
        "zerolinecolor": "rgba(0, 0, 0, 1.000)",
        "anchor": "y1"
    },
    "paper_bgcolor": "rgba(255, 255, 255, 1.000)",
    "annotations": [],
    "height": 384,
    "margin": {
        "l": 0,
        "b": 20,
        "r": 0,
        "t": 20
    },
    "plot_bgcolor": "rgba(255, 255, 255, 1.000)",
    "yaxis": {
        "showticklabels": true,
        "gridwidth": 0.5,
        "tickvals": [
            0.0,
            1.0,
            2.0,
            3.0,
            4.0,
            5.0
        ],
        "visible": true,
        "ticks": "inside",
        "range": [
            -0.1613851316995559,
            5.545136475242394
        ],
        "domain": [
            0.0391878098571012,
            0.989747375328084
        ],
        "tickmode": "array",
        "linecolor": "rgba(0, 0, 0, 1.000)",
        "showgrid": true,
        "title": "",
        "mirror": false,
        "tickangle": 0,
        "showline": true,
        "gridcolor": "rgba(0, 0, 0, 0.100)",
        "titlefont": {
            "color": "rgba(0, 0, 0, 1.000)",
            "family": "sans-serif",
            "size": 15
        },
        "tickcolor": "rgb(0, 0, 0)",
        "ticktext": [
            "0",
            "1",
            "2",
            "3",
            "4",
            "5"
        ],
        "zeroline": false,
        "type": "-",
        "tickfont": {
            "color": "rgba(0, 0, 0, 1.000)",
            "family": "sans-serif",
            "size": 11
        },
        "zerolinecolor": "rgba(0, 0, 0, 1.000)",
        "anchor": "x1"
    },
    "legend": {
        "tracegroupgap": 0,
        "bordercolor": "rgba(0, 0, 0, 1.000)",
        "bgcolor": "rgba(255, 255, 255, 1.000)",
        "font": {
            "color": "rgba(0, 0, 0, 1.000)",
            "family": "sans-serif",
            "size": 11
        },
        "y": 1.0,
        "x": 1.0
    },
    "width": 576
}
);
    </script>


<p>Though all are good approximations near <span class="math">$c=0$</span>, as more terms are included, the Taylor polynomial becomes a better approximation over a wider range of values.</p>
<h5>Example: Period of an orbiting satellite</h5>
<p>Kepler&#39;s third <a href="http://tinyurl.com/y7oa4x2g">law</a> of planetary motion states:</p>
<blockquote>
<p>The square of the orbital period of a planet is directly proportional to the cube of the semi-major axis of its orbit.</p>
</blockquote>
<p>In formulas, <span class="math">$P^2 = a^3 \cdot (4\pi^2) / (G\cdot(M + m))$</span>, where <span class="math">$M$</span> and <span class="math">$m$</span> are the respective masses. Suppose a satellite is in low earth orbit with a constant height, <span class="math">$a$</span>. Use a Taylor polynomial to approximate the period using Kepler&#39;s third law to relate the quantities.</p>
<p>Suppose <span class="math">$R$</span> is the radius of the earth and <span class="math">$h$</span> the height above the earth assuming <span class="math">$h$</span> is much smaller than <span class="math">$R$</span>. The mass <span class="math">$m$</span> of a satellite is negligible to that of the earth, so <span class="math">$M+m=M$</span> for this purpose. We have:</p>
<p class="math">\[
~
P = \frac{2\pi}{\sqrt{G\cdot M}} \cdot (h+R)^{3/2} =  \frac{2\pi}{\sqrt{G\cdot M}} \cdot R^{3/2} \cdot (1 + h/R)^{3/2} = P_0 \cdot  (1 + h/R)^{3/2},
~
\]</p>
<p>where <span class="math">$P_0$</span> collects terms that involve the constants.</p>
<p>We can expand <span class="math">$(1+x)^{3/2}$</span> to fifth order, to get:</p>
<p class="math">\[
~
(1+x)^{3/2} \approx 1 + \frac{3x}{2} + \frac{3x^2}{8} - \frac{1x^3}{16} + \frac{3x^4}{128} -\frac{3x^5}{256}
~
\]</p>
<p>Our approximation becomes:</p>
<p class="math">\[
~
P \approx P_0 \cdot (1 + \frac{3(h/R)}{2} + \frac{3(h/R)^2}{8} - \frac{(h/R)^3}{16} + \frac{3(h/R)^4}{128} - \frac{3(h/R)^5}{256}).
~
\]</p>
<p>Typically, if <span class="math">$h$</span> is much smaller than <span class="math">$R$</span> the first term is enough giving a formula like <span class="math">$P \approx P_0 \cdot(1 + \frac{3h}{2R})$</span>.</p>
<p>A satellite phone utilizes low orbit satellites to relay phone communications. The <a href="http://www.kddi.com/english/business/cloud-network-voice/satellite/iridium/mobile/">Iridium</a> system uses satellites with an elevation <span class="math">$h=780km$</span>. The radius of the earth is <span class="math">$3,959$</span> miles, the mass of the earth is <span class="math">$5.972 × 10^{24} kg$</span>, and the gravitational <a href="https://en.wikipedia.org/wiki/Gravitational_constant">constant</a>, <span class="math">$G$</span> is <span class="math">$6.67408 \cdot 10^{-11}$</span> <span class="math">$m^3/(kg \cdot s^2)$</span>.</p>
<p>Compare the approximate value with 1 term to the exact value.</p>


<pre class='hljl'>
<span class='hljl-n'>G</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-nfB'>6.67408e-11</span><span class='hljl-t'>
</span><span class='hljl-n'>h</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-ni'>780</span><span class='hljl-t'> </span><span class='hljl-oB'>*</span><span class='hljl-t'> </span><span class='hljl-ni'>1000</span><span class='hljl-t'>
</span><span class='hljl-n'>R</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'>  </span><span class='hljl-ni'>3959</span><span class='hljl-t'> </span><span class='hljl-oB'>*</span><span class='hljl-t'> </span><span class='hljl-nfB'>1609.34</span><span class='hljl-t'>   </span><span class='hljl-cs'># 1609 meters per mile</span><span class='hljl-t'>
</span><span class='hljl-n'>M</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-nfB'>5.972e24</span><span class='hljl-t'>
</span><span class='hljl-n'>P0</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>hR</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-p'>(</span><span class='hljl-ni'>2</span><span class='hljl-n'>pi</span><span class='hljl-p'>)</span><span class='hljl-oB'>/</span><span class='hljl-nf'>sqrt</span><span class='hljl-p'>(</span><span class='hljl-n'>G</span><span class='hljl-oB'>*</span><span class='hljl-n'>M</span><span class='hljl-p'>)</span><span class='hljl-t'> </span><span class='hljl-oB'>*</span><span class='hljl-t'> </span><span class='hljl-n'>R</span><span class='hljl-oB'>^</span><span class='hljl-p'>(</span><span class='hljl-ni'>3</span><span class='hljl-oB'>/</span><span class='hljl-ni'>2</span><span class='hljl-p'>),</span><span class='hljl-t'> </span><span class='hljl-n'>h</span><span class='hljl-oB'>/</span><span class='hljl-n'>R</span><span class='hljl-t'>

</span><span class='hljl-n'>Preal</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-n'>P0</span><span class='hljl-t'> </span><span class='hljl-oB'>*</span><span class='hljl-t'> </span><span class='hljl-p'>(</span><span class='hljl-ni'>1</span><span class='hljl-t'> </span><span class='hljl-oB'>+</span><span class='hljl-t'> </span><span class='hljl-n'>hR</span><span class='hljl-p'>)</span><span class='hljl-oB'>^</span><span class='hljl-p'>(</span><span class='hljl-ni'>3</span><span class='hljl-oB'>/</span><span class='hljl-ni'>2</span><span class='hljl-p'>)</span><span class='hljl-t'>
</span><span class='hljl-n'>P1</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-n'>P0</span><span class='hljl-t'> </span><span class='hljl-oB'>*</span><span class='hljl-t'> </span><span class='hljl-p'>(</span><span class='hljl-ni'>1</span><span class='hljl-t'> </span><span class='hljl-oB'>+</span><span class='hljl-t'> </span><span class='hljl-ni'>3</span><span class='hljl-oB'>*</span><span class='hljl-n'>hR</span><span class='hljl-oB'>/</span><span class='hljl-ni'>2</span><span class='hljl-p'>)</span><span class='hljl-t'>
</span><span class='hljl-n'>Preal</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>P1</span>
</pre>


<pre class="output">
&#40;6018.78431252517, 5990.893153415102&#41;
</pre>


<p>With terms out to the fifth power, we get a better approximation:</p>


<pre class='hljl'>
<span class='hljl-n'>P5</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-n'>P0</span><span class='hljl-t'> </span><span class='hljl-oB'>*</span><span class='hljl-t'> </span><span class='hljl-p'>(</span><span class='hljl-ni'>1</span><span class='hljl-t'> </span><span class='hljl-oB'>+</span><span class='hljl-t'> </span><span class='hljl-ni'>3</span><span class='hljl-oB'>*</span><span class='hljl-n'>hR</span><span class='hljl-oB'>/</span><span class='hljl-ni'>2</span><span class='hljl-t'> </span><span class='hljl-oB'>+</span><span class='hljl-t'> </span><span class='hljl-ni'>3</span><span class='hljl-oB'>*</span><span class='hljl-n'>hR</span><span class='hljl-oB'>^</span><span class='hljl-ni'>2</span><span class='hljl-oB'>/</span><span class='hljl-ni'>8</span><span class='hljl-t'> </span><span class='hljl-oB'>-</span><span class='hljl-t'> </span><span class='hljl-n'>hR</span><span class='hljl-oB'>^</span><span class='hljl-ni'>3</span><span class='hljl-oB'>/</span><span class='hljl-ni'>16</span><span class='hljl-t'> </span><span class='hljl-oB'>+</span><span class='hljl-t'> </span><span class='hljl-ni'>3</span><span class='hljl-oB'>*</span><span class='hljl-n'>hR</span><span class='hljl-oB'>^</span><span class='hljl-ni'>4</span><span class='hljl-oB'>/</span><span class='hljl-ni'>128</span><span class='hljl-t'> </span><span class='hljl-oB'>-</span><span class='hljl-t'> </span><span class='hljl-ni'>3</span><span class='hljl-oB'>*</span><span class='hljl-n'>hR</span><span class='hljl-oB'>^</span><span class='hljl-ni'>5</span><span class='hljl-oB'>/</span><span class='hljl-ni'>256</span><span class='hljl-p'>)</span>
</pre>


<pre class="output">
6018.784204505923
</pre>


<p>The units of the period above are in seconds. That answer here is about 100 minutes:</p>


<pre class='hljl'>
<span class='hljl-n'>Preal</span><span class='hljl-oB'>/</span><span class='hljl-ni'>60</span>
</pre>


<pre class="output">
100.31307187541951
</pre>


<p>When <span class="math">$h$</span> is much smaller than <span class="math">$R$</span> the approximation with 5th order is really good, and serviceable with just 1 term. Next we check if this is the same when <span class="math">$h$</span> is larger than <span class="math">$R$</span>.</p>
<hr />
<p>The height of a <a href="http://www.gps.gov/systems/gps/space/">GPS satellite</a> is about <span class="math">$12,550$</span> miles. Compute the period of a circular orbit and compare with the estimates.</p>


<pre class='hljl'>
<span class='hljl-n'>h</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-ni'>12250</span><span class='hljl-t'> </span><span class='hljl-oB'>*</span><span class='hljl-t'> </span><span class='hljl-nfB'>1609.34</span><span class='hljl-t'>   </span><span class='hljl-cs'># 1609 meters per mile</span><span class='hljl-t'>
</span><span class='hljl-n'>hR</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-n'>h</span><span class='hljl-oB'>/</span><span class='hljl-n'>R</span><span class='hljl-t'>

</span><span class='hljl-n'>Preal</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-n'>P0</span><span class='hljl-t'> </span><span class='hljl-oB'>*</span><span class='hljl-t'> </span><span class='hljl-p'>(</span><span class='hljl-ni'>1</span><span class='hljl-t'> </span><span class='hljl-oB'>+</span><span class='hljl-t'> </span><span class='hljl-n'>hR</span><span class='hljl-p'>)</span><span class='hljl-oB'>^</span><span class='hljl-p'>(</span><span class='hljl-ni'>3</span><span class='hljl-oB'>/</span><span class='hljl-ni'>2</span><span class='hljl-p'>)</span><span class='hljl-t'>
</span><span class='hljl-n'>P1</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-n'>P0</span><span class='hljl-t'> </span><span class='hljl-oB'>*</span><span class='hljl-t'> </span><span class='hljl-p'>(</span><span class='hljl-ni'>1</span><span class='hljl-t'> </span><span class='hljl-oB'>+</span><span class='hljl-t'> </span><span class='hljl-ni'>3</span><span class='hljl-oB'>*</span><span class='hljl-n'>hR</span><span class='hljl-oB'>/</span><span class='hljl-ni'>2</span><span class='hljl-p'>)</span><span class='hljl-t'>
</span><span class='hljl-n'>P5</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-n'>P0</span><span class='hljl-t'> </span><span class='hljl-oB'>*</span><span class='hljl-t'> </span><span class='hljl-p'>(</span><span class='hljl-ni'>1</span><span class='hljl-t'> </span><span class='hljl-oB'>+</span><span class='hljl-t'> </span><span class='hljl-ni'>3</span><span class='hljl-oB'>*</span><span class='hljl-n'>hR</span><span class='hljl-oB'>/</span><span class='hljl-ni'>2</span><span class='hljl-t'> </span><span class='hljl-oB'>+</span><span class='hljl-t'> </span><span class='hljl-ni'>3</span><span class='hljl-oB'>*</span><span class='hljl-n'>hR</span><span class='hljl-oB'>^</span><span class='hljl-ni'>2</span><span class='hljl-oB'>/</span><span class='hljl-ni'>8</span><span class='hljl-t'> </span><span class='hljl-oB'>-</span><span class='hljl-t'> </span><span class='hljl-n'>hR</span><span class='hljl-oB'>^</span><span class='hljl-ni'>3</span><span class='hljl-oB'>/</span><span class='hljl-ni'>16</span><span class='hljl-t'> </span><span class='hljl-oB'>+</span><span class='hljl-t'> </span><span class='hljl-ni'>3</span><span class='hljl-oB'>*</span><span class='hljl-n'>hR</span><span class='hljl-oB'>^</span><span class='hljl-ni'>4</span><span class='hljl-oB'>/</span><span class='hljl-ni'>128</span><span class='hljl-t'> </span><span class='hljl-oB'>-</span><span class='hljl-t'> </span><span class='hljl-ni'>3</span><span class='hljl-oB'>*</span><span class='hljl-n'>hR</span><span class='hljl-oB'>^</span><span class='hljl-ni'>5</span><span class='hljl-oB'>/</span><span class='hljl-ni'>256</span><span class='hljl-p'>)</span><span class='hljl-t'>

</span><span class='hljl-n'>Preal</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>P1</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>P5</span>
</pre>


<pre class="output">
&#40;41930.52564789311, 28553.22950490504, 31404.73066617854&#41;
</pre>


<p>We see the Taylor polynomial underestimates badly in this case. A reminder that these approximations are locally good, but may not be good on all scales. Here <span class="math">$h \approx 3R$</span>. We can see from this graph of <span class="math">$(1+x)^{3/2}$</span> and its 5th degree Taylor polynomial <span class="math">$T_5$</span> that it is a bad approximation when <span class="math">$x > 2$</span>.</p>


    <div id="266cc8d9-5740-499d-9add-a2f01a784be6" style="width:576px;height:384px;"></div>
    <script>
    PLOT = document.getElementById('266cc8d9-5740-499d-9add-a2f01a784be6');
    Plotly.plot(PLOT, [
    {
        "xaxis": "x1",
        "colorbar": {
            "title": ""
        },
        "yaxis": "y1",
        "text": [
            null,
            null,
            null,
            null,
            null,
            null,
            null,
            null,
            null,
            null,
            null,
            null,
            null,
            null,
            null,
            null,
            null,
            null,
            null
        ],
        "x": [
            -0.9609367239208474,
            -0.5997403313265086,
            -0.3826763547775045,
            -0.19915152513693707,
            0.0002078801322057279,
            0.18399961813851265,
            0.3810437856259594,
            0.6093387773541291,
            0.8122204244440858,
            0.99012934616088,
            1.1840978266212778,
            1.3792191150112483,
            1.5949506504976172,
            1.800213762979374,
            2.013639774045402,
            2.1932990146673808,
            2.4126425839454564,
            2.618832008514834,
            2.9491634560642397
        ],
        "showlegend": true,
        "mode": "lines",
        "name": "y1",
        "zmin": -0.1,
        "legendgroup": "y1",
        "zmax": 0.1,
        "line": {
            "color": "rgba(0, 154, 250, 1.000)",
            "shape": "linear",
            "dash": "solid",
            "width": 4
        },
        "y": [
            0.007720634524078875,
            0.25322859612249315,
            0.4850308561808127,
            0.7166804030604783,
            1.000311836403053,
            1.2883306633221403,
            1.6229725406357114,
            2.041602617014423,
            2.4395882398382556,
            2.807514162222148,
            3.227811243457906,
            3.6698782838906157,
            4.180167213355336,
            4.685832699651086,
            5.231629844297125,
            5.706362808343747,
            6.304290376261937,
            6.884186613595583,
            7.847975965931579
        ],
        "type": "scatter",
        "hoverinfo": "text"
    },
    {
        "xaxis": "x1",
        "colorbar": {
            "title": ""
        },
        "yaxis": "y1",
        "text": [
            null,
            null,
            null,
            null,
            null,
            null,
            null,
            null,
            null,
            null,
            null,
            null,
            null,
            null,
            null,
            null,
            null,
            null,
            null,
            null,
            null,
            null,
            null
        ],
        "x": [
            -1.0377632787710063,
            -0.6635000476523378,
            -0.43858344580261466,
            -0.24841932140914613,
            -0.041847781106628436,
            0.1485929074758032,
            0.35276545268658765,
            0.5893193690717805,
            0.7995405737443396,
            0.983885626053174,
            1.1848712164984774,
            1.387051319484402,
            1.610587277153835,
            1.8232761004145273,
            2.0444231277494627,
            2.230581819458838,
            2.344221150645781,
            2.4578604818327237,
            2.5646848048935897,
            2.6715091279544563,
            2.842649977413047,
            3.0137908268716376,
            3.040128644167715
        ],
        "showlegend": true,
        "mode": "lines",
        "name": "y2",
        "zmin": -0.1,
        "legendgroup": "y2",
        "zmax": 0.1,
        "line": {
            "color": "rgba(227, 111, 71, 1.000)",
            "shape": "linear",
            "dash": "solid",
            "width": 1
        },
        "y": [
            -0.04164788255397073,
            0.19414212948031104,
            0.4205882374598852,
            0.6515715794039981,
            0.9378896958525562,
            1.2309748262488502,
            1.5733697064213583,
            2.00341767687129,
            2.4128393636131995,
            2.7904714648040168,
            3.2186377161701034,
            3.6618458819557063,
            4.158218458146178,
            4.6256030499563865,
            5.090852168580264,
            5.451150131030571,
            5.650129979034411,
            5.82837324708645,
            5.972985690234794,
            6.091140874160848,
            6.21377116998744,
            6.235781387677795,
            6.22875448574133
        ],
        "type": "scatter",
        "hoverinfo": "text"
    }
]
, {
    "showlegend": false,
    "xaxis": {
        "showticklabels": true,
        "gridwidth": 0.5,
        "tickvals": [
            -1.0,
            0.0,
            1.0,
            2.0,
            3.0
        ],
        "visible": true,
        "ticks": "inside",
        "range": [
            -1.1601000364591678,
            3.1624654018558767
        ],
        "domain": [
            0.022267181880042772,
            0.9931649168853892
        ],
        "tickmode": "array",
        "linecolor": "rgba(0, 0, 0, 1.000)",
        "showgrid": true,
        "title": "",
        "mirror": false,
        "tickangle": 0,
        "showline": true,
        "gridcolor": "rgba(0, 0, 0, 0.100)",
        "titlefont": {
            "color": "rgba(0, 0, 0, 1.000)",
            "family": "sans-serif",
            "size": 15
        },
        "tickcolor": "rgb(0, 0, 0)",
        "ticktext": [
            "-1",
            "0",
            "1",
            "2",
            "3"
        ],
        "zeroline": false,
        "type": "-",
        "tickfont": {
            "color": "rgba(0, 0, 0, 1.000)",
            "family": "sans-serif",
            "size": 11
        },
        "zerolinecolor": "rgba(0, 0, 0, 1.000)",
        "anchor": "y1"
    },
    "paper_bgcolor": "rgba(255, 255, 255, 1.000)",
    "annotations": [],
    "height": 384,
    "margin": {
        "l": 0,
        "b": 20,
        "r": 0,
        "t": 20
    },
    "plot_bgcolor": "rgba(255, 255, 255, 1.000)",
    "yaxis": {
        "showticklabels": true,
        "gridwidth": 0.5,
        "tickvals": [
            0.0,
            2.0,
            4.0,
            6.0,
            8.0
        ],
        "visible": true,
        "ticks": "inside",
        "range": [
            -0.2783365980085372,
            8.084664681386146
        ],
        "domain": [
            0.0391878098571012,
            0.989747375328084
        ],
        "tickmode": "array",
        "linecolor": "rgba(0, 0, 0, 1.000)",
        "showgrid": true,
        "title": "",
        "mirror": false,
        "tickangle": 0,
        "showline": true,
        "gridcolor": "rgba(0, 0, 0, 0.100)",
        "titlefont": {
            "color": "rgba(0, 0, 0, 1.000)",
            "family": "sans-serif",
            "size": 15
        },
        "tickcolor": "rgb(0, 0, 0)",
        "ticktext": [
            "0",
            "2",
            "4",
            "6",
            "8"
        ],
        "zeroline": false,
        "type": "-",
        "tickfont": {
            "color": "rgba(0, 0, 0, 1.000)",
            "family": "sans-serif",
            "size": 11
        },
        "zerolinecolor": "rgba(0, 0, 0, 1.000)",
        "anchor": "x1"
    },
    "width": 576
}
);
    </script>


<hr />
<p>Finally, we show how to use the <code>Unitful</code> package to work with the units. This package allows us to define different units, carry these units through computations, and convert between similar units with <code>uconvert</code>. In this example, we define several units, then show how they can then be used as constants.</p>


<pre class='hljl'>
<span class='hljl-k'>using</span><span class='hljl-t'> </span><span class='hljl-n'>Unitful</span><span class='hljl-t'>
</span><span class='hljl-n'>m</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>mi</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>kg</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>s</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>hr</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-so'>u&quot;m&quot;</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-so'>u&quot;mi&quot;</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-so'>u&quot;kg&quot;</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-so'>u&quot;s&quot;</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-so'>u&quot;hr&quot;</span><span class='hljl-t'>

</span><span class='hljl-n'>G</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-nfB'>6.67408e-11</span><span class='hljl-t'> </span><span class='hljl-oB'>*</span><span class='hljl-t'> </span><span class='hljl-n'>m</span><span class='hljl-oB'>^</span><span class='hljl-ni'>3</span><span class='hljl-t'> </span><span class='hljl-oB'>/</span><span class='hljl-t'> </span><span class='hljl-n'>kg</span><span class='hljl-t'> </span><span class='hljl-oB'>/</span><span class='hljl-t'> </span><span class='hljl-n'>s</span><span class='hljl-oB'>^</span><span class='hljl-ni'>2</span><span class='hljl-t'>
</span><span class='hljl-n'>h</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-nf'>uconvert</span><span class='hljl-p'>(</span><span class='hljl-n'>m</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-ni'>12250</span><span class='hljl-t'> </span><span class='hljl-oB'>*</span><span class='hljl-t'> </span><span class='hljl-n'>mi</span><span class='hljl-p'>)</span><span class='hljl-t'>   </span><span class='hljl-cs'># unit convert miles to meter</span><span class='hljl-t'>
</span><span class='hljl-n'>R</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-nf'>uconvert</span><span class='hljl-p'>(</span><span class='hljl-n'>m</span><span class='hljl-p'>,</span><span class='hljl-t'>  </span><span class='hljl-ni'>3959</span><span class='hljl-t'> </span><span class='hljl-oB'>*</span><span class='hljl-t'> </span><span class='hljl-n'>mi</span><span class='hljl-p'>)</span><span class='hljl-t'>
</span><span class='hljl-n'>M</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-nfB'>5.972e24</span><span class='hljl-t'> </span><span class='hljl-oB'>*</span><span class='hljl-t'> </span><span class='hljl-n'>kg</span><span class='hljl-t'>

</span><span class='hljl-n'>P0</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>hR</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-p'>(</span><span class='hljl-ni'>2</span><span class='hljl-n'>pi</span><span class='hljl-p'>)</span><span class='hljl-oB'>/</span><span class='hljl-nf'>sqrt</span><span class='hljl-p'>(</span><span class='hljl-n'>G</span><span class='hljl-oB'>*</span><span class='hljl-n'>M</span><span class='hljl-p'>)</span><span class='hljl-t'> </span><span class='hljl-oB'>*</span><span class='hljl-t'> </span><span class='hljl-n'>R</span><span class='hljl-oB'>^</span><span class='hljl-p'>(</span><span class='hljl-ni'>3</span><span class='hljl-oB'>/</span><span class='hljl-ni'>2</span><span class='hljl-p'>),</span><span class='hljl-t'> </span><span class='hljl-n'>h</span><span class='hljl-oB'>/</span><span class='hljl-n'>R</span><span class='hljl-t'>
</span><span class='hljl-n'>Preal</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-n'>P0</span><span class='hljl-t'> </span><span class='hljl-oB'>*</span><span class='hljl-t'> </span><span class='hljl-p'>(</span><span class='hljl-ni'>1</span><span class='hljl-t'> </span><span class='hljl-oB'>+</span><span class='hljl-t'> </span><span class='hljl-n'>hR</span><span class='hljl-p'>)</span><span class='hljl-oB'>^</span><span class='hljl-p'>(</span><span class='hljl-ni'>3</span><span class='hljl-oB'>/</span><span class='hljl-ni'>2</span><span class='hljl-p'>)</span><span class='hljl-t'>    </span><span class='hljl-cs'># in seconds</span>
</pre>


<pre class="output">
41930.68197490307 s
</pre>


<p>We see <code>Preal</code> has the right units–-the units of mass and distance cancel leaving a measure of time–-but it is hard to sense how long this is. Converting to hours, helps us see the satellite orbits about twice per day:</p>


<pre class='hljl'>
<span class='hljl-nf'>uconvert</span><span class='hljl-p'>(</span><span class='hljl-n'>hr</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>Preal</span><span class='hljl-p'>)</span><span class='hljl-t'>  </span><span class='hljl-cs'># ≈ 11.65 hours</span>
</pre>


<pre class="output">
11.647411659695297 hr
</pre>


<h5>Example Computing <span class="math">$\log(x)$</span></h5>
<p>Where exactly does the value assigned to <span class="math">$\log(5)$</span> come from? The value needs to be computed. At some level, many questions resolve down to the basic operations of addition, subtraction, multiplication, and division. Preferably not the latter, as division is slow. Polynomials then should be fast to compute, and so computing logarithms using a polynomial becomes desirable.</p>
<p>But how? One can see details of a possible way <a href="https://github.com/musm/Amal.jl/blob/master/src/log.jl">here</a>.</p>
<p>First, there is usually a reduction stage. In this phase, the problem is transformed in a manner to one involving only a fixed interval of values. For this function values of <span class="math">$k$</span> and <span class="math">$m$</span> are found so that <span class="math">$x = 2^k \cdot (1+m)$</span> <em>and</em> <span class="math">$\sqrt{2}/2 < 1+m < \sqrt{2}$</span>. If these are found, then <span class="math">$\log(x)$</span> can be computed with <span class="math">$k \cdot \log(2) + \log(1+m)$</span>. The first value–-a multiplication–-can easily be computed using  pre-computed value of <span class="math">$\log(2)$</span>, the second then <em>reduces</em> the problem to an interval.</p>
<p>Now, for this problem a further trick is utilized, writing <span class="math">$s= f/(2+f)$</span> so that <span class="math">$\log(1+m)=\log(1+s)-\log(1-s)$</span>.  <span class="math">$\log(1+s) - \log(1-s)$</span> for some small range of <span class="math">$s$</span> values then makes it possible to compute <span class="math">$\log(x)$</span> for any real <span class="math">$x$</span>.</p>
<p>To compute <span class="math">$\log(1\pm s)$</span>, we can find a Taylor series. Let&#39;s go out to degree <span class="math">$19$</span> and use <code>SymPy</code> to do the work:</p>


<pre class='hljl'>
<span class='hljl-nd'>@vars</span><span class='hljl-t'> </span><span class='hljl-n'>s</span><span class='hljl-t'>
</span><span class='hljl-n'>a</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-nf'>series</span><span class='hljl-p'>(</span><span class='hljl-nf'>log</span><span class='hljl-p'>(</span><span class='hljl-ni'>1</span><span class='hljl-t'> </span><span class='hljl-oB'>+</span><span class='hljl-t'> </span><span class='hljl-n'>s</span><span class='hljl-p'>),</span><span class='hljl-t'> </span><span class='hljl-n'>s</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-ni'>0</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-ni'>19</span><span class='hljl-p'>)</span><span class='hljl-t'>
</span><span class='hljl-n'>b</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-nf'>series</span><span class='hljl-p'>(</span><span class='hljl-nf'>log</span><span class='hljl-p'>(</span><span class='hljl-ni'>1</span><span class='hljl-t'> </span><span class='hljl-oB'>-</span><span class='hljl-t'> </span><span class='hljl-n'>s</span><span class='hljl-p'>),</span><span class='hljl-t'> </span><span class='hljl-n'>s</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-ni'>0</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-ni'>19</span><span class='hljl-p'>)</span><span class='hljl-t'>
</span><span class='hljl-n'>a_b</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-p'>(</span><span class='hljl-n'>a</span><span class='hljl-t'> </span><span class='hljl-oB'>-</span><span class='hljl-t'> </span><span class='hljl-n'>b</span><span class='hljl-p'>)</span><span class='hljl-oB'>.</span><span class='hljl-nf'>removeO</span><span class='hljl-p'>()</span><span class='hljl-t'>  </span><span class='hljl-cs'># remove&quot;Oh&quot; not remove&quot;zero&quot;</span>
</pre>



<div class="well well-sm">\begin{equation*}\frac{2 s^{17}}{17} + \frac{2 s^{15}}{15} + \frac{2 s^{13}}{13} + \frac{2 s^{11}}{11} + \frac{2 s^{9}}{9} + \frac{2 s^{7}}{7} + \frac{2 s^{5}}{5} + \frac{2 s^{3}}{3} + 2 s\end{equation*}</div>

<p>This is re-expressed as <span class="math">$2s + s \cdot p$</span> with <span class="math">$p$</span> given by:</p>


<pre class='hljl'>
<span class='hljl-n'>p</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-nf'>cancel</span><span class='hljl-p'>(</span><span class='hljl-n'>a_b</span><span class='hljl-t'> </span><span class='hljl-oB'>-</span><span class='hljl-t'> </span><span class='hljl-ni'>2</span><span class='hljl-n'>s</span><span class='hljl-oB'>/</span><span class='hljl-n'>s</span><span class='hljl-p'>)</span>
</pre>



<div class="well well-sm">\begin{equation*}\frac{2 s^{17}}{17} + \frac{2 s^{15}}{15} + \frac{2 s^{13}}{13} + \frac{2 s^{11}}{11} + \frac{2 s^{9}}{9} + \frac{2 s^{7}}{7} + \frac{2 s^{5}}{5} + \frac{2 s^{3}}{3} + 2 s - 2\end{equation*}</div>

<p>Now, <span class="math">$2s = m - s\cdot m$</span>, so the above can be reworked to be <span class="math">$\log(1+m) = m - s\cdot(m-p)$</span>.</p>
<p>&#40;For larger values of <span class="math">$m$</span>, a similar, but different approximation, can be used to minimize floating point errors.&#41;</p>
<p>How big can the error be between this <em>approximations</em> and <span class="math">$\log(1+m)$</span>? We plot to see how big <span class="math">$s$</span> can be:</p>


<pre class='hljl'>
<span class='hljl-nd'>@vars</span><span class='hljl-t'> </span><span class='hljl-n'>u</span><span class='hljl-t'>
</span><span class='hljl-nf'>plot</span><span class='hljl-p'>(</span><span class='hljl-n'>u</span><span class='hljl-oB'>/</span><span class='hljl-p'>(</span><span class='hljl-ni'>2</span><span class='hljl-oB'>+</span><span class='hljl-n'>u</span><span class='hljl-p'>),</span><span class='hljl-t'> </span><span class='hljl-nf'>sqrt</span><span class='hljl-p'>(</span><span class='hljl-ni'>2</span><span class='hljl-p'>)</span><span class='hljl-oB'>/</span><span class='hljl-ni'>2</span><span class='hljl-t'> </span><span class='hljl-oB'>-</span><span class='hljl-t'> </span><span class='hljl-ni'>1</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-nf'>sqrt</span><span class='hljl-p'>(</span><span class='hljl-ni'>2</span><span class='hljl-p'>)</span><span class='hljl-oB'>-</span><span class='hljl-ni'>1</span><span class='hljl-p'>)</span>
</pre>



    <div id="69527fa1-06ec-42ef-aac1-01cad1317a3f" style="width:576px;height:384px;"></div>
    <script>
    PLOT = document.getElementById('69527fa1-06ec-42ef-aac1-01cad1317a3f');
    Plotly.plot(PLOT, [
    {
        "xaxis": "x1",
        "colorbar": {
            "title": ""
        },
        "yaxis": "y1",
        "text": [
            null,
            null,
            null,
            null,
            null,
            null,
            null,
            null,
            null,
            null,
            null,
            null,
            null,
            null,
            null,
            null,
            null,
            null,
            null
        ],
        "x": [
            -0.2859877419607197,
            -0.22213663732482583,
            -0.18376478488254616,
            -0.1513218719938084,
            -0.11607977515402637,
            -0.08358967908644614,
            -0.04875686233053828,
            -0.008399628140059378,
            0.027465118968841705,
            0.05891527021372467,
            0.09320437718122408,
            0.12769727372482512,
            0.16583358163937453,
            0.20211931633020133,
            0.23984806125679728,
            0.2716076280934539,
            0.3103824594050011,
            0.3468319444854909,
            0.40522684613582916
        ],
        "showlegend": true,
        "mode": "lines",
        "name": "y1",
        "zmin": -0.1,
        "legendgroup": "y1",
        "zmax": 0.1,
        "line": {
            "color": "rgba(0, 154, 250, 1.000)",
            "shape": "linear",
            "dash": "solid",
            "width": 1
        },
        "y": [
            -0.16685279852541504,
            -0.12494584341429588,
            -0.10117895708274893,
            -0.08185409331207362,
            -0.061616077805798204,
            -0.043617840174539915,
            -0.024987589393279205,
            -0.004217526898840167,
            0.013546530942446162,
            0.0286147133231029,
            0.04452712701983553,
            0.060016655236519424,
            0.07656801660349678,
            0.09178399863774418,
            0.1070822907167268,
            0.11956625991849326,
            0.13434245838454587,
            0.14778729482546257,
            0.16847759985169605
        ],
        "type": "scatter",
        "hoverinfo": "text"
    }
]
, {
    "showlegend": true,
    "xaxis": {
        "showticklabels": true,
        "gridwidth": 0.5,
        "tickvals": [
            -0.2,
            0.0,
            0.2,
            0.4
        ],
        "visible": true,
        "ticks": "inside",
        "range": [
            -0.30672417960361614,
            0.4259632837787256
        ],
        "domain": [
            0.08399557694177116,
            0.9931649168853893
        ],
        "tickmode": "array",
        "linecolor": "rgba(0, 0, 0, 1.000)",
        "showgrid": true,
        "title": "",
        "mirror": false,
        "tickangle": 0,
        "showline": true,
        "gridcolor": "rgba(0, 0, 0, 0.100)",
        "titlefont": {
            "color": "rgba(0, 0, 0, 1.000)",
            "family": "sans-serif",
            "size": 15
        },
        "tickcolor": "rgb(0, 0, 0)",
        "ticktext": [
            "-0.2",
            "0.0",
            "0.2",
            "0.4"
        ],
        "zeroline": false,
        "type": "-",
        "tickfont": {
            "color": "rgba(0, 0, 0, 1.000)",
            "family": "sans-serif",
            "size": 11
        },
        "zerolinecolor": "rgba(0, 0, 0, 1.000)",
        "anchor": "y1"
    },
    "paper_bgcolor": "rgba(255, 255, 255, 1.000)",
    "annotations": [],
    "height": 384,
    "margin": {
        "l": 0,
        "b": 20,
        "r": 0,
        "t": 20
    },
    "plot_bgcolor": "rgba(255, 255, 255, 1.000)",
    "yaxis": {
        "showticklabels": true,
        "gridwidth": 0.5,
        "tickvals": [
            -0.15000000000000002,
            -0.1,
            -0.05,
            0.0,
            0.05,
            0.1,
            0.15000000000000002
        ],
        "visible": true,
        "ticks": "inside",
        "range": [
            -0.17691271047672838,
            0.1785375118030094
        ],
        "domain": [
            0.0391878098571012,
            0.989747375328084
        ],
        "tickmode": "array",
        "linecolor": "rgba(0, 0, 0, 1.000)",
        "showgrid": true,
        "title": "",
        "mirror": false,
        "tickangle": 0,
        "showline": true,
        "gridcolor": "rgba(0, 0, 0, 0.100)",
        "titlefont": {
            "color": "rgba(0, 0, 0, 1.000)",
            "family": "sans-serif",
            "size": 15
        },
        "tickcolor": "rgb(0, 0, 0)",
        "ticktext": [
            "-0.15",
            "-0.10",
            "-0.05",
            "0.00",
            "0.05",
            "0.10",
            "0.15"
        ],
        "zeroline": false,
        "type": "-",
        "tickfont": {
            "color": "rgba(0, 0, 0, 1.000)",
            "family": "sans-serif",
            "size": 11
        },
        "zerolinecolor": "rgba(0, 0, 0, 1.000)",
        "anchor": "x1"
    },
    "legend": {
        "tracegroupgap": 0,
        "bordercolor": "rgba(0, 0, 0, 1.000)",
        "bgcolor": "rgba(255, 255, 255, 1.000)",
        "font": {
            "color": "rgba(0, 0, 0, 1.000)",
            "family": "sans-serif",
            "size": 11
        },
        "y": 1.0,
        "x": 1.0
    },
    "width": 576
}
);
    </script>


<p>This shows, <span class="math">$s$</span> is as big as</p>


<pre class='hljl'>
<span class='hljl-n'>M</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-p'>(</span><span class='hljl-n'>u</span><span class='hljl-oB'>/</span><span class='hljl-p'>(</span><span class='hljl-ni'>2</span><span class='hljl-oB'>+</span><span class='hljl-n'>u</span><span class='hljl-p'>))(</span><span class='hljl-n'>u</span><span class='hljl-t'> </span><span class='hljl-oB'>=&gt;</span><span class='hljl-t'> </span><span class='hljl-nf'>sqrt</span><span class='hljl-p'>(</span><span class='hljl-ni'>2</span><span class='hljl-p'>)</span><span class='hljl-t'> </span><span class='hljl-oB'>-</span><span class='hljl-t'> </span><span class='hljl-ni'>1</span><span class='hljl-p'>)</span>
</pre>



<div class="well well-sm">\begin{equation*}0.17157287525381\end{equation*}</div>

<p>The error term is like <span class="math">$2/19 \cdot \xi^{19}$</span> which  is largest at this value of <span class="math">$M$</span>. Large is relative–it is really small:</p>


<pre class='hljl'>
<span class='hljl-p'>(</span><span class='hljl-ni'>2</span><span class='hljl-oB'>/</span><span class='hljl-ni'>19</span><span class='hljl-p'>)</span><span class='hljl-oB'>*</span><span class='hljl-n'>M</span><span class='hljl-oB'>^</span><span class='hljl-ni'>19</span>
</pre>



<div class="well well-sm">\begin{equation*}2.99778410043418 \cdot 10^{-16}\end{equation*}</div>

<p>Basically that is machine precision. Which means, that as far as can be told on the computer, the value produced by <span class="math">$2s + s \cdot p$</span> is as accurate as can be done.</p>
<p>To try this out to compute <span class="math">$\log(5)$</span>. We have <span class="math">$5 = 2^2(1+0.25)$</span>, so <span class="math">$k=2$</span> and <span class="math">$m=0.25$</span>.</p>


<pre class='hljl'>
<span class='hljl-n'>k</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>m</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-ni'>2</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-nfB'>0.25</span><span class='hljl-t'>
</span><span class='hljl-n'>s</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-n'>m</span><span class='hljl-t'> </span><span class='hljl-oB'>/</span><span class='hljl-t'> </span><span class='hljl-p'>(</span><span class='hljl-ni'>2</span><span class='hljl-oB'>+</span><span class='hljl-n'>m</span><span class='hljl-p'>)</span><span class='hljl-t'>
</span><span class='hljl-n'>p</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-ni'>2</span><span class='hljl-t'> </span><span class='hljl-oB'>*</span><span class='hljl-t'> </span><span class='hljl-nf'>sum</span><span class='hljl-p'>(</span><span class='hljl-n'>s</span><span class='hljl-oB'>^</span><span class='hljl-p'>(</span><span class='hljl-ni'>2</span><span class='hljl-n'>i</span><span class='hljl-p'>)</span><span class='hljl-oB'>/</span><span class='hljl-p'>(</span><span class='hljl-ni'>2</span><span class='hljl-n'>i</span><span class='hljl-oB'>+</span><span class='hljl-ni'>1</span><span class='hljl-p'>)</span><span class='hljl-t'> </span><span class='hljl-k'>for</span><span class='hljl-t'> </span><span class='hljl-n'>i</span><span class='hljl-t'> </span><span class='hljl-kp'>in</span><span class='hljl-t'> </span><span class='hljl-ni'>1</span><span class='hljl-oB'>:</span><span class='hljl-ni'>8</span><span class='hljl-p'>)</span><span class='hljl-t'>  </span><span class='hljl-cs'># where the polynomial approximates the logarithm...</span><span class='hljl-t'>

</span><span class='hljl-nf'>log</span><span class='hljl-p'>(</span><span class='hljl-ni'>1</span><span class='hljl-t'> </span><span class='hljl-oB'>+</span><span class='hljl-t'> </span><span class='hljl-n'>m</span><span class='hljl-p'>),</span><span class='hljl-t'> </span><span class='hljl-n'>m</span><span class='hljl-t'> </span><span class='hljl-oB'>-</span><span class='hljl-t'> </span><span class='hljl-n'>s</span><span class='hljl-oB'>*</span><span class='hljl-p'>(</span><span class='hljl-n'>m</span><span class='hljl-oB'>-</span><span class='hljl-n'>p</span><span class='hljl-p'>),</span><span class='hljl-t'> </span><span class='hljl-nf'>log</span><span class='hljl-p'>(</span><span class='hljl-ni'>1</span><span class='hljl-t'> </span><span class='hljl-oB'>+</span><span class='hljl-t'> </span><span class='hljl-n'>m</span><span class='hljl-p'>)</span><span class='hljl-t'> </span><span class='hljl-oB'>-</span><span class='hljl-t'> </span><span class='hljl-p'>(</span><span class='hljl-t'> </span><span class='hljl-n'>m</span><span class='hljl-t'> </span><span class='hljl-oB'>-</span><span class='hljl-t'> </span><span class='hljl-n'>s</span><span class='hljl-oB'>*</span><span class='hljl-p'>(</span><span class='hljl-n'>m</span><span class='hljl-oB'>-</span><span class='hljl-n'>p</span><span class='hljl-p'>))</span>
</pre>


<pre class="output">
&#40;0.22314355131420976, 0.22314355131420976, 0.0&#41;
</pre>


<p>The two values differ by less than <span class="math">$10^{-16}$</span> as advertised. Re-assembling then, we compare the computed values:</p>


<pre class='hljl'>
<span class='hljl-n'>k</span><span class='hljl-t'> </span><span class='hljl-oB'>*</span><span class='hljl-t'> </span><span class='hljl-nf'>log</span><span class='hljl-p'>(</span><span class='hljl-ni'>2</span><span class='hljl-p'>)</span><span class='hljl-t'> </span><span class='hljl-oB'>+</span><span class='hljl-t'> </span><span class='hljl-p'>(</span><span class='hljl-n'>m</span><span class='hljl-t'> </span><span class='hljl-oB'>-</span><span class='hljl-t'> </span><span class='hljl-n'>s</span><span class='hljl-oB'>*</span><span class='hljl-p'>(</span><span class='hljl-n'>m</span><span class='hljl-oB'>-</span><span class='hljl-n'>p</span><span class='hljl-p'>)),</span><span class='hljl-t'> </span><span class='hljl-nf'>log</span><span class='hljl-p'>(</span><span class='hljl-ni'>5</span><span class='hljl-p'>)</span>
</pre>


<pre class="output">
&#40;1.6094379124341003, 1.6094379124341003&#41;
</pre>


<p>The actual  code is different, as the Taylor polynomial isn&#39;t used. The Taylor polynomial is a great approximation near a point, but there might be better approximations for all values in an interval. In this case there is, and that is used in the production setting. This makes things a bit more efficient, but the basic idea remains–-for a prescribed accuracy, a polynomial approximation can be found over a given interval, which can be cleverly utilized to solve for all applicable values.</p>
<h2>Questions</h2>
<h6>Question</h6>
<p>Compute the Taylor polynomial  of degree 10 for <span class="math">$\sin(x)$</span> about <span class="math">$c=0$</span> using <code>SymPy</code>. Based on the form, which formula seems appropriate:</p>


<form name="WeaveQuestion" data-id="GZIEs7Xa" data-controltype="radio">
<div class="form-group ">
    <div  class="radio">
    <label>
      <input type="radio" name="radio_GZIEs7Xa" value="1"><div class="markdown">&#36;\sum_&#123;k&#61;1&#125;^&#123;10&#125; &#40;-1&#41;^&#123;n&#43;1&#125; x^n/n&#36;
</div>
    </label>
    </div>
    <div  class="radio">
    <label>
      <input type="radio" name="radio_GZIEs7Xa" value="2"><div class="markdown">&#36;\sum_&#123;k&#61;0&#125;^&#123;4&#125; &#40;-1&#41;^k/&#40;2k&#43;1&#41;&#33; \cdot x^&#123;2k&#43;1&#125;&#36;
</div>
    </label>
    </div>
    <div  class="radio">
    <label>
      <input type="radio" name="radio_GZIEs7Xa" value="3"><div class="markdown">&#36;\sum_&#123;k&#61;0&#125;^&#123;10&#125; x^n/n&#33;&#36;
</div>
    </label>
    </div>
    <div  class="radio">
    <label>
      <input type="radio" name="radio_GZIEs7Xa" value="4"><div class="markdown">&#36;\sum_&#123;k&#61;0&#125;^&#123;10&#125; x^k&#36;
</div>
    </label>
    </div>

<div id="GZIEs7Xa_message"></div>
</div>
</form>
<script text="text/javascript">
$("input:radio[name='radio_GZIEs7Xa']").on("change", function() {
  correct = this.value == 2;

  if(correct) {
     $("#GZIEs7Xa_message").html("<div class='alert alert-success'><span class='glyphicon glyphicon-thumbs-up'>&nbsp;Correct</span></div>");
  } else {
     $("#GZIEs7Xa_message").html("<div class='alert alert-warning'><span class='glyphicon glyphicon-thumbs-down'>&nbsp;Incorrect</span></div>");
  }
});

</script>


<h6>Question</h6>
<p>Compute the Taylor polynomial  of degree 10 for <span class="math">$e^x$</span> about <span class="math">$c=0$</span> using <code>SymPy</code>. Based on the form, which formula seems appropriate:</p>


<form name="WeaveQuestion" data-id="plBTwd6Q" data-controltype="radio">
<div class="form-group ">
    <div  class="radio">
    <label>
      <input type="radio" name="radio_plBTwd6Q" value="1"><div class="markdown">&#36;\sum_&#123;k&#61;0&#125;^&#123;4&#125; &#40;-1&#41;^k/&#40;2k&#43;1&#41;&#33; \cdot x^&#123;2k&#43;1&#125;&#36;
</div>
    </label>
    </div>
    <div  class="radio">
    <label>
      <input type="radio" name="radio_plBTwd6Q" value="2"><div class="markdown">&#36;\sum_&#123;k&#61;1&#125;^&#123;10&#125; &#40;-1&#41;^&#123;n&#43;1&#125; x^n/n&#36;
</div>
    </label>
    </div>
    <div  class="radio">
    <label>
      <input type="radio" name="radio_plBTwd6Q" value="3"><div class="markdown">&#36;\sum_&#123;k&#61;0&#125;^&#123;10&#125; x^n/n&#33;&#36;
</div>
    </label>
    </div>
    <div  class="radio">
    <label>
      <input type="radio" name="radio_plBTwd6Q" value="4"><div class="markdown">&#36;\sum_&#123;k&#61;0&#125;^&#123;10&#125; x^k&#36;
</div>
    </label>
    </div>

<div id="plBTwd6Q_message"></div>
</div>
</form>
<script text="text/javascript">
$("input:radio[name='radio_plBTwd6Q']").on("change", function() {
  correct = this.value == 3;

  if(correct) {
     $("#plBTwd6Q_message").html("<div class='alert alert-success'><span class='glyphicon glyphicon-thumbs-up'>&nbsp;Correct</span></div>");
  } else {
     $("#plBTwd6Q_message").html("<div class='alert alert-warning'><span class='glyphicon glyphicon-thumbs-down'>&nbsp;Incorrect</span></div>");
  }
});

</script>


<h6>Question</h6>
<p>Compute the Taylor polynomial  of degree 10 for <span class="math">$1/(1-x)$</span> about <span class="math">$c=0$</span> using <code>SymPy</code>. Based on the form, which formula seems appropriate:</p>


<form name="WeaveQuestion" data-id="pdJKbqxK" data-controltype="radio">
<div class="form-group ">
    <div  class="radio">
    <label>
      <input type="radio" name="radio_pdJKbqxK" value="1"><div class="markdown">&#36;\sum_&#123;k&#61;0&#125;^&#123;4&#125; &#40;-1&#41;^k/&#40;2k&#43;1&#41;&#33; \cdot x^&#123;2k&#43;1&#125;&#36;
</div>
    </label>
    </div>
    <div  class="radio">
    <label>
      <input type="radio" name="radio_pdJKbqxK" value="2"><div class="markdown">&#36;\sum_&#123;k&#61;1&#125;^&#123;10&#125; &#40;-1&#41;^&#123;n&#43;1&#125; x^n/n&#36;
</div>
    </label>
    </div>
    <div  class="radio">
    <label>
      <input type="radio" name="radio_pdJKbqxK" value="3"><div class="markdown">&#36;\sum_&#123;k&#61;0&#125;^&#123;10&#125; x^n/n&#33;&#36;
</div>
    </label>
    </div>
    <div  class="radio">
    <label>
      <input type="radio" name="radio_pdJKbqxK" value="4"><div class="markdown">&#36;\sum_&#123;k&#61;0&#125;^&#123;10&#125; x^k&#36;
</div>
    </label>
    </div>

<div id="pdJKbqxK_message"></div>
</div>
</form>
<script text="text/javascript">
$("input:radio[name='radio_pdJKbqxK']").on("change", function() {
  correct = this.value == 4;

  if(correct) {
     $("#pdJKbqxK_message").html("<div class='alert alert-success'><span class='glyphicon glyphicon-thumbs-up'>&nbsp;Correct</span></div>");
  } else {
     $("#pdJKbqxK_message").html("<div class='alert alert-warning'><span class='glyphicon glyphicon-thumbs-down'>&nbsp;Incorrect</span></div>");
  }
});

</script>


<h6>Question</h6>
<p>Let <span class="math">$T_5(x)$</span> be the Taylor polynomial of degree 5 for the function <span class="math">$\sqrt{1+x}$</span> about <span class="math">$x=0$</span>. What is the coefficient of the <span class="math">$x^5$</span> term?</p>


<form name="WeaveQuestion" data-id="fC92dNO6" data-controltype="radio">
<div class="form-group ">
    <div  class="radio">
    <label>
      <input type="radio" name="radio_fC92dNO6" value="1"><div class="markdown">&#36;2/15&#36;
</div>
    </label>
    </div>
    <div  class="radio">
    <label>
      <input type="radio" name="radio_fC92dNO6" value="2"><div class="markdown">&#36;1/5&#33;&#36;
</div>
    </label>
    </div>
    <div  class="radio">
    <label>
      <input type="radio" name="radio_fC92dNO6" value="3"><div class="markdown">&#36;-5/128&#36;
</div>
    </label>
    </div>
    <div  class="radio">
    <label>
      <input type="radio" name="radio_fC92dNO6" value="4"><div class="markdown">&#36;7/256&#36;
</div>
    </label>
    </div>

<div id="fC92dNO6_message"></div>
</div>
</form>
<script text="text/javascript">
$("input:radio[name='radio_fC92dNO6']").on("change", function() {
  correct = this.value == 4;

  if(correct) {
     $("#fC92dNO6_message").html("<div class='alert alert-success'><span class='glyphicon glyphicon-thumbs-up'>&nbsp;Correct</span></div>");
  } else {
     $("#fC92dNO6_message").html("<div class='alert alert-warning'><span class='glyphicon glyphicon-thumbs-down'>&nbsp;Incorrect</span></div>");
  }
});

</script>


<h6>Question</h6>
<p>The 5th order Taylor polynomial for <span class="math">$\sin(x)$</span> about <span class="math">$c=0$</span> is: <span class="math">$x - x^3/3! + x^5/5!$</span>. Use this to find the first 3 terms of the Taylor polynomial of <span class="math">$\sin(x^2)$</span> about <span class="math">$c=0$</span>.</p>
<p>They are:</p>


<form name="WeaveQuestion" data-id="3jAxae4O" data-controltype="radio">
<div class="form-group ">
    <div  class="radio">
    <label>
      <input type="radio" name="radio_3jAxae4O" value="1"><div class="markdown">&#36;x^2&#36;
</div>
    </label>
    </div>
    <div  class="radio">
    <label>
      <input type="radio" name="radio_3jAxae4O" value="2"><div class="markdown">&#36;x^2 \cdot &#40;x - x^3/3&#33; &#43; x^5/5&#33;&#41;&#36;
</div>
    </label>
    </div>
    <div  class="radio">
    <label>
      <input type="radio" name="radio_3jAxae4O" value="3"><div class="markdown">&#36;x^2 - x^6/3&#33; &#43; x^&#123;10&#125;/5&#33;&#36;
</div>
    </label>
    </div>

<div id="3jAxae4O_message"></div>
</div>
</form>
<script text="text/javascript">
$("input:radio[name='radio_3jAxae4O']").on("change", function() {
  correct = this.value == 3;

  if(correct) {
     $("#3jAxae4O_message").html("<div class='alert alert-success'><span class='glyphicon glyphicon-thumbs-up'>&nbsp;Correct</span></div>");
  } else {
     $("#3jAxae4O_message").html("<div class='alert alert-warning'><span class='glyphicon glyphicon-thumbs-down'>&nbsp;Incorrect</span></div>");
  }
});

</script>


<h6>Question</h6>
<p>A more direct derivation of the form of the Taylor polynomial &#40;here taken about <span class="math">$c=0$</span>&#41; is to <em>assume</em> a polynomial form that matches <span class="math">$f$</span>:</p>
<p class="math">\[
~
f(x) = a + bx + cx^2 + dx^3 + ex^4 + \cdots
~
\]</p>
<p>If this is true, then formally evaluating at <span class="math">$x=0$</span> gives <span class="math">$f(0) = a$</span>, so <span class="math">$a$</span> is determined. Similarly, formally differentiating and evaluating at <span class="math">$0$</span> gives <span class="math">$f'(0) = b$</span>. What is the result of formally differentiating <span class="math">$4$</span> times and evaluating at <span class="math">$0$</span>:</p>


<form name="WeaveQuestion" data-id="QMuqHdnI" data-controltype="radio">
<div class="form-group ">
    <div  class="radio">
    <label>
      <input type="radio" name="radio_QMuqHdnI" value="1"><div class="markdown">&#36;f&#39;&#39;&#39;&#39;&#40;0&#41; &#61; e&#36;
</div>
    </label>
    </div>
    <div  class="radio">
    <label>
      <input type="radio" name="radio_QMuqHdnI" value="2"><div class="markdown">&#36;f&#39;&#39;&#39;&#39;&#40;0&#41; &#61; 0&#36;
</div>
    </label>
    </div>
    <div  class="radio">
    <label>
      <input type="radio" name="radio_QMuqHdnI" value="3"><div class="markdown">&#36;f&#39;&#39;&#39;&#39;&#40;0&#41; &#61; 4\cdot 3\cdot2 e&#36;
</div>
    </label>
    </div>

<div id="QMuqHdnI_message"></div>
</div>
</form>
<script text="text/javascript">
$("input:radio[name='radio_QMuqHdnI']").on("change", function() {
  correct = this.value == 3;

  if(correct) {
     $("#QMuqHdnI_message").html("<div class='alert alert-success'><span class='glyphicon glyphicon-thumbs-up'>&nbsp;Correct</span></div>");
  } else {
     $("#QMuqHdnI_message").html("<div class='alert alert-warning'><span class='glyphicon glyphicon-thumbs-down'>&nbsp;Incorrect</span></div>");
  }
});

</script>


<h6>Question</h6>
<p>How big an error is there in approximating <span class="math">$e^x$</span> by its 5th degree Taylor polynomial about <span class="math">$c=0$</span>, <span class="math">$1 + x + x^2/2! + x^3/3! + x^4/4! + x^5/5!$</span>?, over <span class="math">$[-1,1]$</span>.</p>
<p>The error is known to be <span class="math">$(  f^{(6)}(\xi)/6!) \cdot x^6$</span> for some <span class="math">$\xi$</span> in <span class="math">$[-1,1]$</span>.</p>
<ul>
<li><p>The 6th derivative of <span class="math">$e^x$</span> is still <span class="math">$e^x$</span>:</p>
</li>
</ul>


<form name="WeaveQuestion" data-id="0OqzXrT4" data-controltype="radio">
<div class="form-group ">
    <div  class="radio">
    <label>
      <input type="radio" name="radio_0OqzXrT4" value="1"><div class="markdown"><p>Yes</p>
</div>
    </label>
    </div>
    <div  class="radio">
    <label>
      <input type="radio" name="radio_0OqzXrT4" value="2"><div class="markdown"><p>No</p>
</div>
    </label>
    </div>

<div id="0OqzXrT4_message"></div>
</div>
</form>
<script text="text/javascript">
$("input:radio[name='radio_0OqzXrT4']").on("change", function() {
  correct = this.value == 1;

  if(correct) {
     $("#0OqzXrT4_message").html("<div class='alert alert-success'><span class='glyphicon glyphicon-thumbs-up'>&nbsp;Correct</span></div>");
  } else {
     $("#0OqzXrT4_message").html("<div class='alert alert-warning'><span class='glyphicon glyphicon-thumbs-down'>&nbsp;Incorrect</span></div>");
  }
});

</script>


<ul>
<li><p>Which is true about the function <span class="math">$e^x$</span>:</p>
</li>
</ul>


<form name="WeaveQuestion" data-id="ViznwVfD" data-controltype="radio">
<div class="form-group ">
    <div  class="radio">
    <label>
      <input type="radio" name="radio_ViznwVfD" value="1"><div class="markdown"><p>It is decreasing</p>
</div>
    </label>
    </div>
    <div  class="radio">
    <label>
      <input type="radio" name="radio_ViznwVfD" value="2"><div class="markdown"><p>It is increasing</p>
</div>
    </label>
    </div>
    <div  class="radio">
    <label>
      <input type="radio" name="radio_ViznwVfD" value="3"><div class="markdown"><p>It both increases and decreases</p>
</div>
    </label>
    </div>

<div id="ViznwVfD_message"></div>
</div>
</form>
<script text="text/javascript">
$("input:radio[name='radio_ViznwVfD']").on("change", function() {
  correct = this.value == 2;

  if(correct) {
     $("#ViznwVfD_message").html("<div class='alert alert-success'><span class='glyphicon glyphicon-thumbs-up'>&nbsp;Correct</span></div>");
  } else {
     $("#ViznwVfD_message").html("<div class='alert alert-warning'><span class='glyphicon glyphicon-thumbs-down'>&nbsp;Incorrect</span></div>");
  }
});

</script>


<ul>
<li><p>The maximum value of <span class="math">$e^x$</span> over <span class="math">$[-1,1]$</span> occurs at</p>
</li>
</ul>


<form name="WeaveQuestion" data-id="8QeT6poF" data-controltype="radio">
<div class="form-group ">
    <div  class="radio">
    <label>
      <input type="radio" name="radio_8QeT6poF" value="1"><div class="markdown"><p>A critical point</p>
</div>
    </label>
    </div>
    <div  class="radio">
    <label>
      <input type="radio" name="radio_8QeT6poF" value="2"><div class="markdown"><p>An end point</p>
</div>
    </label>
    </div>

<div id="8QeT6poF_message"></div>
</div>
</form>
<script text="text/javascript">
$("input:radio[name='radio_8QeT6poF']").on("change", function() {
  correct = this.value == 2;

  if(correct) {
     $("#8QeT6poF_message").html("<div class='alert alert-success'><span class='glyphicon glyphicon-thumbs-up'>&nbsp;Correct</span></div>");
  } else {
     $("#8QeT6poF_message").html("<div class='alert alert-warning'><span class='glyphicon glyphicon-thumbs-down'>&nbsp;Incorrect</span></div>");
  }
});

</script>


<ul>
<li><p>Which theorem tells you that for a <em>continuous</em> function over  <em>closed</em> interval, a maximum value will exist?</p>
</li>
</ul>


<form name="WeaveQuestion" data-id="prl0p1AF" data-controltype="radio">
<div class="form-group ">
    <div  class="radio">
    <label>
      <input type="radio" name="radio_prl0p1AF" value="1"><div class="markdown"><p>The mean value theorem</p>
</div>
    </label>
    </div>
    <div  class="radio">
    <label>
      <input type="radio" name="radio_prl0p1AF" value="2"><div class="markdown"><p>The extreme value theorem</p>
</div>
    </label>
    </div>
    <div  class="radio">
    <label>
      <input type="radio" name="radio_prl0p1AF" value="3"><div class="markdown"><p>The intermediate value theorem</p>
</div>
    </label>
    </div>

<div id="prl0p1AF_message"></div>
</div>
</form>
<script text="text/javascript">
$("input:radio[name='radio_prl0p1AF']").on("change", function() {
  correct = this.value == 2;

  if(correct) {
     $("#prl0p1AF_message").html("<div class='alert alert-success'><span class='glyphicon glyphicon-thumbs-up'>&nbsp;Correct</span></div>");
  } else {
     $("#prl0p1AF_message").html("<div class='alert alert-warning'><span class='glyphicon glyphicon-thumbs-down'>&nbsp;Incorrect</span></div>");
  }
});

</script>


<ul>
<li><p>What is the <em>largest</em> possible value of the error:</p>
</li>
</ul>


<form name="WeaveQuestion" data-id="tEa29wpK" data-controltype="radio">
<div class="form-group ">
    <div  class="radio">
    <label>
      <input type="radio" name="radio_tEa29wpK" value="1"><div class="markdown">&#36;1^6 \cdot 1 \cdot 1^6&#36;
</div>
    </label>
    </div>
    <div  class="radio">
    <label>
      <input type="radio" name="radio_tEa29wpK" value="2"><div class="markdown">&#36;1/6&#33;\cdot e^1 \cdot 1^6&#36;
</div>
    </label>
    </div>

<div id="tEa29wpK_message"></div>
</div>
</form>
<script text="text/javascript">
$("input:radio[name='radio_tEa29wpK']").on("change", function() {
  correct = this.value == 2;

  if(correct) {
     $("#tEa29wpK_message").html("<div class='alert alert-success'><span class='glyphicon glyphicon-thumbs-up'>&nbsp;Correct</span></div>");
  } else {
     $("#tEa29wpK_message").html("<div class='alert alert-warning'><span class='glyphicon glyphicon-thumbs-down'>&nbsp;Incorrect</span></div>");
  }
});

</script>


<h6>Question</h6>
<p>The error in using <span class="math">$T_k(x)$</span> to approximate <span class="math">$e^x$</span> over the interval <span class="math">$[-1/2, 1/2]$</span> is <span class="math">$(1/(k+1)!) e^\xi x^{k+1}$</span>, for some <span class="math">$\xi$</span> in the interval. This is <em>less</em> than <span class="math">$1/((k+1)!) e^{1/2} (1/2)^{k+1}$</span>.</p>
<ul>
<li><p>Why?</p>
</li>
</ul>


<form name="WeaveQuestion" data-id="f9kahzpU" data-controltype="radio">
<div class="form-group ">
    <div  class="radio">
    <label>
      <input type="radio" name="radio_f9kahzpU" value="1"><div class="markdown"><p>The function &#36;e^x&#36; is increasing, so takes on its largest value at the endpoint and the function &#36;|x^n| \leq |x|^n \leq &#40;1/2&#41;^n&#36;</p>
</div>
    </label>
    </div>
    <div  class="radio">
    <label>
      <input type="radio" name="radio_f9kahzpU" value="2"><div class="markdown"><p>The function is monotonic in &#36;k&#36;, so achieves its maximum at &#36;k&#43;1&#36;</p>
</div>
    </label>
    </div>
    <div  class="radio">
    <label>
      <input type="radio" name="radio_f9kahzpU" value="3"><div class="markdown"><p>The function has a critical point at &#36;x&#61;1/2&#36;</p>
</div>
    </label>
    </div>

<div id="f9kahzpU_message"></div>
</div>
</form>
<script text="text/javascript">
$("input:radio[name='radio_f9kahzpU']").on("change", function() {
  correct = this.value == 1;

  if(correct) {
     $("#f9kahzpU_message").html("<div class='alert alert-success'><span class='glyphicon glyphicon-thumbs-up'>&nbsp;Correct</span></div>");
  } else {
     $("#f9kahzpU_message").html("<div class='alert alert-warning'><span class='glyphicon glyphicon-thumbs-down'>&nbsp;Incorrect</span></div>");
  }
});

</script>


<p>Assuming the above is right, find the smallest value <span class="math">$k$</span> guaranteeing a error no more than <span class="math">$10^{-16}$</span>.</p>


<form name='WeaveQuestion' data-id='kZ7mQvoc' data-controltype='numeric'>
<div class='form-group '>
<div class='controls'>


<div class="input-group">
<input id="kZ7mQvoc" type="number" class="form-control">

</div>

<div id='kZ7mQvoc_message'></div>
</div>
</div>
</form>
<script text='text/javascript'>
$('#kZ7mQvoc').on('change', function() {
  correct = Math.abs(this.value - 14) <= 0;

  if(correct) {
     $('#kZ7mQvoc_message').html('<div class="alert alert-success"><span class="glyphicon glyphicon-thumbs-up">&nbsp;Correct</span></div>');
  } else {
     $('#kZ7mQvoc_message').html('<div class="alert alert-danger"><span class="glyphicon glyphicon-thumbs-down">&nbsp;Incorrect</span></div>');
  }
});
</script>


<ul>
<li><p>The function <span class="math">$f(x) = (1 - x + x^2) \cdot e^x$</span> has a Taylor polynomial about 0 such that all coefficients are rational numbers. Is it true that the numerators are all either 1 or prime? &#40;From the 2014 <a href="http://kskedlaya.org/putnam-archive/2014.pdf">Putnam</a> exam.&#41;</p>
</li>
</ul>
<p>Here is one way to get all the values bigger than 1:</p>


<pre class='hljl'>
<span class='hljl-nd'>@vars</span><span class='hljl-t'> </span><span class='hljl-n'>x</span><span class='hljl-t'>
</span><span class='hljl-n'>ex</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-p'>(</span><span class='hljl-ni'>1</span><span class='hljl-t'> </span><span class='hljl-oB'>-</span><span class='hljl-t'> </span><span class='hljl-n'>x</span><span class='hljl-t'> </span><span class='hljl-oB'>+</span><span class='hljl-t'> </span><span class='hljl-n'>x</span><span class='hljl-oB'>^</span><span class='hljl-ni'>2</span><span class='hljl-p'>)</span><span class='hljl-oB'>*</span><span class='hljl-nf'>exp</span><span class='hljl-p'>(</span><span class='hljl-n'>x</span><span class='hljl-p'>)</span><span class='hljl-t'>
</span><span class='hljl-n'>Tn</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-nf'>series</span><span class='hljl-p'>(</span><span class='hljl-n'>ex</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>x</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-ni'>0</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-ni'>100</span><span class='hljl-p'>)</span><span class='hljl-oB'>.</span><span class='hljl-nf'>removeO</span><span class='hljl-p'>()</span><span class='hljl-t'>
</span><span class='hljl-n'>ps</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-n'>sympy</span><span class='hljl-oB'>.</span><span class='hljl-nf'>Poly</span><span class='hljl-p'>(</span><span class='hljl-n'>Tn</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>x</span><span class='hljl-p'>)</span><span class='hljl-oB'>.</span><span class='hljl-nf'>coeffs</span><span class='hljl-p'>()</span><span class='hljl-t'>
</span><span class='hljl-n'>qs</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-n'>numer</span><span class='hljl-oB'>.</span><span class='hljl-p'>(</span><span class='hljl-n'>ps</span><span class='hljl-p'>)</span><span class='hljl-t'>
</span><span class='hljl-n'>qs</span><span class='hljl-p'>[</span><span class='hljl-n'>qs</span><span class='hljl-t'> </span><span class='hljl-oB'>.&gt;</span><span class='hljl-t'> </span><span class='hljl-ni'>1</span><span class='hljl-p'>]</span><span class='hljl-t'>  </span><span class='hljl-oB'>|&gt;</span><span class='hljl-t'> </span><span class='hljl-n'>Tuple</span><span class='hljl-t'> </span><span class='hljl-cs'># format better for output</span>
</pre>


<pre class="output">
&#40;97, 89, 83, 79, 73, 71, 67, 61, 59, 53, 47, 43, 41, 37, 31, 29, 23, 19, 17, 13, 11, 7, 5, 2, 3, 2&#41;
</pre>


<p>Verify by hand that each of the remaining values is a prime number to answer the question &#40;Or you can use <code>sympy.isprime.&#40;qs&#41;</code>&#41;.</p>
<p>Are they all prime or <span class="math">$1$</span>?</p>


<form name="WeaveQuestion" data-id="iPLbkoz9" data-controltype="radio">
<div class="form-group ">
    <div  class="radio">
    <label>
      <input type="radio" name="radio_iPLbkoz9" value="1"><div class="markdown"><p>Yes</p>
</div>
    </label>
    </div>
    <div  class="radio">
    <label>
      <input type="radio" name="radio_iPLbkoz9" value="2"><div class="markdown"><p>No</p>
</div>
    </label>
    </div>

<div id="iPLbkoz9_message"></div>
</div>
</form>
<script text="text/javascript">
$("input:radio[name='radio_iPLbkoz9']").on("change", function() {
  correct = this.value == 1;

  if(correct) {
     $("#iPLbkoz9_message").html("<div class='alert alert-success'><span class='glyphicon glyphicon-thumbs-up'>&nbsp;Correct</span></div>");
  } else {
     $("#iPLbkoz9_message").html("<div class='alert alert-warning'><span class='glyphicon glyphicon-thumbs-down'>&nbsp;Incorrect</span></div>");
  }
});

</script>


<h2>Appendix</h2>
<p>We mentioned two facts that could use a proof: the Newton form of the interpolating polynomial and the mean value theorem for divided differences. Our explanation tries to emphasize a parallel with the secant line&#39;s relationship with the tangent line. The standard way to discuss the Taylor polynomial is different and so these two proofs are not in most calculus texts.</p>
<p>A <a href="https://www.math.uh.edu/~jingqiu/math4364/interpolation.pdf">proof</a> of the Newton form can be done knowing that the interpolating polynomial is unique and can be expressed either as <span class="math">$g(x)=a_0 + a_1 (x-x_0) + \cdots + a_n (x-x_0)\cdot\cdots\cdot(x-x_{n-1})$</span> <em>or</em> in this reversed form <span class="math">$h(x)=b_0 + b_1 (x-x_n) + b_2(x-x_n)(x-x_{n-1}) + \cdots + b_n (x-x_n)(x-x_{n-1})\cdot\cdots\cdot(x-x_1)$</span>. These two polynomials are of degree <span class="math">$n$</span> at most and have <span class="math">$u(x) = h(x)-g(x)=0$</span>, by uniqueness. So the coefficients of <span class="math">$u(x)$</span> are <span class="math">$0$</span>. We have that the coefficient of <span class="math">$x^n$</span> must be <span class="math">$a_n-b_n$</span> so <span class="math">$a_n=b_n$</span>. Our goal is to express <span class="math">$a_n$</span> in terms of <span class="math">$a_{n-1}$</span> and <span class="math">$b_{n-1}$</span>. Focusing on the <span class="math">$x^{n-1}$</span> term, we have:</p>
<p class="math">\[
~
b_n(x-x_n)(x-x_{n-1})\cdot\cdots\cdot(x-x_1) - a_n\cdot(x-x_0)\cdot\cdots\cdot(x-x_{n-1})=
a_n [(x-x_1)\cdot\cdots\cdot(x-x_{n-1})] [(x- x_n)-(x-x_0)] =
-a_n \cdot(x_n - x_0) x^{n-1} + p_{n-2},
~
\]</p>
<p>where <span class="math">$p_{n-2}$</span> is a polynomial of at most degree <span class="math">$n-2$</span>. &#40;The expansion of <span class="math">$(x-x_1)\cdot\cdots\cdot(x-x_{n-1}))$</span> leaves <span class="math">$x^{n-1}$</span> plus some lower degree polynomial.&#41; Similarly, we have <span class="math">$a_{n-1}(x-x_0)\cdot\cdots\cdot(x-x_{n-2}) = a_{n-1}x^{n-1} + q_{n-2}$</span> and <span class="math">$b_{n-1}(x-x_n)\cdot\cdots\cdot(x-x_2) = b_{n-1}x^{n-1}+r_{n-2}$</span>. Combining, we get that the <span class="math">$x^{n-1}$</span> term of <span class="math">$u(x)$</span> is</p>
<p class="math">\[
~
(b_{n-1}-a_{n-1}) - a_n(x_n-x_0) = 0.
~
\]</p>
<p>On rearranging, this yields <span class="math">$a_n = (b_{n-1}-a_{n-1}) / (x_n - x_0)$</span>. By <em>induction</em>–-that <span class="math">$a_i=f[x_0, x_1, \dots, x_i]$</span> and <span class="math">$b_i = f[x_n, x_{n-1}, \dots, x_{n-i}]$</span> &#40;which has trivial base case&#41;–-this is <span class="math">$(f[x_1, \dots, x_n] - f[x_0,\dots x_{n-1}])/(x_n-x_0)$</span>.</p>
<p>Now, assuming the Newton form is correct, a <a href="http://tinyurl.com/zjogv83">proof</a> of the mean value theorem for divided differences comes down to Rolle&#39;s theorem. Starting from the Newton form of the polynomial and expanding in terms of <span class="math">$1, x, \dots, x^n$</span> we see that <span class="math">$g(x) = p_{n-1}(x) + f[x_0, x_1, \dots,x_n]\cdot x^n$</span>, where now <span class="math">$p_{n-1}(x)$</span> is a polynomial of degree  at most <span class="math">$n-1$</span>. That is, the coefficient of <span class="math">$x^n$</span> is <span class="math">$f[x_0, x_1, \dots, x_n]$</span>. Consider  the function <span class="math">$h(x)=f(x) - g(x)$</span>. It has zeros <span class="math">$x_0, x_1, \dots, x_n$</span>.</p>
<p>By Rolle&#39;s theorem, between any two such zeros <span class="math">$x_i, x_{i+1}$</span>, <span class="math">$0 \leq i < n$</span> there must be a zero of the derivative of <span class="math">$h(x)$</span>, say <span class="math">$\xi^1_i$</span>. So <span class="math">$h'(x)$</span> has zeros <span class="math">$\xi^1_0 < \xi^1_1 < \dots < \xi^1_{n-1}$</span>.</p>
<p>We visualize this with <span class="math">$f(x) = \sin(x)$</span> and <span class="math">$x_i = i$</span> for <span class="math">$i=0, 1, 2, 3$</span>, The <span class="math">$x_i$</span> values are indicated with circles, the <span class="math">$\xi^1_i$</span> values indicated with squares:</p>


    <div id="42f5455e-a0b8-4bb6-928a-942b48f6ec4f" style="width:576px;height:384px;"></div>
    <script>
    PLOT = document.getElementById('42f5455e-a0b8-4bb6-928a-942b48f6ec4f');
    Plotly.plot(PLOT, [
    {
        "xaxis": "x1",
        "colorbar": {
            "title": ""
        },
        "yaxis": "y1",
        "text": [
            null,
            null,
            null,
            null,
            null,
            null,
            null,
            null,
            null,
            null,
            null,
            null,
            null,
            null,
            null,
            null,
            null,
            null,
            null,
            null,
            null,
            null,
            null,
            null,
            null,
            null,
            null,
            null,
            null,
            null,
            null,
            null,
            null,
            null,
            null,
            null,
            null,
            null,
            null,
            null,
            null,
            null,
            null,
            null,
            null,
            null,
            null,
            null,
            null,
            null,
            null,
            null,
            null,
            null,
            null,
            null,
            null,
            null,
            null,
            null,
            null,
            null,
            null,
            null,
            null,
            null,
            null
        ],
        "x": [
            -0.24145490835768538,
            -0.23290981671537075,
            -0.22436472507305616,
            -0.21581963343074154,
            -0.17631377799073572,
            -0.13680792255072993,
            -0.09730206711072412,
            -0.057796211670718314,
            -0.01829035623071251,
            0.021215499209293297,
            0.060721354649299106,
            0.10022721008930491,
            0.1477099549593996,
            0.19519269982949425,
            0.2426754446995889,
            0.2901581895696836,
            0.3303042460535577,
            0.37045030253743183,
            0.410596359021306,
            0.45074241550518007,
            0.49435228540780507,
            0.53796215531043,
            0.581572025213055,
            0.62518189511568,
            0.7055907804934394,
            0.7859996658711986,
            0.8722064891469565,
            0.9584133124227144,
            1.0582923713037886,
            1.158171430184863,
            1.2469321507867188,
            1.335692871388575,
            1.4135280246396724,
            1.49136317789077,
            1.533793782991482,
            1.5762243880921942,
            1.6186549931929062,
            1.6610855982936181,
            1.7464511619642302,
            1.8318167256348423,
            1.9261992724101287,
            2.020581819185415,
            2.1103844308961834,
            2.2001870426069523,
            2.2935609224483393,
            2.3869348022897268,
            2.465535720061842,
            2.5441366378339576,
            2.592118043613537,
            2.640099449393116,
            2.688080855172695,
            2.7360622609522744,
            2.781166197576826,
            2.826270134201377,
            2.8713740708259285,
            2.9164780074504795,
            2.9526080095261955,
            2.988738011601912,
            3.0248680136776285,
            3.0609980157533445,
            3.0971280178290606,
            3.133258019904777,
            3.1693880219804935,
            3.2055180240562096,
            3.2166385180421573,
            3.2277590120281046,
            3.2388795060140523
        ],
        "showlegend": true,
        "mode": "lines",
        "name": "y1",
        "zmin": -0.1,
        "legendgroup": "y1",
        "zmax": 0.1,
        "line": {
            "color": "rgba(0, 154, 250, 1.000)",
            "shape": "linear",
            "dash": "solid",
            "width": 3
        },
        "y": [
            0.07303069348129893,
            0.06959167016502762,
            0.06622037666453945,
            0.06291624418154676,
            0.048497125965120014,
            0.03544467587939068,
            0.023701847532233367,
            0.013211262416458806,
            0.003915305449540989,
            -0.00424377911747794,
            -0.011323791571571117,
            -0.01738248053980858,
            -0.023394377680472922,
            -0.028113592320518216,
            -0.031638904350507174,
            -0.034068108102643824,
            -0.0353383232654898,
            -0.03595161439633321,
            -0.03596470683185271,
            -0.035433385740148815,
            -0.03430311813277992,
            -0.03266368308554013,
            -0.03058202463787385,
            -0.02812323415249285,
            -0.022811397178251425,
            -0.016806765569583604,
            -0.009996191596840398,
            -0.0031826474965146456,
            0.004256497974952422,
            0.01076274891365292,
            0.015451169218649863,
            0.018892054310108874,
            0.020763621699835477,
            0.021497871969462734,
            0.02140829801045263,
            0.02097263435572838,
            0.02019443897724149,
            0.019080510109385163,
            0.0158661766398972,
            0.011458027903247903,
            0.0054052368848126475,
            -0.0015865436077376893,
            -0.008763158880087718,
            -0.01605635966789487,
            -0.023285194597464587,
            -0.029599658352618685,
            -0.033755078402988525,
            -0.03643001270081292,
            -0.03715628969464124,
            -0.0370749751759325,
            -0.03608364827991306,
            -0.03407734112773464,
            -0.031170004654562766,
            -0.02718017576451298,
            -0.02201558450141633,
            -0.015582677855908972,
            -0.009451049331926115,
            -0.0023957796492806993,
            0.005632540726913229,
            0.014683580727731169,
            0.02480720768959331,
            0.036053426104457845,
            0.04847231619099014,
            0.06211397236689749,
            0.06656660181893582,
            0.0711412701211478,
            0.07583943376510456
        ],
        "type": "scatter",
        "hoverinfo": "text"
    },
    {
        "xaxis": "x1",
        "colorbar": {
            "title": ""
        },
        "yaxis": "y1",
        "text": [
            null,
            null,
            null,
            null
        ],
        "x": [
            0,
            1,
            2,
            3
        ],
        "showlegend": true,
        "mode": "markers",
        "name": "y2",
        "zmin": -0.1,
        "legendgroup": "y2",
        "marker": {
            "symbol": "circle",
            "color": "rgba(227, 111, 71, 1.000)",
            "line": {
                "color": "rgba(0, 0, 0, 1.000)",
                "width": 1
            },
            "size": 8
        },
        "zmax": 0.1,
        "y": [
            0.0,
            0.0,
            0.0,
            -2.7755575615628914e-17
        ],
        "type": "scatter",
        "hoverinfo": "text"
    },
    {
        "xaxis": "x1",
        "colorbar": {
            "title": ""
        },
        "yaxis": "y1",
        "text": [
            null,
            null,
            null
        ],
        "x": [
            0.39127962177610753,
            1.5016216492134973,
            2.6117780880840065
        ],
        "showlegend": true,
        "mode": "markers",
        "name": "y3",
        "zmin": -0.1,
        "legendgroup": "y3",
        "marker": {
            "symbol": "square",
            "color": "rgba(62, 164, 78, 1.000)",
            "line": {
                "color": "rgba(0, 0, 0, 1.000)",
                "width": 1
            },
            "size": 6
        },
        "zmax": 0.1,
        "y": [
            -0.0360297770969254,
            0.021508008912584642,
            -0.037226391074927534
        ],
        "type": "scatter",
        "hoverinfo": "text"
    }
]
, {
    "showlegend": false,
    "xaxis": {
        "showticklabels": true,
        "gridwidth": 0.5,
        "tickvals": [
            0.0,
            1.0,
            2.0,
            3.0
        ],
        "visible": true,
        "ticks": "inside",
        "range": [
            -0.3458649407888375,
            3.3432895384452044
        ],
        "domain": [
            0.09942767570720326,
            0.9931649168853894
        ],
        "tickmode": "array",
        "linecolor": "rgba(0, 0, 0, 1.000)",
        "showgrid": true,
        "title": "",
        "mirror": false,
        "tickangle": 0,
        "showline": true,
        "gridcolor": "rgba(0, 0, 0, 0.100)",
        "titlefont": {
            "color": "rgba(0, 0, 0, 1.000)",
            "family": "sans-serif",
            "size": 15
        },
        "tickcolor": "rgb(0, 0, 0)",
        "ticktext": [
            "0",
            "1",
            "2",
            "3"
        ],
        "zeroline": false,
        "type": "-",
        "tickfont": {
            "color": "rgba(0, 0, 0, 1.000)",
            "family": "sans-serif",
            "size": 11
        },
        "zerolinecolor": "rgba(0, 0, 0, 1.000)",
        "anchor": "y1"
    },
    "paper_bgcolor": "rgba(255, 255, 255, 1.000)",
    "annotations": [],
    "height": 384,
    "margin": {
        "l": 0,
        "b": 20,
        "r": 0,
        "t": 20
    },
    "plot_bgcolor": "rgba(255, 255, 255, 1.000)",
    "yaxis": {
        "showticklabels": true,
        "gridwidth": 0.5,
        "tickvals": [
            -0.025,
            0.0,
            0.025,
            0.05,
            0.07500000000000001
        ],
        "visible": true,
        "ticks": "inside",
        "range": [
            -0.040618365820128496,
            0.07923140851030552
        ],
        "domain": [
            0.0391878098571012,
            0.989747375328084
        ],
        "tickmode": "array",
        "linecolor": "rgba(0, 0, 0, 1.000)",
        "showgrid": true,
        "title": "",
        "mirror": false,
        "tickangle": 0,
        "showline": true,
        "gridcolor": "rgba(0, 0, 0, 0.100)",
        "titlefont": {
            "color": "rgba(0, 0, 0, 1.000)",
            "family": "sans-serif",
            "size": 15
        },
        "tickcolor": "rgb(0, 0, 0)",
        "ticktext": [
            "-0.025",
            "0.000",
            "0.025",
            "0.050",
            "0.075"
        ],
        "zeroline": false,
        "type": "-",
        "tickfont": {
            "color": "rgba(0, 0, 0, 1.000)",
            "family": "sans-serif",
            "size": 11
        },
        "zerolinecolor": "rgba(0, 0, 0, 1.000)",
        "anchor": "x1"
    },
    "width": 576
}
);
    </script>


<p>Again by Rolle&#39;s theorem, between any pair of adjacent zeros <span class="math">$\xi^1_i, \xi^1_{i+1}$</span> there must be a zero <span class="math">$\xi^2_i$</span> of <span class="math">$h''(x)$</span>. So there are <span class="math">$n-1$</span> zeros of <span class="math">$h''(x)$</span>. Continuing, we see that there will be <span class="math">$n+1-3$</span> zeros of <span class="math">$h^{(3)}(x)$</span>, <span class="math">$n+1-4$</span> zeros of <span class="math">$h^{4}(x)$</span>, <span class="math">$\dots$</span>, <span class="math">$n+1-(n-1)$</span> zeros of <span class="math">$h^{n-1}(x)$</span>, and finally <span class="math">$n+1-n$</span> &#40;<span class="math">$1$</span>&#41; zero of <span class="math">$h^{(n)}(x)$</span>. Call this last zero <span class="math">$\xi$</span>. It satisfies <span class="math">$x_0 \leq \xi \leq x_n$</span>. Further, <span class="math">$0 = h^{(n)}(\xi) = f^{(n)}(\xi)  - g^{(n)}(\xi)$</span>. But <span class="math">$g$</span> is a degree <span class="math">$n$</span> polynomial, so the <span class="math">$n$</span>th derivative is the coefficient of <span class="math">$x^n$</span> times <span class="math">$n!$</span>. In this case we have <span class="math">$0 = f^{(n)}(\xi) - f[x_0, \dots, x_n] n!$</span>. Rearranging yields the result.</p>

  </div>
</div>

</body>
</html>
